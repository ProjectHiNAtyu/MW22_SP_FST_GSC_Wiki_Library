// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

throwing_knife_mp_init()
{
    scripts\cp_mp\utility\script_utility::registersharedfunc( "throwing_knife", "onGive", ::throwing_knife_mp_ongive );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "throwing_knife", "onTake", ::throwing_knife_mp_ontake );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "throwing_knife", "tryToPickup", ::throwing_knife_mp_trytopickup );
}

throwing_knife_mp_ongive( equipmentref, _id_CBB2B3D05E48BD27 )
{
    if ( equipmentref == "equip_throwing_knife_fire" )
    {
        self.throwingknifemelee = scripts\cp_mp\utility\weapon_utility::_id_EEAA22F0CD1FF845( "iw8_throwingknife_fire_melee_mp" );
        thread throwingknife_fire_watch_fx();
    }
    else if ( equipmentref == "equip_throwing_knife_electric" )
    {
        self.throwingknifemelee = scripts\cp_mp\utility\weapon_utility::_id_EEAA22F0CD1FF845( "iw8_throwingknife_electric_melee_mp" );
        thread _id_455F789CC852147F();
    }
    else
        self.throwingknifemelee = scripts\cp_mp\utility\weapon_utility::_id_EEAA22F0CD1FF845( "iw9_knifestab_mp" );

    scripts\mp\utility\perk::giveperk( "specialty_equip_throwingKnife" );
}

throwing_knife_mp_ontake( equipmentref, _id_CBB2B3D05E48BD27 )
{
    if ( scripts\mp\utility\perk::_hasperk( "specialty_equip_throwingKnife" ) )
        scripts\mp\utility\perk::removeperk( "specialty_equip_throwingKnife" );

    self.throwingknifemelee = undefined;
}

throwing_knife_mp_trytopickup( equipmentref )
{
    if ( scripts\mp\equipment::hasequipment( equipmentref ) && scripts\mp\equipment::getequipmentammo( equipmentref ) < scripts\mp\equipment::getequipmentmaxammo( equipmentref ) )
        scripts\mp\equipment::incrementequipmentammo( equipmentref );
    else if ( _id_2D9D24F7C63AC143::_id_8B121DD10A442DD2() && _id_2D9D24F7C63AC143::_id_8A160D9935D47F5E( equipmentref, "equipment", 1 ) )
        _id_2D9D24F7C63AC143::_id_9D094FAC5AE6454E( equipmentref, "equipment", 1 );
    else
        return 0;

    if ( equipmentref == "equip_throwing_knife_fire" )
        _id_5762AC2F22202BA2::hudicontype( "throwingknife_fire" );
    else
        _id_5762AC2F22202BA2::hudicontype( "throwingknife" );

    return 1;
}

throwingknife_fire_watch_fx()
{
    self notify( "throwingKnife_clear_fx" );
    self endon( "throwingKnife_clear_fx" );
    self endon( "death_or_disconnect" );
    _id_08E784B7CB7322EB = 0;

    for (;;)
    {
        _id_B818F06C051B78F0 = 0;
        objweapon = self getheldoffhand();

        if ( !isnullweapon( objweapon ) && objweapon.basename == "throwingknife_fire_mp" )
            _id_B818F06C051B78F0 = 1;

        if ( _id_B818F06C051B78F0 && !_id_08E784B7CB7322EB )
            thread throwingknife_fire_begin_fx();
        else if ( _id_08E784B7CB7322EB && !_id_B818F06C051B78F0 )
            thread throwingknife_fire_end_fx();

        _id_08E784B7CB7322EB = _id_B818F06C051B78F0;
        waitframe();
    }
}

throwingknife_fire_begin_fx()
{
    self endon( "death_or_disconnect" );
    self endon( "throwingKnife_end_fx" );
    self.playingthrowingknifewickfx = 1;
    self setscriptablepartstate( "equipMtovFXWorld", "neutral", 0 );
    self setscriptablepartstate( "equipMtovFXView", "active", 0 );
    waittime = 0.4;
    wait( waittime );
    self setscriptablepartstate( "equipMtovFXWorld", "active", 0 );
    self waittill( "offhand_fired" );
    waitframe();
    thread throwingknife_fire_end_fx();
}

throwingknife_fire_end_fx()
{
    self notify( "throwingKnife_end_fx" );

    if ( istrue( self.playingthrowingknifewickfx ) )
    {
        self setscriptablepartstate( "equipMtovFXWorld", "neutral", 0 );
        self setscriptablepartstate( "equipMtovFXView", "neutral", 0 );
    }

    self.playingthrowingknifewickfx = undefined;
}

throwingknife_fire_clear_fx()
{
    self notify( "throwingKnife_clear_fx" );
    thread throwingknife_fire_end_fx();
}

_id_455F789CC852147F()
{
    self notify( "throwingKnife_electric_clear_fx" );
    self endon( "throwingKnife_electric_clear_fx" );
    self endon( "death_or_disconnect" );
    _id_08E784B7CB7322EB = 0;

    for (;;)
    {
        _id_B818F06C051B78F0 = 0;
        objweapon = self getheldoffhand();

        if ( !isnullweapon( objweapon ) && objweapon.basename == "throwingknife_electric_mp" )
            _id_B818F06C051B78F0 = 1;

        if ( _id_B818F06C051B78F0 && !_id_08E784B7CB7322EB )
            thread _id_DDDC52CFA09E5BB9();
        else if ( _id_08E784B7CB7322EB && !_id_B818F06C051B78F0 )
            thread _id_33A189CBE14A8A9D();

        _id_08E784B7CB7322EB = _id_B818F06C051B78F0;
        waitframe();
    }
}

_id_DDDC52CFA09E5BB9()
{
    self endon( "death_or_disconnect" );
    self endon( "throwingKnife_electric_end_fx" );
    self._id_7132B204F3914E1B = 1;
    self setscriptablepartstate( "equipMtovFXWorld", "neutral", 0 );
    self setscriptablepartstate( "equipMtovFXView", "active", 0 );
    waittime = 0.4;
    wait( waittime );
    self setscriptablepartstate( "equipMtovFXWorld", "active", 0 );
    self waittill( "offhand_fired" );
    waitframe();
    thread _id_33A189CBE14A8A9D();
}

_id_33A189CBE14A8A9D()
{
    self notify( "throwingKnife_electric_end_fx" );

    if ( istrue( self._id_7132B204F3914E1B ) )
    {
        self setscriptablepartstate( "equipMtovFXWorld", "neutral", 0 );
        self setscriptablepartstate( "equipMtovFXView", "neutral", 0 );
    }

    self._id_7132B204F3914E1B = undefined;
}

_id_3019DEAE682E280D()
{
    self notify( "throwingKnife_electric_clear_fx" );
    thread _id_33A189CBE14A8A9D();
}
