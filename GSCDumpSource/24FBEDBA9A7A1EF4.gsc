// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

callbacksoldieragentdamaged( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon )
{
    if ( isdefined( self._id_A4738C70736D3A61 ) )
        [[ self._id_A4738C70736D3A61 ]]( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon );
    else
        _id_DFFAC413ED66BCD0( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon );
}

_id_DFFAC413ED66BCD0( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon )
{
    _id_E851FFA44B7E0D54 = self;
    _id_A95F61E7118777D1 = idamage;
    _id_64D2A3801BD9AD7E = 0;
    _id_9285B238A06E0C02 = 0;
    _id_5D59D8B177F36F36 = 0;

    if ( _id_62213F6E7B9DA1E7( _id_E851FFA44B7E0D54, eattacker, einflictor ) )
        return;

    if ( !_id_84A1AEC445B03580( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon ) )
        return;

    _id_379485F96865DB6D = isdefined( eattacker ) && isplayer( eattacker );
    _id_7543D4FE49C53684 = isdefined( eattacker ) && isdefined( eattacker.owner ) && isplayer( eattacker.owner );
    _id_CCCD6F66C0CAF114 = isdefined( eattacker ) && isdefined( eattacker.classname ) && eattacker.classname == "script_vehicle" && isdefined( eattacker.owner ) && isplayer( eattacker.owner );
    _id_FACFECFAC4909D65 = _id_CCCD6F66C0CAF114 && smeansofdeath == "MOD_CRUSH";

    if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "player", "gulagTrackPlayerBulletHitAI" ) )
        [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "player", "gulagTrackPlayerBulletHitAI" ) ]]( eattacker, idamage );

    if ( smeansofdeath == "MOD_MELEE" )
        idamage = int( min( idamage, 135 ) );
    else if ( isdefined( eattacker ) && isplayer( eattacker ) && isdefined( objweapon ) && isdefined( objweapon.basename ) && objweapon.basename == "throwingknife_mp" )
    {
        _id_5D59D8B177F36F36 = istrue( self._id_685390C6753C2CC7 );
        idamage = scripts\engine\utility::ter_op( _id_5D59D8B177F36F36, int( max( 400, self.health + self.armorhealth ) ), 400 );
    }

    headshot = scripts\cp_mp\utility\damage_utility::isheadshot( shitloc, smeansofdeath, eattacker );

    if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "relics", "modify_agent_damage" ) )
        idamage = self [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "relics", "modify_agent_damage" ) ]]( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon );

    if ( !headshot && isdefined( self.armorhealth ) && self.armorhealth > 0 && smeansofdeath != "MOD_CRUSH" )
    {
        [idamage, _id_1DA1A66B5C6A06A7] = _id_07C40FA80892A721::_id_90CE8EB3DDAA4943( eattacker, einflictor, _id_E851FFA44B7E0D54, idamage, objweapon, smeansofdeath, shitloc, idflags, _id_A95F61E7118777D1, 1 );
        _id_64D2A3801BD9AD7E = _id_1DA1A66B5C6A06A7;

        if ( idamage <= 0 )
        {
            idamage = 1;
            self.health = self.health + 1;
        }
    }

    if ( headshot && smeansofdeath != "MOD_CRUSH" && !scripts\cp_mp\utility\damage_utility::_id_0CB9BA92488B23C5( objweapon ) )
    {
        hashelmet = istrue( self.helmethealth ) && self.helmethealth > 0;

        if ( hashelmet )
        {
            if ( istrue( self._id_895DAE193CFAAC3A ) )
            {
                _id_9285B238A06E0C02 = idamage;
                _id_07C40FA80892A721::_id_E71F062243EA8827( idamage, 0, eattacker );
                idamage = 0;
            }
            else
            {
                _id_9285B238A06E0C02 = 1;
                _id_798CA175BE748E74 = 0;

                if ( scripts\common\utility::getdamagetype( smeansofdeath ) == "splash" )
                    _id_798CA175BE748E74 = 1;

                if ( ( sweapon.classname == "sniper" || sweapon.classname == "dmr" ) && idamage > 1000 )
                {
                    if ( self.helmethealth == 1 )
                        _id_798CA175BE748E74 = 1;

                    _id_9285B238A06E0C02 = self.helmethealth;
                }

                _id_07C40FA80892A721::_id_E71F062243EA8827( _id_9285B238A06E0C02, 0, eattacker );

                if ( !istrue( _id_798CA175BE748E74 ) )
                    idamage = 0;
            }
        }
    }

    if ( _id_64D2A3801BD9AD7E == 0 && _id_9285B238A06E0C02 == 0 && scripts\engine\utility::isbulletdamage( smeansofdeath ) && scripts\cp_mp\utility\damage_utility::isheadshot( shitloc, smeansofdeath, eattacker ) )
        idamage = int( max( idamage, self.health ) );

    if ( _id_5D59D8B177F36F36 )
        idamage = self.health;

    _id_B2883531AFA6B83D = _id_64D2A3801BD9AD7E > 0;
    _id_C99801D3991FA429 = _id_9285B238A06E0C02 > 0;

    if ( _id_B2883531AFA6B83D || _id_C99801D3991FA429 )
        idflags = idflags | level.idflags_br_armor_hit;

    if ( getdvarint( "dvar_DF80C6D770BA0231", 1 ) == 1 )
    {
        _id_1DA1A66B5C6A06A7 = _id_64D2A3801BD9AD7E + _id_9285B238A06E0C02;
        _id_986B2E0350629522 = 0;
        iskillstreakweapon = 0;

        if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "ai_mp_controller", "handleDamageFeedback" ) )
        {
            _id_974FEFEA31F1FABE = scripts\cp_mp\utility\script_utility::getsharedfunc( "ai_mp_controller", "handleDamageFeedback" );
            [[ _id_974FEFEA31F1FABE ]]( einflictor, eattacker, self, idamage, smeansofdeath, objweapon, shitloc, idflags, _id_1DA1A66B5C6A06A7, _id_986B2E0350629522, iskillstreakweapon );
        }
    }

    idamage = int( idamage );

    if ( scripts\common\utility::getdamagetype( smeansofdeath ) == "splash" )
        idamage = idamage * 2;

    if ( istrue( _id_E851FFA44B7E0D54._id_6C66AFBC7F2CE4B0 ) && isdefined( level._id_C0F958F7943F0CDE ) )
    {
        _id_2D776DDE0A657B53 = idamage + _id_64D2A3801BD9AD7E;
        _id_E851FFA44B7E0D54 [[ level._id_C0F958F7943F0CDE ]]( _id_2D776DDE0A657B53 );
    }

    if ( _id_379485F96865DB6D || _id_7543D4FE49C53684 || _id_FACFECFAC4909D65 )
    {
        if ( isdefined( objweapon ) )
        {
            attacker = eattacker;

            if ( _id_7543D4FE49C53684 )
                attacker = eattacker.owner;

            if ( isdefined( level._id_238D7505B0146B84 ) )
                [[ level._id_238D7505B0146B84 ]]( self, attacker, einflictor, objweapon, idamage, vpoint, vdir, shitloc, timeoffset, smeansofdeath );
        }
    }

    if ( istrue( _id_E851FFA44B7E0D54.agentdamagefeedback ) )
    {
        _id_22602300DECB102B = 0;

        if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "killstreak", "isKillstreakWeapon" ) )
        {
            _id_22602300DECB102B = isdefined( objweapon ) && [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "killstreak", "isKillstreakWeapon" ) ]]( objweapon.basename );

            if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "damage", "handleDamageFeedback" ) )
                eattacker [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "damage", "handleDamageFeedback" ) ]]( einflictor, eattacker, _id_E851FFA44B7E0D54, idamage, smeansofdeath, objweapon, shitloc, idflags, 0, 0, _id_22602300DECB102B );
        }
    }

    if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "damage", "process_events_and_challenges_on_death" ) )
        self [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "damage", "process_events_and_challenges_on_death" ) ]]( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon );

    if ( isdefined( _id_E851FFA44B7E0D54.unittype ) && isdefined( level.agent_funcs[_id_E851FFA44B7E0D54.unittype] ) && isdefined( level.agent_funcs[_id_E851FFA44B7E0D54.unittype]["on_damaged_finished"] ) )
        _id_E851FFA44B7E0D54 [[ level.agent_funcs[_id_E851FFA44B7E0D54.unittype]["on_damaged_finished"] ]]( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, 0.0, modelindex, partname, _id_B2883531AFA6B83D );
    else
        _id_E851FFA44B7E0D54 [[ level.agent_funcs[_id_E851FFA44B7E0D54.agent_type]["on_damaged_finished"] ]]( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, 0.0, modelindex, partname, _id_B2883531AFA6B83D );
}

_id_62213F6E7B9DA1E7( agent, attacker, inflictor )
{
    if ( isdefined( attacker ) && isdefined( agent ) && isdefined( agent.team ) )
    {
        if ( isdefined( attacker.team ) && attacker.team == agent.team )
            return 1;

        if ( isdefined( attacker.owner ) && isdefined( attacker.owner.team ) && attacker.owner.team == agent.team )
            return 1;

        if ( isdefined( attacker.vehicle ) && isdefined( attacker.vehicle.team ) && attacker.vehicle.team == agent.team )
            return 1;
    }

    if ( isdefined( inflictor ) && isdefined( agent ) && isdefined( agent.team ) )
    {
        if ( isdefined( inflictor.team ) && inflictor.team == agent.team )
            return 1;

        if ( isdefined( inflictor.owner ) && isdefined( inflictor.owner.team ) && inflictor.owner.team == agent.team )
            return 1;

        if ( isdefined( inflictor.vehicle ) && isdefined( inflictor.vehicle.team ) && inflictor.vehicle.team == agent.team )
            return 1;
    }

    return 0;
}

_id_84A1AEC445B03580( einflictor, eattacker, idamage, idflags, smeansofdeath, sweapon, vpoint, vdir, shitloc, timeoffset, modelindex, partname, objweapon )
{
    return !istrue( self.invulnerable );
}

_id_7D0D24665D72F13C( agent, attacker )
{
    _id_371B4C2AB5861E62::_id_1920867DDF76810C( agent, 0 );
}

_id_59EA6B2F800CB082( agent, attacker )
{
    _id_371B4C2AB5861E62::_id_1920867DDF76810C( agent, 0 );

    if ( agent.subclass == "tier2" )
        fx = scripts\engine\utility::getfx( "vfx_gameplay_tier2_helmet_pop" );
    else
        fx = scripts\engine\utility::getfx( "vfx_gameplay_tier3_helmet_pop" );

    playfx( fx, agent gettagorigin( "j_helmet" ) );
    agent hidepart( "j_helmet_hide", agent.headmodel );
}
