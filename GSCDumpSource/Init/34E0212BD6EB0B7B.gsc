// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    level.entbudgetused = 0;
    level.entbudget = getdvarint( "dvar_3E029CF0DE92274B", 200 );
    level.budgetedents = [];
}

registerspawncount( entcount )
{
    self.entcount = entcount;
    level.entbudgetused = level.entbudgetused + entcount;
    updatebudget();
}

deregisterspawn()
{
    if ( isdefined( self.entcount ) && !isdefined( self.deregistered ) )
    {
        level.entbudgetused = level.entbudgetused - self.entcount;
        self.deregistered = 1;
        self.entcount = undefined;

        if ( level.entbudgetused < 0 )
            level.entbudgetused = 0;
    }

    if ( isdefined( self.entdeletefunc ) )
    {
        level.budgetedents = scripts\engine\utility::array_remove( level.budgetedents, self );
        self.entdeletefunc = undefined;
    }
}

registerspawn( entcount, deletefunc )
{
    self.entcount = entcount;
    self.entdeletefunc = deletefunc;
    level.entbudgetused = level.entbudgetused + entcount;
    level.budgetedents[level.budgetedents.size] = self;
    updatebudget();
}

updatebudget()
{
    if ( level.entbudgetused > level.entbudget )
    {
        if ( isdefined( level.budgetedents[0] ) )
        {
            level.entbudgetused = level.entbudgetused - level.budgetedents[0].entcount;
            self [[ level.budgetedents[0].entdeletefunc ]]();
        }
        else
        {

        }

        level.budgetedents = scripts\engine\utility::array_slice( level.budgetedents, 0, 1 );
    }
}
