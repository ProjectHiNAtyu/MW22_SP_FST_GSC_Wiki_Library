// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

_id_476BA78D85B349EA()
{
    scripts\engine\scriptable::scriptable_addusedcallbackbypart( "body_dead_drop", _id_048614492EF09B23::_id_CF1B1F86951A9209 );
    scripts\engine\utility::flag_wait( "scriptables_ready" );
    level._id_CED78996BBF1B2D3 = [];

    foreach ( _id_5793A0CF9D352C92 in getentitylessscriptablearray( "scriptable_dmz_dead_drop", "classname" ) )
    {
        _id_5793A0CF9D352C92 setscriptablepartstate( "body_dead_drop", "closed_usable" );
        _id_5793A0CF9D352C92._id_055AA0066A9F3E9F = ::_id_BE64875FAE5BD1CE;
        _id_5793A0CF9D352C92._id_6978A4B328FD33B3 = ::_id_2463F61A8C4D7772;
        _id_5793A0CF9D352C92._id_CEB543956C7203E7 = ::_id_A1CBB02F01A33768;
        level._id_CED78996BBF1B2D3[level._id_CED78996BBF1B2D3.size] = _id_5793A0CF9D352C92;
    }

    scripts\engine\utility::flag_set( "dead_drops_init" );
}

_id_BE64875FAE5BD1CE( instance, part, state, player, _id_A5B2C541413AA895, _id_CC38472E36BE1B61 )
{
    if ( instance getscriptablepartstate( "body_dead_drop" ) != "partially_opening_unusable" )
        instance setscriptablepartstate( "body_dead_drop", "partially_opening_unusable" );
}

_id_2463F61A8C4D7772( _id_69E96A4CAA72D794, player, lootid, quantity, itemtype, _id_3793828403C6873E )
{
    if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "pmc_missions", "onAddItemToDeadDrop" ) )
        lootid = [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "pmc_missions", "onAddItemToDeadDrop" ) ]]( lootid );

    _id_DFAB44D4D8D10B36 = quantity;

    if ( isdefined( itemtype ) && itemtype == 10 )
        _id_DFAB44D4D8D10B36 = player _id_2D9D24F7C63AC143::_id_897B29ADB37F06A7( _id_3793828403C6873E );

    if ( !isdefined( itemtype ) )
        itemtype = 0;

    if ( !isdefined( _id_3793828403C6873E ) )
        _id_3793828403C6873E = 0;

    player notify( "item_added_to_cache", itemtype, _id_3793828403C6873E, lootid, _id_DFAB44D4D8D10B36 );
}

_id_A1CBB02F01A33768( _id_69E96A4CAA72D794, opener )
{
    _id_69E96A4CAA72D794 setscriptablepartstate( "body_dead_drop", "partially_closing_unusable" );

    foreach ( player in _id_69E96A4CAA72D794._id_2BC73315BD31809C )
    {
        _id_E1CF43F3AE9D77E7 = _id_048614492EF09B23::_id_564C579AE581A82D( _id_69E96A4CAA72D794._id_556DB0B72A96514E[player.guid].contents );
        _id_BBAC576AADE31A1E = 0;

        foreach ( index, item in _id_E1CF43F3AE9D77E7 )
        {
            if ( !isdefined( item.lootid ) )
                continue;

            ref = _id_600B944A95C3A7BF::_id_793E8A72CEDB8EF3( item.lootid );
            _id_25978461C6E4F61B = level.br_pickups._id_838863C4848D4C26[ref];
            itemtype = undefined;

            if ( isdefined( _id_25978461C6E4F61B ) )
                itemtype = level.br_pickups.br_itemtype[_id_25978461C6E4F61B];

            if ( isdefined( itemtype ) && !istrue( item._id_338E098F5CBFDA5B ) )
            {
                if ( itemtype == "plunder" )
                {
                    _id_BBAC576AADE31A1E = _id_BBAC576AADE31A1E + item.quantity;
                    continue;
                }

                if ( itemtype == "valuable" )
                {
                    _id_B87F7FAE01CE754F = level.br_pickups._id_D93566A78E29D583[_id_25978461C6E4F61B];
                    _id_BBAC576AADE31A1E = _id_BBAC576AADE31A1E + item.quantity * _id_B87F7FAE01CE754F;
                }
            }
        }

        _id_B8F5D813D9E1194E = undefined;
        _id_98F7CE981BB1F93C = player getclientomnvar( "loot_container_weapon" );

        if ( istrue( _id_98F7CE981BB1F93C ) )
        {
            _id_B8F5D813D9E1194E = spawnstruct();
            _id_B8F5D813D9E1194E.lootid = _id_98F7CE981BB1F93C;
            _id_B8F5D813D9E1194E.quantity = 1;
            _id_E1CF43F3AE9D77E7[_id_E1CF43F3AE9D77E7.size] = _id_B8F5D813D9E1194E;
        }

        _id_3EAA9F644DBE7834 = 0;
        _id_3EAA9F644DBE7834 = scripts\cp_mp\challenges::_id_6D40F12A09494350( _id_3EAA9F644DBE7834, 7 );

        if ( !_id_6A8EC730B2BFA844::_id_6F6CC16C0528DE5B( player ) && !getdvarint( "dvar_C3DA1A11F720D408", 0 ) )
            return;

        foreach ( index, item in _id_69E96A4CAA72D794._id_556DB0B72A96514E[player.guid].contents )
        {
            if ( item["lootID"] == 0 || item["quantity"] == 0 )
                continue;

            ref = _id_600B944A95C3A7BF::_id_793E8A72CEDB8EF3( item["lootID"] );
            _id_25978461C6E4F61B = level.br_pickups._id_838863C4848D4C26[ref];
            itemtype = undefined;

            if ( isdefined( _id_25978461C6E4F61B ) )
                itemtype = level.br_pickups.br_itemtype[_id_25978461C6E4F61B];

            if ( isdefined( itemtype ) && ( itemtype == "plunder" || itemtype == "valuable" ) && !istrue( _id_69E96A4CAA72D794._id_556DB0B72A96514E[player.guid].contents[index]["noExtract"] ) )
            {
                _id_69E96A4CAA72D794._id_556DB0B72A96514E[player.guid].contents[index]["lootID"] = 0;
                _id_69E96A4CAA72D794._id_556DB0B72A96514E[player.guid].contents[index]["quantity"] = 0;
            }
        }

        scripts\cp_mp\challenges::_id_D24138B32084FC3E( player, 8395, undefined, _id_3EAA9F644DBE7834, _id_BBAC576AADE31A1E * 100 );

        for ( _id_AC0E594AC96AA3A8 = 0; _id_AC0E594AC96AA3A8 < 110; _id_AC0E594AC96AA3A8++ )
        {
            cooldowntime = player getplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime" );

            if ( cooldowntime > getsystemtime() )
            {
                _id_3DB0926F7A996BC9 = player getplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime" ) - int( 3600 * _id_BBAC576AADE31A1E / getdvarint( "dvar_C5AC098E3A15AF33", 50 ) );

                if ( _id_3DB0926F7A996BC9 <= getsystemtime() )
                    player setplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime", 0 );
                else
                    player setplayerdata( level._id_5D69837CF4DB0407, "dmzInventory", _id_AC0E594AC96AA3A8, "cooldownEndTime", _id_3DB0926F7A996BC9 );
            }
        }

        player setclientomnvar( "loot_container_weapon", 0 );
    }
}
