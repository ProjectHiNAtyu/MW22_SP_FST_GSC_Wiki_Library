// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    scripts\mp\utility\spawn_event_aggregator::registeronplayerspawncallback( ::onplayerspawned );
}

onplayerspawned()
{
    self.focus = 0;
    self._id_8F267DCD3BA27FD6 = 0;
    thread _id_668D6646DE9F85E6();
}

_id_668D6646DE9F85E6()
{
    self endon( "death_or_disconnect" );
    level endon( "game_ended" );

    for (;;)
    {
        while ( !self isholdingbreath() )
            waitframe();

        _id_31801AB8533AE1D8();
    }
}

_id_31801AB8533AE1D8()
{
    _id_F5E73E30E7F0023C = !istrue( level.wpinprogress ) && _id_BD0D33F283EDE2F8();

    if ( _id_F5E73E30E7F0023C )
    {
        self.focus = 1;
        childthread _id_A85F5C6DC04397E4();
    }

    while ( self isholdingbreath() )
        waitframe();

    if ( _id_F5E73E30E7F0023C )
    {
        self notify( "focus_visionset_stop" );
        self.focus = 0;
        scripts\mp\utility\player::restorebasevisionset( 0.35 );
        self._id_8F267DCD3BA27FD6++;
    }
}

_id_BD0D33F283EDE2F8()
{
    weapontype = strtok( self.currentweapon.basename, "_" )[1];

    switch ( weapontype )
    {
        case "dm":
        case "lm":
        case "sm":
        case "sn":
        case "sh":
        case "pi":
        case "ar":
        case "br":
            return 1;
        default:
            return 0;
    }
}

_id_A85F5C6DC04397E4()
{
    self endon( "focus_visionset_stop" );
    self visionsetnakedforplayer( "focus", 0.57 );
}
