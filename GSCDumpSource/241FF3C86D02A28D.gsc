// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

_id_80D68C9701E1AEA5( data )
{
    level._id_AF7D80856E5AE6C0 = spawnstruct();
    level._id_AF7D80856E5AE6C0.circleradius = getdvarint( "dvar_D2585EC2C64A9F34", 300 );
    level._id_AF7D80856E5AE6C0._id_E3AA1DE9D96E0086 = getdvarint( "dvar_1D6B7E1F5EAB0397", 700 );
    level._id_AF7D80856E5AE6C0.bombtimer = getdvarfloat( "dvar_5670AE3DC42B22FF", 50.0 );
    level._id_AF7D80856E5AE6C0._id_0CA7A26C1E01B30A = getdvarfloat( "dvar_11C996694EC6BC7D", 3.0 );
    initanims();
    scripts\engine\scriptable::scriptable_addusedcallbackbypart( "dmz_missionstarter_hostage", ::_id_A74E41B89EA26A30 );
    scripts\engine\scriptable::scriptable_addusedcallbackbypart( "dmz_hostage", ::_id_B7A8186B8098B13F );
    _id_03314ADD7998AB13::_id_B713F2D39B34540F( data, ::_id_D871FFA09FD34EFE, _id_F0C7539DC72C3DFD() );
}

_id_D871FFA09FD34EFE( _id_AA1ED8F12D71A7A5, node )
{
    _id_B8EBE3F71A08AB40 = _id_6C4E8CEA70BF4B6D::_id_5F6D9FD82BDD2D05( _id_AA1ED8F12D71A7A5 );
    _id_B8EBE3F71A08AB40.funcs["onInit"] = ::_id_C17A05D80BAF63A8;
    _id_B8EBE3F71A08AB40.funcs["onPlayerJoined"] = ::_id_15BD4F5A3DA26FBA;
    _id_B8EBE3F71A08AB40.funcs["onPlayerRemoved"] = ::_id_64B4CC14AF5FCBF9;
    _id_B8EBE3F71A08AB40.funcs["onTeamAssigned"] = ::_id_48EF78129771C52B;
    _id_B8EBE3F71A08AB40.funcs["onTeamStart"] = ::_id_497633646487B841;
    _id_B8EBE3F71A08AB40.funcs["onCancel"] = ::_id_55CFF0A19D87F7B0;
    _id_B8EBE3F71A08AB40.ref = "dmz_hostage";
    _id_B8EBE3F71A08AB40._id_30E8A65CFF941C7A = _id_64ACB6CE534155B7::getquesttableindex( _id_B8EBE3F71A08AB40.ref );
    _id_B8EBE3F71A08AB40.node = node;
    _id_47E9B099C2D0B060 = _id_4948CDF739393D2D::_id_BAEF4910ACEA00F0( node.origin );
    _id_4948CDF739393D2D::_id_4E6DD86684152B17( _id_47E9B099C2D0B060, "hostage_door" );
    _id_4948CDF739393D2D::_id_5D8264355DB47371( _id_47E9B099C2D0B060, 0, 1, 0, 0, undefined, undefined, undefined, undefined, 1, 0 );
    _id_B8EBE3F71A08AB40._id_47E9B099C2D0B060 = _id_47E9B099C2D0B060;
    _id_B8EBE3F71A08AB40._id_23D42B1195DDA679 = node._id_23D42B1195DDA679;
    node._id_23D42B1195DDA679.info = _id_5307834CD39B435C::_id_A4181028915C44FA( node._id_23D42B1195DDA679, 0 );
    return _id_B8EBE3F71A08AB40;
}

_id_A74E41B89EA26A30( instance, part, state, player, _id_A5B2C541413AA895, _id_CC38472E36BE1B61 )
{
    level notify( "cleanup_hostage_phone" );
}

_id_C17A05D80BAF63A8()
{
    self._id_EFA8EF05B190D7D0.origin = self.node.origin;
    self.node.inuse = 1;
    _id_79B9C85900392AD6 = _id_6C4E8CEA70BF4B6D::_id_AB50F62A3A730400( self._id_47E9B099C2D0B060.origin, level._id_AF7D80856E5AE6C0.circleradius );
    _id_6C4E8CEA70BF4B6D::_id_325390EDB051CD5D( "Hostage_Dmz", [ _id_79B9C85900392AD6 ], level._id_AF7D80856E5AE6C0.circleradius + level._id_AF7D80856E5AE6C0._id_E3AA1DE9D96E0086 );
    self.curorigin = _id_79B9C85900392AD6;
    self.offset3d = ( 0, 0, 750 );
    scripts\mp\gameobjects::requestid( 1, 1 );
    scripts\mp\objidpoolmanager::update_objective_icon( self.objidnum, "ui_map_icon_obj_rescue" );
    scripts\mp\objidpoolmanager::update_objective_setbackground( self.objidnum, 1 );
    scripts\mp\objidpoolmanager::objective_pin_global( self.objidnum, 1 );
    scripts\mp\objidpoolmanager::objective_set_play_intro( self.objidnum, 1 );
    scripts\mp\objidpoolmanager::objective_set_play_outro( self.objidnum, 0 );
    scripts\mp\objidpoolmanager::objective_playermask_hidefromall( self.objidnum );
    scripts\mp\objidpoolmanager::_id_EE37484CA9BDC744( self.objidnum, 1 );
    scripts\mp\objidpoolmanager::_id_BF66C6833E867284( self.objidnum, _func_58FB674A1DD27075() );
    self.door_unlocked = 0;
    self.door_opened = 0;
    self._id_9834547C51509DBA = 0;
    _id_9B56C0E6A76CE686();
    _id_C78F41BB30956AB8();
    _id_B6B601986DCAD85A();

    if ( isdefined( self.hostage ) )
        _id_14F7745B0A1250DB();
    else
        thread _id_87665EE8F79729F6();
}

_id_87665EE8F79729F6()
{
    wait 0.1;
    _id_6C4E8CEA70BF4B6D::_id_2476DAEFA3384C5E();

    if ( isdefined( self.instance ) )
        self.instance setscriptablepartstate( "dmz_hostage", "unusable", 0 );

    _id_6C4E8CEA70BF4B6D::_id_84E79AB809A8EEA3();
}

_id_15BD4F5A3DA26FBA( player )
{
    player._id_65513AD5397A67EF = self._id_65513AD5397A67EF;
    players = scripts\mp\utility\teams::getteamdata( player.team, "players" );

    if ( !isdefined( self.bombexploded ) )
        self.instance enablescriptableplayeruse( player );
    else if ( isdefined( self.carryingplayer ) )
        self.instance disablescriptableplayeruse( player );
    else
        self.instance enablescriptableplayeruse( player );
}

_id_64B4CC14AF5FCBF9( player )
{
    player._id_65513AD5397A67EF = undefined;

    if ( isdefined( self.carryingplayer ) && self.carryingplayer == player )
        drophostage();

    self.instance disablescriptableplayeruse( player );
}

_id_48EF78129771C52B( _id_FABF84450735DD93 )
{
    _id_6C4E8CEA70BF4B6D::_id_1759ACFD39BB5EDF( "dmz_hostage_assigned", _id_FABF84450735DD93 );
    _id_6C4E8CEA70BF4B6D::_id_E54DF8560BF7DC64( _id_FABF84450735DD93 );
    _id_6C4E8CEA70BF4B6D::_id_DFFCBCE998C9EE50( _id_FABF84450735DD93 );
    players = scripts\mp\utility\teams::getteamdata( _id_FABF84450735DD93, "players" );
    self.instance setscriptablepartstate( "dmz_hostage", "usable", 0 );

    foreach ( player in level.players )
        self.instance disablescriptableplayeruse( player );

    foreach ( player in players )
        self.instance enablescriptableplayeruse( player );

    thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_assigned", _id_FABF84450735DD93 );
    _id_7AB5B649FA408138::_id_46979D2FD81A6D4B( _id_FABF84450735DD93, "dmz_fortress_hostage_contract" );
}

_id_497633646487B841( _id_FABF84450735DD93 )
{
    thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_approach", _id_FABF84450735DD93, 2.0 );
    _id_7AB5B649FA408138::_id_46979D2FD81A6D4B( _id_FABF84450735DD93, "dmz_fortress_hostage_approach" );
    thread _id_D2A6B6D52AC64120( _id_FABF84450735DD93 );
}

_id_55CFF0A19D87F7B0( _id_FABF84450735DD93 )
{
    self.failure = 1;
    _id_8250FD658E3AAE32();

    if ( isdefined( self.carryingplayer ) )
        thread drophostage();

    _id_6C4E8CEA70BF4B6D::_id_84E79AB809A8EEA3();
}

_id_8250FD658E3AAE32()
{
    if ( istrue( self._id_0AF8D4CC519C65DE ) )
        return;

    self._id_0AF8D4CC519C65DE = 1;
    scripts\mp\gameobjects::releaseid();
    _id_6C4E8CEA70BF4B6D::_id_2476DAEFA3384C5E();

    if ( isdefined( self.instance ) )
        self.instance freescriptable();

    if ( isdefined( self.heli ) && isdefined( self.heli._id_0902A7FFCFF8AA65 ) )
    {
        foreach ( player in self.heli._id_0902A7FFCFF8AA65 )
            player _id_5307834CD39B435C::_id_A9F268ABD153B713();
    }

    _id_6C4E8CEA70BF4B6D::_id_45BD3184FF146B46( self.teams[0] );
}

_id_CB2F74520E05756F()
{
    _id_8250FD658E3AAE32();

    foreach ( team in self.teams )
    {
        _id_E2B2BBD9E6539F11 = scripts\mp\utility\teams::getteamdata( team, "players" );

        if ( isdefined( self._id_FE593BA7D0935BB5 ) && team == self._id_FE593BA7D0935BB5 )
        {
            _id_6C4E8CEA70BF4B6D::_id_CD4F277CF0D6A560( team );
            thread scripts\mp\music_and_dialog::_id_F139A00330157E01( _id_E2B2BBD9E6539F11 );
            continue;
        }

        thread scripts\mp\music_and_dialog::_id_4FE255A72526EA50( _id_E2B2BBD9E6539F11 );
    }

    _id_6C4E8CEA70BF4B6D::_id_84E79AB809A8EEA3( self._id_FE593BA7D0935BB5 );
}

_id_C78F41BB30956AB8()
{
    _id_44736CEE8AFAD49B = scripts\cp_mp\utility\scriptable_door_utility::scriptable_door_get_in_radius( self.node.origin, 1000, 1000 );
    _id_E2CD8AA8B46D18AC = [];
    _id_9F8DA05C3739C129 = scripts\engine\utility::getstructarray( "hostage_door_gl", "targetname" );

    foreach ( door in _id_44736CEE8AFAD49B )
    {
        if ( isdefined( door.node ) )
        {
            if ( isdefined( door.node.script_noteworthy ) )
            {
                if ( door.node.script_noteworthy == "lockMe" )
                    _id_E2CD8AA8B46D18AC[_id_E2CD8AA8B46D18AC.size] = door;
            }

            continue;
        }

        foreach ( _id_558D05322E7A6B40 in _id_9F8DA05C3739C129 )
        {
            if ( distancesquared( door.origin, _id_558D05322E7A6B40.origin ) < 100 )
                _id_E2CD8AA8B46D18AC[_id_E2CD8AA8B46D18AC.size] = door;
        }
    }

    foreach ( door in _id_E2CD8AA8B46D18AC )
    {
        door._id_B8EBE3F71A08AB40 = self;
        _id_9E3D50AE85137C98( door );
        door._id_DEF557E8FD5C6763 = ::_id_BF35C0838580CF50;
        door scriptabledoorclose();
        _id_57D3850A12CF1D8F::_id_FBBFE6F05EDA5EB1( door );
    }

    self._id_CDA920F373548C49 = _id_E2CD8AA8B46D18AC;
}

_id_BF35C0838580CF50( door, player )
{
    if ( isdefined( door._id_B8EBE3F71A08AB40 ) )
    {
        if ( isdefined( door.node.script_noteworthy ) && door.node.script_noteworthy == "lockMe" )
        {
            door._id_B8EBE3F71A08AB40.door_unlocked = 1;
            door thread _id_FC650C2FCD941742();
        }
    }
}

_id_FC650C2FCD941742()
{
    while ( self scriptabledoorisclosed() )
        waitframe();

    self._id_B8EBE3F71A08AB40.door_opened = 1;
}

_id_9B56C0E6A76CE686()
{
    key = "hostage" + gettime();
    self._id_65513AD5397A67EF = key;
}

_id_9E3D50AE85137C98( door )
{
    door._id_65513AD5397A67EF = self._id_65513AD5397A67EF;
}

_id_D2A6B6D52AC64120( _id_FABF84450735DD93 )
{
    self endon( "task_ended" );
    self endon( "abort_rescue_timer" );

    while ( !istrue( self.door_opened ) )
        waitframe();

    self.hostage.invulnerable = undefined;
    _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_loud", _id_FABF84450735DD93 );
    self.state = "player_entered_building";
    thread _id_795B60C4AE5793A2( _id_FABF84450735DD93 );
    _id_7AB5B649FA408138::_id_46979D2FD81A6D4B( _id_FABF84450735DD93, "dmz_fortress_hostage_breach" );
}

_id_795B60C4AE5793A2( _id_FABF84450735DD93 )
{
    if ( istrue( self._id_66B657AD4E581EDA ) )
        return;

    self endon( "task_ended" );
    self endon( "abort_rescue_timer" );

    if ( istrue( self._id_AD3AC58C52D589D7 ) )
        return;

    self._id_AD3AC58C52D589D7 = 1;
    self._id_53B6D9E042B2D610 = _id_FABF84450735DD93;
    timer = level._id_AF7D80856E5AE6C0.bombtimer;
    thread _id_B0B1DC839966AC28( timer );
}

_id_B0B1DC839966AC28( timer )
{
    self.c4 = spawn( "script_model", self.hostage.origin );
    self.c4 setmodel( "offhand_wm_c4_bomb_mp_p" );
    self.c4.issuper = 0;
    thread _id_68C8358014264E66( timer );

    if ( self.objidnum != -1 )
        objective_setshowprogress( self.objidnum, 1 );

    bombexploded = _id_D0A5788403AC6DDF( timer );

    if ( isdefined( bombexploded ) )
        self.bombexploded = bombexploded;

    if ( isdefined( self.bombexploded ) && self.bombexploded == 0 )
    {
        foreach ( player in self._id_90FB369A18926018 )
            scripts\mp\objidpoolmanager::_id_26259BD38697B5AD( self.objidnum, player );

        if ( self.objidnum != -1 )
            objective_setshowprogress( self.objidnum, 0 );
    }

    if ( istrue( self.bombexploded ) )
    {
        self notify( "bomb_exploded" );

        if ( isdefined( self.hostage ) && self.hostage.health > 0 )
            self.hostage dodamage( 1000, self.hostage.origin );

        self.c4 setscriptablepartstate( "effects", "explode" );
        thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_exploded", self.teams[0], 2.0 );
    }

    wait 10.0;

    if ( isdefined( self.c4 ) )
    {
        self.c4 setscriptablepartstate( "effects", "destroy" );
        self.c4 delete();
    }
}

_id_68C8358014264E66( timer )
{
    level endon( "game_ended" );
    self endon( "task_ended" );
    self endon( "bomb_defused" );
    wait( timer );
    self.instance setscriptablepartstate( "dmz_hostage", "unusable", 0 );
}

_id_D0A5788403AC6DDF( timer )
{
    level endon( "game_ended" );
    self endon( "task_ended" );
    self endon( "bomb_defused" );
    self endon( "abort_rescue_timer" );
    self.c4 setscriptablepartstate( "effects", "plant", 0 );
    self._id_90FB369A18926018 = [];
    currenttime = gettime();
    offset = 1000 * level._id_AF7D80856E5AE6C0._id_0CA7A26C1E01B30A;
    _id_F28399727742EB23 = int( currenttime + 1000 * timer + offset );
    _id_C301D652D9A73075 = _id_F28399727742EB23 - currenttime;
    thread _id_C98C343E42951EA2( _id_F28399727742EB23, offset );

    while ( _id_C301D652D9A73075 > 0 )
    {
        currenttime = gettime();
        _id_C301D652D9A73075 = _id_F28399727742EB23 - currenttime;

        if ( _id_C301D652D9A73075 < 0 )
            break;

        self._id_78122E18403A8DC4 = [];
        _id_E2B2BBD9E6539F11 = scripts\mp\utility\teams::getteamdata( self.teams[0], "players" );

        foreach ( player in _id_E2B2BBD9E6539F11 )
        {
            if ( distance2dsquared( player.origin, self._id_47E9B099C2D0B060.origin ) < 1048576 )
                self._id_78122E18403A8DC4[self._id_78122E18403A8DC4.size] = player;
        }

        progress = ( _id_C301D652D9A73075 - offset ) / ( timer * 1000.0 );

        if ( progress > 0.0 )
        {
            self._id_90FB369A18926018 = _id_F69E0B0E05FD9B85( self._id_78122E18403A8DC4, self._id_90FB369A18926018 );
            scripts\mp\objidpoolmanager::objective_set_progress( self.objidnum, progress );
        }
        else
            scripts\mp\objidpoolmanager::_id_17DB39BD195CC5B1( self.objidnum );

        waitframe();
    }

    return 1;
}

_id_C98C343E42951EA2( _id_F28399727742EB23, offset )
{
    level endon( "game_ended" );
    self endon( "task_ended" );
    self endon( "abort_rescue_timer" );
    self endon( "bomb_exploded" );
    self endon( "bomb_defused" );
    currenttime = gettime();
    _id_C301D652D9A73075 = _id_F28399727742EB23 - currenttime;

    while ( _id_C301D652D9A73075 > 0 )
    {
        currenttime = gettime();
        _id_C301D652D9A73075 = _id_F28399727742EB23 - currenttime;

        if ( _id_C301D652D9A73075 <= 0 + offset )
        {
            if ( _id_C301D652D9A73075 <= 250 )
            {
                if ( soundexists( "breach_warning_beep_05" ) )
                    self.c4 playsound( "breach_warning_beep_05" );
            }
            else if ( _id_C301D652D9A73075 <= 750 )
            {
                if ( soundexists( "breach_warning_beep_04" ) )
                    self.c4 playsound( "breach_warning_beep_04" );
            }
            else if ( _id_C301D652D9A73075 <= 1500 )
            {
                if ( soundexists( "breach_warning_beep_03" ) )
                    self.c4 playsound( "breach_warning_beep_03" );
            }
            else if ( soundexists( "breach_warning_beep_02" ) )
                self.c4 playsound( "breach_warning_beep_02" );

            wait 0.25;
            continue;
        }

        if ( _id_C301D652D9A73075 <= 10000 + offset )
        {
            if ( soundexists( "breach_warning_beep_02" ) )
                self.c4 playsound( "breach_warning_beep_02" );

            wait 0.5;
            continue;
        }

        if ( soundexists( "breach_warning_beep_01" ) )
            self.c4 playsound( "breach_warning_beep_01" );

        wait 1.0;
    }
}

_id_F69E0B0E05FD9B85( _id_78122E18403A8DC4, _id_90FB369A18926018 )
{
    _id_5C882C8F7BB9C72A = scripts\engine\utility::array_combine( _id_78122E18403A8DC4, _id_90FB369A18926018 );
    _id_F6FD7B0E73C3270C = _id_90FB369A18926018;

    foreach ( player in _id_5C882C8F7BB9C72A )
    {
        if ( !isdefined( player ) )
            continue;

        if ( !scripts\engine\utility::array_contains( _id_90FB369A18926018, player ) && scripts\engine\utility::array_contains( _id_78122E18403A8DC4, player ) )
        {
            if ( scripts\mp\objidpoolmanager::_id_CE702E5925E31FC9( self.objidnum, player, 2, 2, &"MP_DMZ_MISSIONS/HOSTAGE_BAR_TITLE" ) )
            {
                scripts\mp\objidpoolmanager::objective_playermask_addshowplayer( self.objidnum, player );
                _id_F6FD7B0E73C3270C = scripts\engine\utility::array_add( _id_F6FD7B0E73C3270C, player );
            }

            continue;
        }

        if ( scripts\engine\utility::array_contains( _id_90FB369A18926018, player ) && !scripts\engine\utility::array_contains( _id_78122E18403A8DC4, player ) )
        {
            scripts\mp\objidpoolmanager::_id_26259BD38697B5AD( self.objidnum, player );
            _id_F6FD7B0E73C3270C = scripts\engine\utility::array_remove( _id_F6FD7B0E73C3270C, player );
        }
    }

    return _id_F6FD7B0E73C3270C;
}

_id_ACE0EEE08161E29A()
{
    if ( istrue( self.failure ) )
        return;

    self.failure = 1;

    if ( isdefined( self._id_90FB369A18926018 ) )
    {
        foreach ( player in self._id_90FB369A18926018 )
            scripts\mp\objidpoolmanager::_id_26259BD38697B5AD( self.objidnum, player );
    }

    scripts\mp\objidpoolmanager::objective_playermask_hidefromall( self.objidnum );
    self._id_B0F4BF8621B96C0A[0] scripts\cp_mp\utility\game_utility::_id_04EAF685BC40A3B9();

    if ( self.objidnum != -1 )
        objective_setshowprogress( self.objidnum, 0 );

    thread _id_CB2F74520E05756F();
}

_id_C0CCB94FCFE50916()
{
    self endon( "task_ended" );
    self.hostage thread _id_8DC13537721B3C2D();

    while ( isdefined( self.hostage ) && self.hostage.health > 0 && !istrue( self.bombexploded ) )
        waitframe();

    _id_6C4E8CEA70BF4B6D::_id_A1738A95D7AA8094( "dmz_hostage_failure", "hostage", 0, self.teams[0] );

    if ( isdefined( self.teams[0] ) && !istrue( self.bombexploded ) )
        thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_shot", self.teams[0], 1.5 );

    _id_ACE0EEE08161E29A();
}

_id_600841F07D1E97C7()
{
    self endon( "task_ended" );

    for (;;)
    {
        _id_08C25B4EB512709D = 1;

        foreach ( ent in self._id_896452C986F0513B )
        {
            if ( isdefined( ent ) && ent.health > 0 )
            {
                _id_08C25B4EB512709D = 0;
                break;
            }
        }

        if ( _id_08C25B4EB512709D )
        {
            self._id_66B657AD4E581EDA = 1;
            self notify( "abort_rescue_timer" );

            if ( istrue( self._id_AD3AC58C52D589D7 ) )
            {

            }

            return;
        }

        waitframe();
    }
}

_id_B7A8186B8098B13F( instance, part, state, player, _id_A5B2C541413AA895, _id_CC38472E36BE1B61 )
{
    if ( part != "dmz_hostage" )
        return;

    if ( !isdefined( instance._id_B8EBE3F71A08AB40 ) )
        return;

    if ( !isdefined( instance._id_B8EBE3F71A08AB40.teams[0] ) || player.team != instance._id_B8EBE3F71A08AB40.teams[0] )
        return;

    if ( state == "usable" && isdefined( instance.hostage ) )
    {
        if ( isdefined( instance._id_B8EBE3F71A08AB40._id_FE593BA7D0935BB5 ) )
            return;

        instance setscriptablepartstate( "dmz_hostage", "unusable" );
        _id_B8EBE3F71A08AB40 = instance._id_B8EBE3F71A08AB40;
        bomb = _id_B8EBE3F71A08AB40 _id_CADC5181C3B67E3F( player );
        instance thread _id_C01611FBD560866E( player );
        _id_8B07FA3892A3A8A4 = 0;

        while ( _id_8B07FA3892A3A8A4 < level._id_AF7D80856E5AE6C0._id_0CA7A26C1E01B30A )
        {
            if ( !isdefined( instance ) || instance._id_A4CF15C49F3E9EEF || istrue( _id_B8EBE3F71A08AB40.failure ) || !scripts\mp\utility\player::_id_AD443BBCDCF37B85( player ) )
            {
                _id_B8EBE3F71A08AB40 _id_0DB896F4486CA187( player, bomb );

                if ( !istrue( _id_B8EBE3F71A08AB40.failure ) && isdefined( instance ) )
                {
                    instance setscriptablepartstate( "dmz_hostage", "usable" );

                    foreach ( _id_6EE5484560EC747C in level.players )
                        instance disablescriptableplayeruse( _id_6EE5484560EC747C );

                    _id_6D5ED003AF1F9612 = scripts\mp\utility\teams::getteamdata( instance._id_B8EBE3F71A08AB40.teams[0], "players" );

                    foreach ( _id_F0EA4030349A33D5 in _id_6D5ED003AF1F9612 )
                        instance enablescriptableplayeruse( _id_F0EA4030349A33D5 );
                }

                return 0;
            }

            _id_8B07FA3892A3A8A4 = _id_8B07FA3892A3A8A4 + level.framedurationseconds;
            waitframe();
        }

        if ( istrue( instance._id_B8EBE3F71A08AB40.failure ) )
        {
            instance._id_B8EBE3F71A08AB40 _id_0DB896F4486CA187( player, bomb );
            return;
        }

        instance._id_B8EBE3F71A08AB40.state = "rescued";
        instance.hostage notify( "play_dialog" );
        instance._id_B8EBE3F71A08AB40.bombexploded = 0;
        instance._id_B8EBE3F71A08AB40 notify( "bomb_defused" );
        instance._id_B8EBE3F71A08AB40 _id_0DB896F4486CA187( player, bomb );

        if ( istrue( instance._id_B8EBE3F71A08AB40.failure ) )
            return;

        player playsound( "mp_dmz_hostage_unzip" );
        instance._id_B8EBE3F71A08AB40.dropposition = instance.position;
        instance setscriptablepartstate( "dmz_hostage", "remaining" );

        foreach ( guy in level.players )
            instance disablescriptableplayeruse( guy );

        _id_6D5ED003AF1F9612 = scripts\mp\utility\teams::getteamdata( instance._id_B8EBE3F71A08AB40.teams[0], "players" );

        foreach ( _id_F0EA4030349A33D5 in _id_6D5ED003AF1F9612 )
            instance enablescriptableplayeruse( _id_F0EA4030349A33D5 );

        scripts\mp\objidpoolmanager::update_objective_position( instance._id_B8EBE3F71A08AB40.objidnum, instance._id_B8EBE3F71A08AB40.hostage.origin + ( 0, 0, 30 ) );
        instance._id_B8EBE3F71A08AB40._id_B0F4BF8621B96C0A[0] scripts\cp_mp\utility\game_utility::_id_04EAF685BC40A3B9();
        instance._id_B8EBE3F71A08AB40._id_B0F4BF8621B96C0A[0] scripts\cp_mp\utility\game_utility::_id_6E148C8DA2E4DB13( instance._id_B8EBE3F71A08AB40._id_23D42B1195DDA679.origin );
        instance._id_B8EBE3F71A08AB40 _id_6C4E8CEA70BF4B6D::_id_1759ACFD39BB5EDF( "dmz_hostage_success", instance._id_B8EBE3F71A08AB40.teams[0] );
        thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_win", instance._id_B8EBE3F71A08AB40.teams[0], 2.0 );
        instance._id_B8EBE3F71A08AB40 thread _id_0DF48D309A8BC55A();
        _id_7AB5B649FA408138::_id_46979D2FD81A6D4B( instance._id_B8EBE3F71A08AB40.teams[0], "dmz_fortress_hostage_rescue" );
    }
    else if ( state == "remaining" && isdefined( instance.hostage ) )
    {
        instance setscriptablepartstate( "dmz_hostage", "unusable" );
        instance._id_B8EBE3F71A08AB40 _id_6E98EEED96B1D4B2( player, instance.hostage );
    }
    else if ( state == "following" && isdefined( instance.hostage ) )
        instance._id_B8EBE3F71A08AB40 drophostage();
}

#using_animtree("script_model");

initanims()
{
    level.scr_animtree["player_pickup_hostage"] = #animtree;
    level.scr_anim["player_pickup_hostage"]["pickup_front_crouch"] = %iw9_mp_hostage_pickup_crouch_8;
    level.scr_animname["player_pickup_hostage"]["pickup_front_crouch"] = "iw9_mp_hostage_pickup_crouch_8";
    level.scr_eventanim["player_pickup_hostage"]["pickup_front_crouch"] = "pickup_front_crouch";
    level.scr_anim["player_pickup_hostage"]["pickup_front_stand"] = %iw9_mp_hostage_pickup_stand_8;
    level.scr_animname["player_pickup_hostage"]["pickup_front_stand"] = "iw9_mp_hostage_pickup_stand_8";
    level.scr_eventanim["player_pickup_hostage"]["pickup_front_stand"] = "pickup_front_stand";
    level.scr_anim["player_pickup_hostage"]["pickup_back_crouch"] = %iw9_mp_hostage_pickup_crouch_2;
    level.scr_animname["player_pickup_hostage"]["pickup_back_crouch"] = "iw9_mp_hostage_pickup_crouch_2";
    level.scr_eventanim["player_pickup_hostage"]["pickup_back_crouch"] = "pickup_back_crouch";
    level.scr_anim["player_pickup_hostage"]["pickup_back_stand"] = %iw9_mp_hostage_pickup_stand_2;
    level.scr_animname["player_pickup_hostage"]["pickup_back_stand"] = "iw9_mp_hostage_pickup_stand_2";
    level.scr_eventanim["player_pickup_hostage"]["pickup_back_stand"] = "pickup_back_stand";
    level.scr_anim["player_pickup_hostage"]["pickup_right_crouch"] = %iw9_mp_hostage_pickup_crouch_6;
    level.scr_animname["player_pickup_hostage"]["pickup_right_crouch"] = "iw9_mp_hostage_pickup_crouch_6";
    level.scr_eventanim["player_pickup_hostage"]["pickup_right_crouch"] = "pickup_right_crouch";
    level.scr_anim["player_pickup_hostage"]["pickup_right_stand"] = %iw9_mp_hostage_pickup_stand_6;
    level.scr_animname["player_pickup_hostage"]["pickup_right_stand"] = "iw9_mp_hostage_pickup_stand_6";
    level.scr_eventanim["player_pickup_hostage"]["pickup_right_stand"] = "pickup_right_stand";
    level.scr_anim["player_pickup_hostage"]["pickup_left_crouch"] = %iw9_mp_hostage_pickup_crouch_4;
    level.scr_animname["player_pickup_hostage"]["pickup_left_crouch"] = "iw9_mp_hostage_pickup_crouch_4";
    level.scr_eventanim["player_pickup_hostage"]["pickup_left_crouch"] = "pickup_left_crouch";
    level.scr_anim["player_pickup_hostage"]["pickup_left_stand"] = %iw9_mp_hostage_pickup_stand_4;
    level.scr_animname["player_pickup_hostage"]["pickup_left_stand"] = "iw9_mp_hostage_pickup_stand_4";
    level.scr_eventanim["player_pickup_hostage"]["pickup_left_stand"] = "pickup_left_stand";
    level.scr_anim["player_pickup_hostage"]["pickup_front_crouch_vm"] = %iw9_mp_hostage_vm_pickup_crouch_8;
    level.scr_animname["player_pickup_hostage"]["pickup_front_crouch_vm"] = "iw9_mp_hostage_vm_pickup_crouch_8";
    level.scr_eventanim["player_pickup_hostage"]["pickup_front_crouch_vm"] = "pickup_front_crouch_vm";
    level.scr_anim["player_pickup_hostage"]["pickup_front_stand_vm"] = %iw9_mp_hostage_vm_pickup_stand_8;
    level.scr_animname["player_pickup_hostage"]["pickup_front_stand_vm"] = "iw9_mp_hostage_vm_pickup_stand_8";
    level.scr_eventanim["player_pickup_hostage"]["pickup_front_stand_vm"] = "pickup_front_stand_vm";
    level.scr_anim["player_pickup_hostage"]["pickup_back_crouch_vm"] = %iw9_mp_hostage_vm_pickup_crouch_2;
    level.scr_animname["player_pickup_hostage"]["pickup_back_crouch_vm"] = "iw9_mp_hostage_vm_pickup_crouch_2";
    level.scr_eventanim["player_pickup_hostage"]["pickup_back_crouch_vm"] = "pickup_back_crouch_vm";
    level.scr_anim["player_pickup_hostage"]["pickup_back_stand_vm"] = %iw9_mp_hostage_vm_pickup_stand_2;
    level.scr_animname["player_pickup_hostage"]["pickup_back_stand_vm"] = "iw9_mp_hostage_vm_pickup_stand_2";
    level.scr_eventanim["player_pickup_hostage"]["pickup_back_stand_vm"] = "pickup_back_stand_vm";
    level.scr_anim["player_pickup_hostage"]["pickup_right_crouch_vm"] = %iw9_mp_hostage_vm_pickup_crouch_6;
    level.scr_animname["player_pickup_hostage"]["pickup_right_crouch_vm"] = "iw9_mp_hostage_vm_pickup_crouch_6";
    level.scr_eventanim["player_pickup_hostage"]["pickup_right_crouch_vm"] = "pickup_right_crouch_vm";
    level.scr_anim["player_pickup_hostage"]["pickup_right_stand_vm"] = %iw9_mp_hostage_vm_pickup_stand_6;
    level.scr_animname["player_pickup_hostage"]["pickup_right_stand_vm"] = "iw9_mp_hostage_vm_pickup_stand_6";
    level.scr_eventanim["player_pickup_hostage"]["pickup_right_stand_vm"] = "pickup_right_stand_vm";
    level.scr_anim["player_pickup_hostage"]["pickup_left_crouch_vm"] = %iw9_mp_hostage_vm_pickup_crouch_4;
    level.scr_animname["player_pickup_hostage"]["pickup_left_crouch_vm"] = "iw9_mp_hostage_vm_pickup_crouch_4";
    level.scr_eventanim["player_pickup_hostage"]["pickup_left_crouch_vm"] = "pickup_left_crouch_vm";
    level.scr_anim["player_pickup_hostage"]["pickup_left_stand_vm"] = %iw9_mp_hostage_vm_pickup_stand_4;
    level.scr_animname["player_pickup_hostage"]["pickup_left_stand_vm"] = "iw9_mp_hostage_vm_pickup_stand_4";
    level.scr_eventanim["player_pickup_hostage"]["pickup_left_stand_vm"] = "pickup_left_stand_vm";
    level.scr_animtree["hostage_pickup"] = #animtree;
    level.scr_anim["hostage_pickup"]["pickup_front_crouch"] = %iw9_mp_hostage_pickedup_crouch_8;
    level.scr_animname["hostage_pickup"]["pickup_front_crouch"] = "iw9_mp_hostage_pickedup_crouch_8";
    level.scr_eventanim["hostage_pickup"]["pickup_front_crouch"] = "hostage_pickup_front_crouch";
    level.scr_anim["hostage_pickup"]["pickup_front_stand"] = %iw9_mp_hostage_pickedup_stand_8;
    level.scr_animname["hostage_pickup"]["pickup_front_stand"] = "iw9_mp_hostage_pickedup_stand_8";
    level.scr_eventanim["hostage_pickup"]["pickup_front_stand"] = "hostage_pickup_front_stand";
    level.scr_anim["hostage_pickup"]["pickup_back_crouch"] = %iw9_mp_hostage_pickedup_crouch_2;
    level.scr_animname["hostage_pickup"]["pickup_back_crouch"] = "iw9_mp_hostage_pickedup_crouch_2";
    level.scr_eventanim["hostage_pickup"]["pickup_back_crouch"] = "hostage_pickup_back_crouch";
    level.scr_anim["hostage_pickup"]["pickup_back_stand"] = %iw9_mp_hostage_pickedup_stand_2;
    level.scr_animname["hostage_pickup"]["pickup_back_stand"] = "iw9_mp_hostage_pickedup_stand_2";
    level.scr_eventanim["hostage_pickup"]["pickup_back_stand"] = "hostage_pickup_back_stand";
    level.scr_anim["hostage_pickup"]["pickup_right_crouch"] = %iw9_mp_hostage_pickedup_crouch_6;
    level.scr_animname["hostage_pickup"]["pickup_right_crouch"] = "iw9_mp_hostage_pickedup_crouch_6";
    level.scr_eventanim["hostage_pickup"]["pickup_right_crouch"] = "hostage_pickup_right_crouch";
    level.scr_anim["hostage_pickup"]["pickup_right_stand"] = %iw9_mp_hostage_pickedup_stand_6;
    level.scr_animname["hostage_pickup"]["pickup_right_stand"] = "iw9_mp_hostage_pickedup_stand_6";
    level.scr_eventanim["hostage_pickup"]["pickup_right_stand"] = "hostage_pickup_right_stand";
    level.scr_anim["hostage_pickup"]["pickup_left_crouch"] = %iw9_mp_hostage_pickedup_crouch_4;
    level.scr_animname["hostage_pickup"]["pickup_left_crouch"] = "iw9_mp_hostage_pickedup_crouch_4";
    level.scr_eventanim["hostage_pickup"]["pickup_left_crouch"] = "hostage_pickup_left_crouch";
    level.scr_anim["hostage_pickup"]["pickup_left_stand"] = %iw9_mp_hostage_pickedup_stand_4;
    level.scr_animname["hostage_pickup"]["pickup_left_stand"] = "iw9_mp_hostage_pickedup_stand_4";
    level.scr_eventanim["hostage_pickup"]["pickup_left_stand"] = "hostage_pickup_left_stand";
}

_id_6E98EEED96B1D4B2( player, hostage )
{
    player endon( "death_or_disconnect" );
    player endon( "last_stand_start" );
    level endon( "game_ended" );
    self.hostage endon( "death" );
    self endon( "task_ended" );

    if ( !istrue( self._id_0AF8D4CC519C65DE ) )
    {
        self.carryingplayer = player;
        thread _id_82EF6D194918247F( player );
        player._id_859654E0445A36D9 = 1;
        hostage _id_3B8913DC82881267( player );
        player notify( "hostage_pickup_finished" );
    }

    if ( !istrue( self._id_0AF8D4CC519C65DE ) )
    {
        hostage hide();
        hostage.origin = hostage.origin + ( 0, 0, 100000 );
        hostage.invulnerable = 1;
        self.carryingplayer setcarryobject( "hostage_rescue" );
        _id_F0C2012AE22CA0D6( self.carryingplayer );
        players = scripts\mp\utility\teams::getteamdata( self.teams[0], "players" );

        foreach ( _id_F0EA4030349A33D5 in players )
            self._id_B0F4BF8621B96C0A[0] scripts\cp_mp\utility\game_utility::_id_CFD53C8F6878014F( _id_F0EA4030349A33D5 );

        self.instance setscriptablepartstate( "dmz_hostage", "following" );

        foreach ( _id_6EE5484560EC747C in level.players )
            self.instance disablescriptableplayeruse( _id_6EE5484560EC747C );

        self.instance enablescriptableplayeruse( self.carryingplayer );
        scripts\mp\objidpoolmanager::update_objective_position( self.objidnum, self._id_23D42B1195DDA679.origin );
        thread _id_EEDE562CE57290D3();
    }
}

_id_8277F49F79BFF530( animname, spawnpos, _id_B7850001037AA074 )
{
    self.animname = animname;

    if ( !isdefined( spawnpos ) )
        spawnpos = ( 0, 0, 0 );

    if ( !isdefined( _id_B7850001037AA074 ) )
        _id_B7850001037AA074 = ( 0, 0, 0 );

    if ( isplayer( self ) )
        self _meth_B88C89BB7CD1AB8E( spawnpos );

    _id_0E3BDA5BE1DB297F = spawn( "script_arms", spawnpos, 0, 0, self );
    _id_0E3BDA5BE1DB297F.angles = _id_B7850001037AA074;
    _id_0E3BDA5BE1DB297F.player = self;
    self._id_0E3BDA5BE1DB297F = _id_0E3BDA5BE1DB297F;
    self._id_0E3BDA5BE1DB297F.animname = animname;
    self._id_0E3BDA5BE1DB297F useanimtree( #animtree );
    self._id_0E3BDA5BE1DB297F.updatedversion = 1;
    self playerlinktoabsolute( self._id_0E3BDA5BE1DB297F, "tag_player", 1.0, 0, 0, 0, 0, 1 );
    self notify( "rig_created" );
    scripts\engine\utility::waittill_any_2( "remove_rig", "player_free_spot" );

    if ( istrue( level.gameended ) )
        return;

    if ( isdefined( self ) )
    {
        self unlink();
        thread scripts\cp_mp\utility\inventory_utility::_id_9897D143C3FEEE05();
    }

    if ( isdefined( _id_0E3BDA5BE1DB297F ) )
        _id_0E3BDA5BE1DB297F delete();
}

_id_A3A4A2CDCA554483( animname, spawnpos, _id_B7850001037AA074 )
{
    self.animname = animname;

    if ( !isdefined( spawnpos ) )
        spawnpos = ( 0, 0, 0 );

    if ( !isdefined( _id_B7850001037AA074 ) )
        _id_B7850001037AA074 = ( 0, 0, 0 );

    if ( isplayer( self ) )
        self _meth_B88C89BB7CD1AB8E( spawnpos );

    _id_54D7B76A2A71E284 = spawn( "script_arms", spawnpos, 0, 0, self );
    _id_54D7B76A2A71E284.angles = _id_B7850001037AA074;
    _id_54D7B76A2A71E284.player = self;
    self._id_54D7B76A2A71E284 = _id_54D7B76A2A71E284;
    self._id_54D7B76A2A71E284.animname = animname;
    self._id_54D7B76A2A71E284 useanimtree( #animtree );
    self._id_54D7B76A2A71E284.updatedversion = 1;
    self playerlinktoabsolute( self._id_54D7B76A2A71E284, "tag_player", 1.0, 0, 0, 0, 0, 1 );
    self notify( "rig_created" );
    scripts\engine\utility::waittill_any_2( "remove_rig", "player_free_spot" );

    if ( istrue( level.gameended ) )
        return;

    if ( isdefined( self ) )
    {
        self unlink();
        thread scripts\cp_mp\utility\inventory_utility::_id_9897D143C3FEEE05();
    }

    if ( isdefined( _id_54D7B76A2A71E284 ) )
        _id_54D7B76A2A71E284 delete();
}

_id_3B8913DC82881267( player )
{
    animlength = 0;
    stance = player getstance();

    if ( stance == "prone" )
    {
        player setstance( "crouch", 1, 1 );
        stance = "crouch";
    }

    player._id_280ABCD08CBDCC79 = player getcurrentweapon();
    _id_F4EC18F455B87D6F = 0.2;
    starttime = gettime();
    _id_2B1D0E57C66A43D0 = makeweapon( "iw8_gunless" );
    player giveweapon( _id_2B1D0E57C66A43D0 );
    player switchtoweaponimmediate( _id_2B1D0E57C66A43D0 );
    player._id_73F4B954751A8643 = _id_2B1D0E57C66A43D0;
    endtime = gettime();
    totaltime = max( _id_F4EC18F455B87D6F - ( endtime - starttime ) / 1000.0, 0 );
    wait( totaltime );
    _id_7C4E2C6A50914434 = ( self.origin[0], self.origin[1], player.origin[2] );
    _id_CEBE2632E00D0E2D = vectornormalize( player.origin - _id_7C4E2C6A50914434 );
    _id_82B4F01CE94ED444 = vectordot( _id_CEBE2632E00D0E2D, anglestoforward( self.angles ) );
    _id_8288E81CE91E5C46 = vectordot( _id_CEBE2632E00D0E2D, anglestoright( self.angles ) );
    _id_14AEA8523FA938BA = ( player.origin[0], player.origin[1], self.origin[2] );
    self.origin = _id_14AEA8523FA938BA + anglestoforward( player.angles ) * 34.672;
    self._id_08EE3FF7543AC0B4 = stance;
    self._id_A1E9BAABC1D61AE3 = undefined;
    anime = "pickup_back_stand";
    _id_CF13EDFFB05EFCD8 = "pickup_back_stand_vm";

    if ( _id_82B4F01CE94ED444 >= 0.707 )
    {
        self._id_A1E9BAABC1D61AE3 = "front";
        anime = "pickup_front_" + stance;
        _id_CF13EDFFB05EFCD8 = "pickup_front_" + stance + "_vm";
        _id_636EC99138E1950A = vectornormalize( player.origin - self.origin );
        _id_318EEA579595B65E = scripts\mp\utility\script::vectortoanglessafe( _id_636EC99138E1950A, anglestoup( self.angles ) );
        self.angles = _id_318EEA579595B65E;
    }
    else if ( _id_82B4F01CE94ED444 <= -0.707 )
    {
        self._id_A1E9BAABC1D61AE3 = "back";
        anime = "pickup_back_" + stance;
        _id_CF13EDFFB05EFCD8 = "pickup_back_" + stance + "_vm";
        _id_81554C014CE7839C = vectornormalize( self.origin - player.origin );
        _id_318EEA579595B65E = scripts\mp\utility\script::vectortoanglessafe( _id_81554C014CE7839C, anglestoup( self.angles ) );
        self.angles = _id_318EEA579595B65E;
    }
    else if ( _id_8288E81CE91E5C46 >= 0.707 )
    {
        self._id_A1E9BAABC1D61AE3 = "right";
        anime = "pickup_right_" + stance;
        _id_CF13EDFFB05EFCD8 = "pickup_right_" + stance + "_vm";
        _id_81554C014CE7839C = vectorcross( vectornormalize( self.origin - player.origin ), anglestoup( self.angles ) );
        _id_318EEA579595B65E = scripts\mp\utility\script::vectortoanglessafe( _id_81554C014CE7839C, anglestoup( self.angles ) );
        self.angles = _id_318EEA579595B65E;
    }
    else if ( _id_8288E81CE91E5C46 <= -0.707 )
    {
        self._id_A1E9BAABC1D61AE3 = "left";
        anime = "pickup_left_" + stance;
        _id_CF13EDFFB05EFCD8 = "pickup_left_" + stance + "_vm";
        _id_636EC99138E1950A = vectorcross( vectornormalize( player.origin - self.origin ), anglestoup( self.angles ) );
        _id_318EEA579595B65E = scripts\mp\utility\script::vectortoanglessafe( _id_636EC99138E1950A, anglestoup( self.angles ) );
        self.angles = _id_318EEA579595B65E;
    }

    player thread _id_8277F49F79BFF530( "player_pickup_hostage", player.origin, player.angles );
    player._id_0E3BDA5BE1DB297F hidefromplayer( player );
    player thread _id_A3A4A2CDCA554483( "player_pickup_hostage", player.origin, player.angles );
    player._id_54D7B76A2A71E284 hide();
    player._id_54D7B76A2A71E284 showonlytoplayer( player );
    self.animname = "hostage_pickup";
    self useanimtree( level.scr_animtree["hostage_pickup"] );
    self._blackboard._id_7460B96395361857 = "getting_picked_up";
    animstruct = spawnstruct();
    animstruct.origin = player.origin;
    animstruct.angles = player.angles;
    waitframe();
    animstruct thread scripts\mp\anim::anim_player_solo( player, player._id_0E3BDA5BE1DB297F, anime );
    animstruct thread scripts\common\anim::anim_single_solo( player._id_54D7B76A2A71E284, _id_CF13EDFFB05EFCD8 );
    wait( getanimlength( level.scr_anim["player_pickup_hostage"][_id_CF13EDFFB05EFCD8] ) );
    player notify( "remove_rig" );
    player._id_73F4B954751A8643 = undefined;
    player takeweapon( _id_2B1D0E57C66A43D0 );
    _id_04B5B395EA0EA0FB::_id_83DFC273B8E7EFED( player );
}

_id_524F22FE698EEB0F( player )
{
    player endon( "death_or_disconnect" );
    _id_B7771CC818B41864( player );
    gunless = makeweapon( "iw8_gunless" );
    player giveweapon( gunless );
    player scripts\cp_mp\utility\inventory_utility::domonitoredweaponswitch( gunless );

    if ( isdefined( player._id_7EBBB0DC14346EAA ) )
    {
        player takeweapon( player._id_7EBBB0DC14346EAA );
        player._id_7EBBB0DC14346EAA = undefined;
        player scripts\cp_mp\utility\inventory_utility::domonitoredweaponswitch( player._id_280ABCD08CBDCC79 );
    }
    else
        player scripts\cp_mp\utility\inventory_utility::domonitoredweaponswitch( player._id_280ABCD08CBDCC79 );

    if ( isdefined( player._id_280ABCD08CBDCC79 ) )
        player._id_280ABCD08CBDCC79 = undefined;

    player takeweapon( gunless );
    player resetcarryobject();
}

drophostage()
{
    self.hostage show();
    self.hostage.invulnerable = 0;
    thread _id_04B5B395EA0EA0FB::_id_524F22FE698EEB0F( self.carryingplayer );
    self.carryingplayer._id_859654E0445A36D9 = 0;
    self.carryingplayer stopanimscriptsceneevent();
    self.carryingplayer notify( "remove_rig" );

    if ( !isdefined( self.carryingplayer ) || !isdefined( self.carryingplayer.origin ) || !isdefined( self.carryingplayer.angles ) )
    {
        self.hostage.origin = self._id_3D17023B5BFB92CE;
        self.hostage.angles = self._id_BFF867759E490124;
        self.hostage._id_08EE3FF7543AC0B4 = self._id_AB2A8C60478BDD5C;
    }
    else
    {
        self.hostage.origin = self.carryingplayer.origin;
        self.hostage.angles = self.carryingplayer.angles;
        self.hostage._id_08EE3FF7543AC0B4 = self.carryingplayer getstance();
    }

    self.hostage._blackboard._id_7460B96395361857 = "getting_dropped";
    animlength = getanimlength( %iw9_mp_hostage_dropped_stand );

    if ( !istrue( self.failure ) )
        self.instance setscriptablepartstate( "dmz_hostage", "unusable" );

    if ( isdefined( self.carryingplayer ) )
        self.carryingplayer notify( "drop_hostage" );

    if ( isdefined( animlength ) )
        wait( animlength );

    if ( !istrue( self.failure ) )
    {
        self.instance setscriptablepartstate( "dmz_hostage", "remaining" );

        foreach ( player in level.players )
            self.instance disablescriptableplayeruse( player );

        _id_6D5ED003AF1F9612 = scripts\mp\utility\teams::getteamdata( self.teams[0], "players" );

        foreach ( _id_F0EA4030349A33D5 in _id_6D5ED003AF1F9612 )
            self.instance enablescriptableplayeruse( _id_F0EA4030349A33D5 );

        self.hostage._blackboard._id_7460B96395361857 = "dropped";
        self.instance.origin = self.hostage.origin;
        scripts\mp\objidpoolmanager::update_objective_position( self.objidnum, self.hostage.origin + ( 0, 0, 30 ) );
        self._id_B0F4BF8621B96C0A[0] scripts\cp_mp\utility\game_utility::_id_04EAF685BC40A3B9();
        self.carryingplayer = undefined;

        if ( isdefined( self.heli ) )
            _id_7CFC061C84DD495A();
    }
}

_id_EEDE562CE57290D3()
{
    self.carryingplayer endon( "drop_hostage" );

    for (;;)
    {
        if ( !isdefined( self.instance ) )
            return;

        if ( !isdefined( self.carryingplayer ) )
            return;

        start = self.carryingplayer geteye();
        ignore = [ self.carryingplayer ];

        if ( isdefined( self.heli ) )
            ignore[ignore.size] = self.heli;

        passed = scripts\engine\trace::sphere_trace_passed( start, start + ( 0, 0, -25 ), 25, ignore );

        if ( self.carryingplayer isonground() && passed )
        {
            state = self.instance getscriptablepartstate( "dmz_hostage" );

            if ( isdefined( state ) && state != "following" )
            {
                self.instance setscriptablepartstate( "dmz_hostage", "following" );

                foreach ( player in level.players )
                    self.instance disablescriptableplayeruse( player );

                self.instance enablescriptableplayeruse( self.carryingplayer );
            }

            forward = 5 * anglestoforward( self.carryingplayer getplayerangles() );
            self.instance.origin = start + forward * 0.1;
        }
        else
            self.instance setscriptablepartstate( "dmz_hostage", "unusable" );

        waitframe();
    }
}

_id_0CF6E805CE234F5E( player )
{
    level endon( "game_ended" );
    player endon( "death_or_disconnect" );
    player endon( "drop_hostage" );
    self endon( "task_ended" );

    for (;;)
    {
        self._id_3D17023B5BFB92CE = player.origin;
        self._id_BFF867759E490124 = player.angles;
        self._id_AB2A8C60478BDD5C = player getstance();
        waitframe();
    }
}

watchforplayerdeath( player )
{
    player endon( "drop_hostage" );
    player endon( "hostage_pickup_finished" );
    player scripts\engine\utility::waittill_any_2( "death_or_disconnect", "last_stand_start" );
    player stopanimscriptsceneevent();
    player notify( "remove_rig" );
    thread drophostage();
}

_id_05AC14A79B2A4DB6( player )
{
    player endon( "death_or_disconnect" );
    player endon( "drop_hostage" );
    player endon( "hostage_pickup_finished" );
    self.hostage waittill( "death" );
    player stopanimscriptsceneevent();
    player notify( "remove_rig" );
    thread _id_524F22FE698EEB0F( self.carryingplayer );
}

_id_82EF6D194918247F( player )
{
    player endon( "drop_hostage" );
    player endon( "hostage_pickup_finished" );
    thread _id_0CF6E805CE234F5E( player );
    thread _id_05AC14A79B2A4DB6( player );
    thread watchforplayerdeath( player );
}

_id_F0C2012AE22CA0D6( player )
{
    player _id_3B64EB40368C1450::_id_C9D0B43701BDBA00( "carry" );
    player _id_3B64EB40368C1450::set( "carry", "prone", 0 );
    player _id_3B64EB40368C1450::set( "carry", "slide", 0 );
    player _id_3B64EB40368C1450::set( "carry", "supersprint", 0 );
    player _id_3B64EB40368C1450::set( "carry", "mount_side", 0 );
    player _id_3B64EB40368C1450::set( "carry", "mount_top", 0 );
    player _id_3B64EB40368C1450::set( "carry", "mantle", 0 );
    player _id_3B64EB40368C1450::set( "carry", "equipment_secondary", 0 );
    player _id_3B64EB40368C1450::set( "carry", "equipment_primary", 0 );
    player _id_3B64EB40368C1450::set( "carry", "supers", 0 );
    player _id_3B64EB40368C1450::set( "carry", "melee", 0 );
    player _id_3B64EB40368C1450::set( "carry", "weapon_switch", 0 );
    player _id_3B64EB40368C1450::set( "carry", "swimming_underwater", 0 );
    player _id_3B64EB40368C1450::set( "carry", "dtp", 0 );
    player _id_3B64EB40368C1450::set( "carry", "ladder", 0 );
    player _id_3B64EB40368C1450::set( "carry", "weapon_pickup", 0 );
    player _id_3B64EB40368C1450::set( "carry", "weapon_switch_clip", 0 );
    player _id_3B64EB40368C1450::set( "carry", "killstreaks", 0 );
    player _id_3B64EB40368C1450::set( "carry", "execution_attack", 0 );
    player _id_3B64EB40368C1450::set( "carry", "ads", 1 );
    player.playerstreakspeedscale = -0.25;
    player setmovespeedscale( 0.75 );
}

_id_B7771CC818B41864( player )
{
    player _id_3B64EB40368C1450::_id_C9D0B43701BDBA00( "carry" );
    player.playerstreakspeedscale = 0;
    player setmovespeedscale( 1 );
}

_id_C01611FBD560866E( player )
{
    self._id_B8EBE3F71A08AB40 endon( "bomb_planted" );
    self._id_B8EBE3F71A08AB40 endon( "bomb_defused" );
    player notifyonplayercommand( "cancel", "+weapnext" );
    self._id_A4CF15C49F3E9EEF = 0;
    player waittill( "cancel" );
    self._id_A4CF15C49F3E9EEF = 1;
    player notifyonplayercommandremove( "cancel", "+weapnext" );
}

_id_CADC5181C3B67E3F( player )
{
    self._id_EDA575E1C30414D1 = player;
    bomb = makeweapon( "briefcase_bomb_mp" );
    player scripts\cp_mp\utility\inventory_utility::_giveweapon( bomb, undefined, undefined, 0 );
    player setweaponammostock( bomb, 0 );
    player setweaponammoclip( bomb, 0 );
    player thread scripts\mp\gameobjects::switchtouseweapon( bomb, 1, 1 );
    player _id_BF9EC93BEE75F88C( 0 );
    return bomb;
}

_id_0DB896F4486CA187( player, bomb )
{
    lastweaponobj = player scripts\mp\utility\inventory::getlastweapon();

    if ( player scripts\mp\utility\killstreak::isjuggernaut() )
        lastweaponobj = scripts\mp\juggernaut::jugg_getminigunweapon();
    else if ( !player hasweapon( lastweaponobj ) )
        lastweaponobj = player scripts\mp\utility\inventory::getfirstprimaryweapon();

    player scripts\cp_mp\utility\inventory_utility::domonitoredweaponswitch( lastweaponobj, 0, 1 );
    player takeweapon( bomb );
    player _id_BF9EC93BEE75F88C( 1 );
    self._id_EDA575E1C30414D1 = undefined;
}

_id_BF9EC93BEE75F88C( _id_BD138DE99B3B3507 )
{
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "allow_movement", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "script_weapon_switch", !_id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "sprint", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "fire", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "reload", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "weapon_pickup", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "weapon_switch", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "allow_jump", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "gesture", _id_BD138DE99B3B3507 );
    self _meth_35501B42058D4DE9();

    if ( _id_BD138DE99B3B3507 )
        scripts\engine\utility::waittill_any_timeout_1( 0.8, "bomb_allow_offhands" );

    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "melee", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "mantle", _id_BD138DE99B3B3507 );
    _id_3B64EB40368C1450::set( "hostage_holding_bomb", "offhand_weapons", _id_BD138DE99B3B3507 );

    if ( _id_BD138DE99B3B3507 )
    {
        _id_3B64EB40368C1450::_id_C9D0B43701BDBA00( "hostage_holding_bomb" );
        self _meth_BB04491D50D9E43E();
    }
}

_id_B6B601986DCAD85A()
{
    _id_B586C70B173DD02B = scripts\engine\utility::getstructarray( self.node.target, "targetname" );
    _id_B586C70B173DD02B = scripts\engine\utility::array_randomize( _id_B586C70B173DD02B );
    self.hostage = undefined;

    foreach ( _id_FB1DEF007972B25A in _id_B586C70B173DD02B )
    {
        if ( !isdefined( _id_FB1DEF007972B25A.script_noteworthy ) || _id_FB1DEF007972B25A.script_noteworthy != "hostage" )
            continue;

        _id_171F90B9C4C76D44 = _id_5DEF7AF2A9F04234::_id_55CF921EFA4CBD09( _id_FB1DEF007972B25A.origin );
        ai = _id_48814951E916AF89::_id_EA94A8BF24D3C5EF( "civilian_mp_dmz_hostage", getclosestpointonnavmesh( _id_FB1DEF007972B25A.origin ), _id_FB1DEF007972B25A.angles, "absolute", "mission", undefined, "civs", "civilian", undefined, _id_171F90B9C4C76D44, 1, undefined, 0 );

        if ( !isdefined( ai ) )
            return;

        ai._id_B582B10663B5B2A9 = 0;
        ai.ignoreme = 1;
        ai.health = 250;
        ai.maxhealth = 250;
        ai.combatmode = "no_cover";
        ai _meth_B661B022700BA72F( "script", 1 );
        ai _id_010B6724C15A95E8::_id_C434AF0895CC147C( "cap_hostage", "civilian_dmz_hostage" );
        ai._id_950C1AB89C9C4E2A = 1;
        ai._id_B8EBE3F71A08AB40 = self;
        self.hostage = ai;
        level.agent_funcs[ai.agent_type]["on_damaged"] = _id_48814951E916AF89::_id_779B9979FD853E26;
        ai.invulnerable = 1;
        break;
    }

    if ( !isdefined( self.hostage ) )
        return;

    self.instance = spawnscriptable( "dmz_hostage", self.hostage.origin, ( 0, 0, 0 ) );
    self.instance.hostage = self.hostage;
    self.hostage.instance = self.instance;
    self.instance._id_B8EBE3F71A08AB40 = self;
    self.instance setscriptablepartstate( "dmz_hostage", "unusable", 0 );
    thread _id_C0CCB94FCFE50916();
}

_id_14F7745B0A1250DB()
{
    _id_B586C70B173DD02B = scripts\engine\utility::getstructarray( self._id_47E9B099C2D0B060.target, "targetname" );
    self._id_896452C986F0513B = [];

    if ( isdefined( self.hostage ) && isdefined( self.hostage.origin ) )
        _id_B586C70B173DD02B = sortbydistance( _id_B586C70B173DD02B, self.hostage.origin );

    for ( _id_AC0E594AC96AA3A8 = 0; _id_AC0E594AC96AA3A8 < _id_B586C70B173DD02B.size; _id_AC0E594AC96AA3A8++ )
    {
        if ( self._id_896452C986F0513B.size >= 8 )
            break;

        _id_FB1DEF007972B25A = _id_B586C70B173DD02B[_id_AC0E594AC96AA3A8];

        if ( !isdefined( _id_FB1DEF007972B25A.script_noteworthy ) || !issubstr( _id_FB1DEF007972B25A.script_noteworthy, "guard" ) )
            continue;

        _id_1439F86640D42E34 = "ar";

        if ( _id_AC0E594AC96AA3A8 == 1 )
            _id_1439F86640D42E34 = "shotgun";

        aitype = _id_48814951E916AF89::_id_D5BC07EABF352ABB( undefined, undefined, undefined, "ar", 3 );
        enemy = _id_48814951E916AF89::_id_EA94A8BF24D3C5EF( aitype, _id_FB1DEF007972B25A.origin, _id_FB1DEF007972B25A.angles, "high", "mission", "hostageGuard", undefined, undefined, undefined, self.node._id_B205D90302DA2F07, 0, undefined, 0 );

        if ( isdefined( enemy ) )
        {
            _id_67F905DFB8137021( enemy, 1 );
            enemy _id_120270BD0A747A35::_id_304DA84D9A815C01( enemy.origin, 16 );
            enemy._id_B582B10663B5B2A9 = 0;
            self._id_896452C986F0513B[self._id_896452C986F0513B.size] = enemy;

            if ( issubstr( aitype, "shotgun" ) )
            {
                if ( !isdefined( self._id_068C8D20B77D4C93 ) )
                    self._id_068C8D20B77D4C93 = enemy;
            }

            thread _id_120270BD0A747A35::_id_B11C1964F528574B( enemy );
        }
    }
}

_id_67F905DFB8137021( agent, _id_6C149286380290A2 )
{
    _id_A664AAD02EE98BD2 = scripts\engine\utility::random( [ "concussion_grenade_mp", "smoke_grenade_mp", "flash_grenade_mp" ] );
    grenadeammo = getdvarint( "dvar_537FA443CE212A8A", 4 );
    agent _id_371B4C2AB5861E62::_id_C37C4F9D687074FF( undefined, undefined, undefined, _id_A664AAD02EE98BD2, grenadeammo, undefined, undefined );
}

_id_8DC13537721B3C2D()
{
    self._id_B8EBE3F71A08AB40 endon( "task_ended" );
    self endon( "death" );
    level endon( "game_ended" );

    if ( 1 )
        return;

    for (;;)
    {
        if ( !isdefined( self ) )
            return;

        state = self._id_B8EBE3F71A08AB40.state;
        alias = undefined;

        if ( !isdefined( state ) )
        {
            aliases = [ "dx_mpm_civf_idle_civilian_rescue_no_known_player_10", "dx_mpm_civf_idle_civilian_rescue_no_known_player_20", "dx_mpm_civf_idle_civilian_rescue_no_known_player_30", "dx_mpm_civf_idle_civilian_rescue_no_known_player_40", "dx_mpm_civf_idle_civilian_rescue_no_known_player_50" ];
            alias = aliases[randomint( aliases.size )];
        }
        else if ( state == "player_entered_building" )
        {
            aliases = [ "dx_mpm_civf_idle_civilian_rescue_known_player_10", "dx_mpm_civf_idle_civilian_rescue_known_player_20", "dx_mpm_civf_idle_civilian_rescue_known_player_30", "dx_mpm_civf_idle_civilian_rescue_known_player_40", "dx_mpm_civf_idle_civilian_rescue_known_player_50", "dx_mpm_civf_idle_civilian_rescue_known_player_60" ];
            alias = aliases[randomint( aliases.size )];
        }
        else if ( state == "player_entered_room" )
        {
            aliases = [ "dx_mpm_civf_surprised_civilian_surprised_by_player_10", "dx_mpm_civf_surprised_civilian_surprised_by_player_20", "dx_mpm_civf_surprised_civilian_surprised_by_player_30", "dx_mpm_civf_surprised_civilian_surprised_by_player_40", "dx_mpm_civf_surprised_civilian_surprised_by_player_50", "dx_mpm_civf_surprised_civilian_surprised_by_player_60" ];
            alias = aliases[randomint( aliases.size )];
        }
        else if ( state == "rescued" )
        {
            aliases = [ "dx_mpm_civf_rescued_civilian_being_rescued_10", "dx_mpm_civf_rescued_civilian_being_rescued_20", "dx_mpm_civf_rescued_civilian_being_rescued_30", "dx_mpm_civf_rescued_civilian_being_rescued_40" ];
            alias = aliases[randomint( aliases.size )];
            thread _id_5D265B4FCA61F070::_id_E7C1C9DEE13137AA( alias );
            return;
        }

        thread _id_5D265B4FCA61F070::_id_E7C1C9DEE13137AA( alias );
        length = lookupsoundlength( alias );
        scripts\engine\utility::waittill_notify_or_timeout( "play_dialog", length / 1000 + 4.0 );
    }
}

_id_0DF48D309A8BC55A()
{
    _id_6C4E8CEA70BF4B6D::_id_5314298E777E5688( "dmz_hostage_transport" );
    thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_heli_incoming", self.teams[0], 5.0 );
    wait 10;

    if ( !istrue( self.failure ) )
    {
        path = _id_5307834CD39B435C::_id_D99E1EB9CCB97BFF( self._id_23D42B1195DDA679, self._id_23D42B1195DDA679.origin );

        if ( !isdefined( path ) )
        {
            if ( !istrue( self.failure ) )
            {
                thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_hostage_exfil", self.teams[0], 2.0 );
                _id_6C4E8CEA70BF4B6D::_id_A1738A95D7AA8094( "dmz_hostage_exfilled", "hostage", self._id_EFA8EF05B190D7D0._id_723B8F7CB71CEB11, self.teams[0] );
                self._id_FE593BA7D0935BB5 = self.teams[0];
                wait 1.0;
                thread _id_CB2F74520E05756F();
            }

            return;
        }

        _id_A3010F9814A40C8D = undefined;
        players = scripts\mp\utility\teams::getteamdata( self.teams[0], "players" );

        if ( !isdefined( players ) )
        {
            _id_CB2F74520E05756F();
            return;
        }

        for ( _id_AC0E594AC96AA3A8 = 0; _id_AC0E594AC96AA3A8 < players.size && !isdefined( _id_A3010F9814A40C8D ); _id_AC0E594AC96AA3A8++ )
            _id_A3010F9814A40C8D = players[_id_AC0E594AC96AA3A8];

        if ( !isdefined( _id_A3010F9814A40C8D ) )
        {
            _id_CB2F74520E05756F();
            return;
        }

        team = _id_A3010F9814A40C8D.team;
        self.heli = _id_5307834CD39B435C::_id_BA916FD4711C53E2( _id_A3010F9814A40C8D, path.origin, self._id_23D42B1195DDA679.angles );
        scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_setteam( self.heli, team );
        self.heli._id_675F44ED226AED7D = ::_id_8EBF38FBB99AF797;
        self.heli._id_7B468990DA46C73C = ::_id_F6685FAD77B7F64D;
        self.heli._id_B8EBE3F71A08AB40 = self;
        self.heli scripts\common\vehicle_paths::vehicle_paths_helicopter( path );

        if ( !istrue( self._id_23D42B1195DDA679.info.land ) )
            self.heli sethoverparams( 0, 0, 0 );
    }
    else
        return;

    if ( !istrue( self.failure ) )
        self.heli _id_9597B6C3F099D3D7();

    if ( !istrue( self._id_0AF8D4CC519C65DE ) )
        scripts\mp\objidpoolmanager::update_objective_onentity( self.objidnum, self.heli );

    if ( !istrue( self.failure ) )
        self.hostage.invulnerable = 1;

    if ( istrue( self.failure ) )
        _id_8C05501355CC8322();

    thread _id_2D144609316A301E();
    path = _id_5307834CD39B435C::_id_3C841844A3299BFF( self._id_23D42B1195DDA679, self._id_23D42B1195DDA679.origin );
    self.heli thread scripts\common\vehicle_paths::vehicle_paths_helicopter( path );

    if ( !istrue( self.failure ) )
    {
        thread _id_1F97A44D1761C919::_id_9793A81BC3BC19E9( "hostage_rescue_hostage_exfil", self.teams[0], 2.0 );
        _id_6C4E8CEA70BF4B6D::_id_A1738A95D7AA8094( "dmz_hostage_exfilled", "hostage", self._id_EFA8EF05B190D7D0._id_723B8F7CB71CEB11, self.teams[0] );
        self._id_FE593BA7D0935BB5 = self.teams[0];
        wait 1.0;
        thread _id_CB2F74520E05756F();
    }

    wait 8.0;

    if ( !istrue( self.failure ) )
        _id_5307834CD39B435C::_id_309C0A11484CC0DB( self.heli._id_878914B0358BC7B5 );
}

_id_7CFC061C84DD495A()
{
    if ( self.heli _id_53AAC5AE7D2AC1B4::_id_773691F1A617F7D9( self.hostage.origin ) )
    {
        self.instance setscriptablepartstate( "dmz_hostage", "unusable" );
        self._id_90758EFDE9B783B7 = spawn( "script_origin", self.hostage.origin );
        self._id_90758EFDE9B783B7 linkto( self.heli );
        self.hostage linkto( self._id_90758EFDE9B783B7 );
        self.hostage.invulnerable = 1;
        self._id_49AD1A873F5F008B = 1;
        self.heli notify( "dmz_exfil_hostage_inside" );
    }
}

_id_8EBF38FBB99AF797( player )
{
    if ( !scripts\engine\utility::array_contains_key( self._id_878914B0358BC7B5, player.guid ) )
    {
        self._id_878914B0358BC7B5[player.guid] = player;
        scripts\mp\outofbounds::enableoobimmunity( player );
    }

    if ( istrue( self._id_B8EBE3F71A08AB40._id_49AD1A873F5F008B ) && isdefined( self._id_75ADB7F3CBE5D522 ) )
    {
        if ( !isdefined( player._id_85B67879837F2019 ) )
        {
            self._id_0902A7FFCFF8AA65[self._id_0902A7FFCFF8AA65.size] = player;
            player thread _id_5307834CD39B435C::_id_496941BF27AF77B1( self.origin, self._id_75ADB7F3CBE5D522, 2000 );
        }
    }
    else if ( isdefined( self._id_B8EBE3F71A08AB40.carryingplayer ) && player == self._id_B8EBE3F71A08AB40.carryingplayer )
        return;
}

_id_F6685FAD77B7F64D( player )
{
    self._id_878914B0358BC7B5[player.guid] = undefined;
    scripts\mp\outofbounds::disableoobimmunity( player );
}

_id_0662CA8C888B5EB6( startnode, heliheight, reverse )
{
    if ( !isdefined( reverse ) )
        reverse = 0;

    _id_3FB4A86293ED25A6 = 10;
    contents = scripts\engine\trace::create_contents( 0, 1, 1, 1, 1, 0, 1, 1, 0 );
    startpos = startnode.origin + ( 0, 0, heliheight + 600 );
    _id_3674D96C61E2DD0D = scripts\engine\utility::ter_op( reverse, startnode.angles[1] + 180, startnode.angles[1] );

    for ( yaw = 0; yaw < 360; yaw = yaw + _id_3FB4A86293ED25A6 )
    {
        _id_3674D96C61E2DD0D = _id_3674D96C61E2DD0D + yaw;
        _id_211FC11F4C8566F5 = ( 0, _id_3674D96C61E2DD0D, 0 );
        _id_29006F80487A7787 = startpos;
        _id_DD77D0A6D708AC18 = startpos + anglestoforward( _id_211FC11F4C8566F5 ) * 18000;
        _id_D4EB961F60968A16 = scripts\engine\trace::sphere_trace( _id_29006F80487A7787, _id_DD77D0A6D708AC18, 100, undefined, contents, 1 );

        if ( _id_D4EB961F60968A16["fraction"] == 1 )
            return _id_DD77D0A6D708AC18;

        if ( yaw % 3 == 0 )
            waitframe();
    }

    return undefined;
}

_id_9597B6C3F099D3D7()
{
    self._id_B8EBE3F71A08AB40 endon( "task_ended" );

    if ( !istrue( self._id_49AD1A873F5F008B ) )
        self waittill( "dmz_exfil_hostage_inside" );

    self._id_75ADB7F3CBE5D522 = 15;

    foreach ( player in self._id_878914B0358BC7B5 )
    {
        if ( !isdefined( player._id_85B67879837F2019 ) )
        {
            self._id_0902A7FFCFF8AA65[self._id_0902A7FFCFF8AA65.size] = player;
            player thread _id_5307834CD39B435C::_id_496941BF27AF77B1( self.origin, self._id_75ADB7F3CBE5D522, 2000 );
        }
    }

    while ( self._id_75ADB7F3CBE5D522 > 0 )
    {
        self._id_75ADB7F3CBE5D522 = self._id_75ADB7F3CBE5D522 - 1;
        wait 1.0;
    }
}

_id_8C05501355CC8322()
{
    self.heli endon( "death" );
    level endon( "game_ended" );
    _id_C82EFE11C4073AF4 = [];

    for (;;)
    {
        wait 1.0;
        _id_7408ED52662703D3 = scripts\common\utility::playersincylinder( self.heli.origin, 665, undefined, 500 );

        foreach ( player in _id_7408ED52662703D3 )
        {
            if ( !isdefined( _id_C82EFE11C4073AF4[player.guid] ) )
                _id_C82EFE11C4073AF4[player.guid] = gettime();

            if ( gettime() - _id_C82EFE11C4073AF4[player.guid] > 5000 )
            {
                player scripts\mp\hud_message::showerrormessage( "MP_DMZ_MISSIONS/HOSTAGE_HELI_MSG" );
                _id_C82EFE11C4073AF4[player.guid] = gettime();
            }
        }

        if ( _id_7408ED52662703D3.size == 0 )
            break;
    }
}

_id_2D144609316A301E()
{
    self.heli waittill( "death" );

    if ( isdefined( self.hostage ) && isalive( self.hostage ) && istrue( self._id_49AD1A873F5F008B ) )
        self.hostage _id_48814951E916AF89::_id_28B90EB2B591003F();
}

_id_F0C7539DC72C3DFD()
{
    alllocations = scripts\engine\utility::array_randomize( scripts\engine\utility::getstructarray( "hostage_setup", "targetname" ) );
    validlocations = [];
    _id_A940C1AC967427FE = scripts\engine\utility::array_randomize( scripts\engine\utility::getstructarray( "dmz_hostage_exfil", "script_noteworthy" ) );

    foreach ( loc in alllocations )
    {
        isvalid = 1;

        if ( !isdefined( loc.target ) )
            continue;

        _id_B586C70B173DD02B = scripts\engine\utility::getstructarray( loc.target, "targetname" );

        foreach ( _id_FB1DEF007972B25A in _id_B586C70B173DD02B )
        {
            if ( isdefined( _id_FB1DEF007972B25A.script_noteworthy ) && _id_FB1DEF007972B25A.script_noteworthy == "hostage" )
            {
                pos = getclosestpointonnavmesh( _id_FB1DEF007972B25A.origin );

                if ( distance( pos, _id_FB1DEF007972B25A.origin ) > 100 )
                {
                    isvalid = 0;
                    break;
                }
            }
        }

        if ( !isvalid )
            continue;

        _id_276AC5E84835EA87 = _id_4948CDF739393D2D::_id_C0A211A69F5F8F2F( loc.origin );

        if ( isdefined( _id_276AC5E84835EA87 ) )
        {
            if ( istrue( loc.inuse ) )
                continue;

            foreach ( chosen in level._id_F1073FBD45B59A06._id_DF987907A483DF89 )
            {
                if ( chosen == _id_276AC5E84835EA87 )
                {
                    isvalid = 0;
                    break;
                }
            }
        }

        _id_276AC5E84835EA87 = _id_4948CDF739393D2D::_id_BAEF4910ACEA00F0( loc.origin );

        if ( distancesquared( _id_276AC5E84835EA87.origin, loc.origin ) > 1048576 || scripts\engine\utility::array_contains( level._id_F1073FBD45B59A06._id_DF987907A483DF89, _id_276AC5E84835EA87 ) )
            continue;

        _id_636C8575D7A7768B = 12000;

        foreach ( heli in _id_A940C1AC967427FE )
        {
            dist = distance( loc.origin, heli.origin );

            if ( !istrue( heli.chosen ) && dist < _id_636C8575D7A7768B )
            {
                _id_636C8575D7A7768B = dist;
                loc._id_23D42B1195DDA679 = heli;
            }
        }

        if ( isdefined( loc._id_23D42B1195DDA679 ) )
            loc._id_23D42B1195DDA679.chosen = 1;
        else
            isvalid = 0;

        if ( isvalid )
            validlocations[validlocations.size] = loc;
    }

    return validlocations;
}
