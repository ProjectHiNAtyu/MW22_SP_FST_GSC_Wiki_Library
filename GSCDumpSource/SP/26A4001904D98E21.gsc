// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

destructible_vehicle_init()
{
    _func_A39466ADC48F650F( "car_grenade" );
    thread destructible_vehicle_main();
}

destructible_vehicle_main()
{
    waitframe();
    scriptables = getentarray( "scriptable", "code_classname" );

    foreach ( scriptable in scriptables )
    {
        if ( issubstr( scriptable.model, "veh_" ) || issubstr( scriptable.model, "veh8_" ) || issubstr( scriptable.model, "veh9_" ) )
            scriptable thread destructible_vehicle_thread();
    }
}

destructible_vehicle_thread()
{
    self.destructible_type = "vehicle";

    for (;;)
    {
        self waittill( "scriptableNotification", _id_A234A65C378F3289, param );

        switch ( _id_A234A65C378F3289 )
        {
            case "onfire":
            case "flareup":
                thread burningcar_indicator();
                break;
            case "vehicle_death":
            case "anim_explosion_complete":
            case "anim_explosion":
                self notify( "destroyed" );

                if ( isdefined( self.burningcarindicator ) )
                    self.burningcarindicator delete();

                self.onfire = undefined;
                return;
        }
    }
}

burningcar_indicator()
{
    if ( isdefined( self.burningcarindicator ) )
        return;

    self endon( "destroyed" );
    self.onfire = 1;
    wait 0.2;
    self.burningcarindicator = _func_22E707DB087AA60E( "car_grenade", self.origin + ( 0, 0, 10 ), self.origin, 9999, 0 );
    self.burningcarindicator.targetname = "offhand_car_grenade";
    self.burningcarindicator makeunusable();
}
