// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

precache( offhand )
{
    level.g_effect["bottle_break"] = loadfx( "vfx/iw9/core/bottle/vfx_bottle_explosion.vfx" );
    level.offhands._id_8A967B32BA39402D = spawnstruct();
    level.offhands._id_8A967B32BA39402D._id_9C36B02032770C02 = undefined;
    scripts\sp\equipment\offhands::registeroffhandfirefunc( offhand, ::_id_4B06C81B27875A14 );
}

_id_4B06C81B27875A14( grenade, weapon )
{
    grenade waittill( "missile_stuck", stuckto, _id_041453C3C237F2DF, _id_DDD80F5D1DA23C60, _id_AA416133E3CF5BF5, position, _id_3E293ABD063AA9F5 );
    grenade delete();
    thread scripts\engine\utility::play_sound_in_space( "weap_bottle_explo", position );
    right = undefined;

    if ( scripts\engine\utility::is_equal( _id_3E293ABD063AA9F5, ( 0, 0, 1 ) ) || scripts\engine\utility::is_equal( _id_3E293ABD063AA9F5, ( 0, 0, -1 ) ) )
        right = ( 1, 0, 0 );
    else
        right = vectorcross( _id_3E293ABD063AA9F5, ( 0, 0, 1 ) );

    playfx( level.g_effect["bottle_break"], position, right, _id_3E293ABD063AA9F5 );
    playrumbleonposition( "grenade_rumble", position );
    earthquake( 0.15, 0.35, position, 300 );

    if ( isdefined( stuckto ) && isai( stuckto ) )
        thread _id_A32BB7BB61372225( stuckto, position, _id_041453C3C237F2DF, _id_AA416133E3CF5BF5 );

    if ( !isplayer( self ) )
    {
        level notify( "bottle_impact" );
        return;
    }
}

_id_A32BB7BB61372225( ai, position, _id_041453C3C237F2DF, _id_AA416133E3CF5BF5 )
{
    if ( isdefined( ai._id_879FAED8E3A3276F ) )
        ai thread [[ ai._id_879FAED8E3A3276F ]]( position, _id_041453C3C237F2DF, _id_AA416133E3CF5BF5 );

    waitframe();

    if ( !istrue( ai.disablepain ) )
        ai notify( "flashbang", position, 1, 1, level.player, "axis" );
}
