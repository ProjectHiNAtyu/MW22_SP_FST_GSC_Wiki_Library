// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

_id_E99B6309C3D5FB0C()
{

}

_id_C01C0AB6874A0725()
{
    scripts\engine\sp\utility::set_start_location( "strike_overwatch_start", level.player );
}

_id_CD8A063179E08A15()
{
    thread scripts\engine\sp\utility::hint( "Press [{+activate}] to launch predator missile" );

    for (;;)
    {
        level.player waittill( "use_pressed" );
        _id_EB86A5CD1650B4AF = 0;
        _id_D5685B7BAEE6505E = scripts\engine\utility::getstruct( "peak_icbm_start", "targetname" ).origin;
        end_pos = scripts\engine\utility::getstruct( "peak_base_center", "targetname" ).origin;
        level.player runcruisepredator( _id_EB86A5CD1650B4AF, _id_D5685B7BAEE6505E, end_pos );
        level waittill( "cruise_missile_explode" );
        iprintlnbold( "Missile impacted." );
    }
}

_id_C18E8F696E2629EA()
{

}

_id_EA28E5A8692ED519()
{
    precachemodel( "wmd_vm_missile_cruise_warhead_sp" );
    precachemodel( "wmd_vm_missile_cruise_sp" );
    precachemodel( "ks_cruise_predator_mp" );
    precachemodel( "tag_player" );
}

_id_33A87BC008897C8B( _id_6F69FEF7BF3F4EFB, _id_F51B79A7D12057D9 )
{
    _id_60A60D7DD51B4E06( _id_6F69FEF7BF3F4EFB, vectortoangles( _id_F51B79A7D12057D9 - _id_6F69FEF7BF3F4EFB ) );
    level._id_D1C73D5538A80325.black_screen = _id_79FB381FD77D2642::black_screen();
    level._id_D1C73D5538A80325 hide();
    visionsetnaked( "strike_missile_flight", 0 );
    level.player _id_3B64EB40368C1450::set( "cruise_missile", "cg_drawcrosshair", 0 );
    level.player _id_3B64EB40368C1450::set( "cruise_missile", "show_weapon_hud", 0 );
}

runcruisepredator( _id_EB86A5CD1650B4AF, _id_6F69FEF7BF3F4EFB, _id_F51B79A7D12057D9 )
{
    self setclientomnvar( "ui_predator_missile", 2 );
    self.restoreangles = self.angles;
    level.remotemissileinprogress = 1;
    scripts\engine\utility::flag_wait( "scriptables_ready" );
    result = cruisepredator_followmissilepod( _id_F51B79A7D12057D9, _id_EB86A5CD1650B4AF );
    return result;
}

cruisepredator_followmissilepod( _id_8929D2C10BEB2FDE, _id_EB86A5CD1650B4AF )
{
    enemytargetmarkergroup = undefined;
    friendlytargetmarkergroup = undefined;

    if ( !isdefined( self ) )
        return 0;

    thread cruisepredator_takecontrol( _id_EB86A5CD1650B4AF, enemytargetmarkergroup, friendlytargetmarkergroup );
    return 1;
}

cruisepredator_takecontrol( _id_EB86A5CD1650B4AF, enemytargetmarkergroup, friendlytargetmarkergroup )
{
    self endon( "disconnect" );
    level endon( "game_ended" );
    _id_3B64EB40368C1450::set( "cruisePredator", "fire", 1 );
    level._id_D1C73D5538A80325 show();
    _id_79FB381FD77D2642::_id_1B8B279CF9721DD9( level._id_D1C73D5538A80325.black_screen );
    level._id_D1C73D5538A80325.cannotbesuspended = 1;
    level._id_D1C73D5538A80325 thread _id_742906810293C8BE();
    level._id_D1C73D5538A80325 setcandamage( 0 );
    level._id_D1C73D5538A80325 setotherent( self );
    level._id_D1C73D5538A80325 setentityowner( self );
    level._id_D1C73D5538A80325.team = self.team;
    level._id_D1C73D5538A80325.owner = self;
    level._id_D1C73D5538A80325.lifetime = 10;
    level._id_D1C73D5538A80325.weapon_name = "cruise_proj_mp";
    level._id_D1C73D5538A80325 setvehicleteam( level._id_D1C73D5538A80325.team );
    level._id_D1C73D5538A80325 endon( "death" );
    level._id_D1C73D5538A80325 thread _id_FB8EE9EFEAD0E4AF( self );
    fxent = spawn( "script_model", level._id_D1C73D5538A80325 gettagorigin( "tag_fx" ) );
    fxent setmodel( "ks_cruise_predator_mp" );
    fxent hide();
    fxent.angles = level._id_D1C73D5538A80325 gettagangles( "tag_fx" );
    fxent.team = level._id_D1C73D5538A80325.team;
    fxent.owner = level._id_D1C73D5538A80325.owner;
    fxent linkto( level._id_D1C73D5538A80325, "tag_fx" );
    fxent setotherent( self );
    fxent thread cruisepredator_watchgameend();
    fxent thread cruisepredator_watchmissileinfo( level._id_D1C73D5538A80325 );
    fxent thread cruisepredator_watchmissileexplosion( level._id_D1C73D5538A80325, self, undefined, _id_EB86A5CD1650B4AF, enemytargetmarkergroup, friendlytargetmarkergroup );
    level._id_D1C73D5538A80325 thread cruisepredator_watchownerdisownaction( "disconnect" );
    level._id_D1C73D5538A80325 thread cruisepredator_watchownerdisownaction( "joined_team" );
    level._id_D1C73D5538A80325 thread cruisepredator_watchownerdisownaction( "joined_spectators" );

    if ( !istrue( _id_EB86A5CD1650B4AF ) )
    {
        level._id_D1C73D5538A80325 scripts\engine\utility::ent_flag_set( "player_posessed_missile" );
        self usevehicle( level._id_D1C73D5538A80325, 0 );
        level.player playsound( "scn_strike_missile_flight_start_01_lr" );
        level._id_95A2640E8C2F125C = spawn( "script_origin", level._id_D1C73D5538A80325.origin );
        level._id_95A2640E8C2F125C scripts\engine\utility::delaythread( 0.2, scripts\engine\sp\utility::sound_fade_in, "scn_strike_missile_flight_lp_01_lr", 1.0, 0.6, 1 );
        level._id_0AE17E9E7A0A8E9A = spawn( "script_origin", level._id_D1C73D5538A80325.origin );
        level._id_0AE17E9E7A0A8E9A playloopsound( "scn_strike_missile_flight_lp_banking_01_lr" );
        level thread _id_BB25D3DEB1DDA179();
    }

    level._id_D1C73D5538A80325 thread cruisepredator_delaymissilecollision();
    level._id_D1C73D5538A80325 thread cruisepredator_watchtimer( self );
}

_id_BB25D3DEB1DDA179()
{
    level endon( "cruise_missile_explode" );
    _id_97E6EF5AB12263E3 = 0;

    for (;;)
    {
        _id_374ABB46E0E87498 = level.player getplayerangles();
        _id_97E6EF5AB12263E3 = ( abs( _id_374ABB46E0E87498[2] ) / 27 + _id_97E6EF5AB12263E3 + _id_97E6EF5AB12263E3 ) / 3;

        if ( _id_97E6EF5AB12263E3 > 1 )
            _id_97E6EF5AB12263E3 = 1;

        if ( _id_97E6EF5AB12263E3 < 0.02 )
            _id_97E6EF5AB12263E3 = 0.02;

        if ( isdefined( level._id_0AE17E9E7A0A8E9A ) )
            level._id_0AE17E9E7A0A8E9A _meth_F4604329F388A96F( _id_97E6EF5AB12263E3, 0.05 );

        waitframe();
    }
}

_id_ADBC4547FA989C23()
{
    level.player endon( "cruise_missile_finished" );
    level.player endon( "death" );
    _id_DCC39AB9D58BF5FE = level.player _id_79FB381FD77D2642::_id_EED166A97E91BC87();

    for (;;)
    {
        waitframe();

        if ( level.player _id_79FB381FD77D2642::_id_EED166A97E91BC87() && !_id_DCC39AB9D58BF5FE )
        {
            _id_DCC39AB9D58BF5FE = level.player _id_79FB381FD77D2642::_id_EED166A97E91BC87();
            _id_60A60D7DD51B4E06( self.origin, self.angles );
        }
    }
}

_id_60A60D7DD51B4E06( origin, angles )
{
    origin = scripts\engine\utility::_id_53C4C53197386572( origin, ( 0, 1000, 1000 ) );
    angles = scripts\engine\utility::_id_53C4C53197386572( angles, ( 0, 0, 0 ) );
    _id_EE8DA5624236DC89 = spawnstruct();
    _id_0D09CDEA043334C2 = spawnvehicle( "wmd_vm_missile_cruise_warhead_sp", "rcplane", "veh_cruise_predator_sp", origin, angles );

    if ( !isdefined( _id_0D09CDEA043334C2 ) )
        return;

    if ( isdefined( level._id_D1C73D5538A80325 ) )
    {
        _id_0D09CDEA043334C2 _meth_E5ED5EED17D58707( level._id_D1C73D5538A80325 vehicle_getvelocity() );
        level._id_D1C73D5538A80325 delete();
    }

    level._id_D1C73D5538A80325 = _id_0D09CDEA043334C2;
}

_id_FB8EE9EFEAD0E4AF( player )
{
    player endon( "death" );
    player endon( "cruise_missile_finished" );
    level._id_D1C73D5538A80325 endon( "missile_boosted" );

    for (;;)
    {
        player _meth_8EBB1FB4F90C415B( 1, 1, 1, 0.5, 0.2, 0.2, 850, 0.5 );
        player playrumbleonentity( "viewmodel_xsmall" );
        wait 0.15;
    }
}

_id_742906810293C8BE()
{
    scripts\engine\utility::flag_wait( "scriptables_ready" );
    trigger = getent( "missile_bounds", "targetname" );
    _id_4A44F48694127C66( trigger );
    setomnvar( "ui_out_of_bounds_countdown", 0 );
}

_id_4A44F48694127C66( trigger )
{
    trigger endon( "death" );
    self endon( "death" );
    scripts\engine\utility::ent_flag_init( "out_of_bounds" );

    for (;;)
    {
        while ( trigger istouching( self ) )
            waitframe();

        setomnvar( "ui_out_of_bounds_countdown", 1 );
        start_time = gettime();
        scripts\engine\utility::ent_flag_set( "out_of_bounds" );

        while ( !trigger istouching( self ) )
        {
            if ( scripts\engine\utility::time_has_passed( start_time, 4 ) )
            {
                setomnvar( "ui_out_of_bounds_countdown", 0 );

                if ( scripts\engine\utility::flag( "missile_left_canyon" ) )
                    scripts\sp\player_death::set_custom_death_quote( 29 );
                else
                    scripts\sp\player_death::set_custom_death_quote( 487 );

                scripts\sp\utility::missionfailedwrapper();
                return;
            }

            waitframe();
        }

        scripts\engine\utility::ent_flag_clear( "out_of_bounds" );
        setomnvar( "ui_out_of_bounds_countdown", 0 );
    }
}

cruisepredator_delaymissilecollision()
{
    self endon( "death" );
    self endon( "cruise_missile_explode" );
    wait 0.75;
    self vehphys_enablecollisioncallback( 1 );
    wait 1.25;
}

cruisepredator_watchtimer( rider )
{
    self endon( "death" );
    wait 40;
    self notify( "explode", self.origin );
}

cruisepredator_watchintropoddisown( enemytargetmarkergroup, friendlytargetmarkergroup )
{
    self endon( "death" );
    level endon( "game_ended" );
    self waittill( "disowned" );

    if ( isdefined( self ) )
    {
        cruisepredator_detachplayerfromintro( enemytargetmarkergroup, friendlytargetmarkergroup );
        self delete();
    }
}

cruisepredator_watchownerdisownaction( action )
{
    self endon( "death" );
    self endon( "disowned" );
    level endon( "game_ended" );
    _id_4084C95C19C7937A = self.owner;
    _id_4084C95C19C7937A waittill( action );
    self notify( "disowned" );
}

cruisepredator_detachplayerfromintro( enemytargetmarkergroup, friendlytargetmarkergroup )
{
    _id_4084C95C19C7937A = self.owner;

    if ( isdefined( _id_4084C95C19C7937A ) )
    {
        _id_4084C95C19C7937A disablephysicaldepthoffieldscripting();
        _id_4084C95C19C7937A unlink();
        _id_4084C95C19C7937A setclientomnvar( "ui_predator_missile", 0 );
        _id_4084C95C19C7937A painvisionon();
        level thread scripts\sp\hud_util::fade_in( 0, "black" );
    }
}

cruisepredator_watchgameend()
{
    self endon( "death" );
    self.owner endon( "disconnect" );
    self.owner endon( "cruise_missile_finished" );
    level waittill( "game_ended" );
}

cruisepredator_watchmissileexplosion( missile, rider, killcament, _id_EB86A5CD1650B4AF, enemytargetmarkergroup, friendlytargetmarkergroup )
{
    _id_45292519459D6838 = undefined;
    _id_D0B12377BC0EC26F = undefined;

    for (;;)
    {
        _id_DF4B15EE230BF93A = missile cruisepredator_waittillexplode( "collision", "explode", "death", "disowned", "emp_defused", "trophy_blocked" );
        _id_716D785156E6FFB2 = getdvarint( "dvar_B1FA07A51B801B6B", 0 );
        break;
    }

    if ( isdefined( level.player.og_fov ) )
        level.player _meth_1D98630AA343510D( level.player.og_fov );

    missile notify( "cruise_missile_explode" );
    missile scripts\engine\utility::ent_flag_set( "exploded" );
    level.player _id_3B64EB40368C1450::_id_C9D0B43701BDBA00( "cruise_missile" );

    if ( isdefined( self ) )
    {
        _id_45292519459D6838 = self.missilelastpos;
        _id_D0B12377BC0EC26F = self.missilelastangle;

        if ( isdefined( rider ) )
        {
            rider cameraunlink();
            rider _meth_C0505F05660D120C();
        }

        if ( isdefined( missile ) )
            missile delete();

        if ( !isdefined( _id_DF4B15EE230BF93A ) || _id_DF4B15EE230BF93A.msg != "emp_defused" && _id_DF4B15EE230BF93A.msg != "trophy_blocked" )
        {
            _id_35BBF066F50AC582 = 600;
            _id_5D28F39073721E59 = "MOD_EXPLOSIVE";
            _id_23F8C678BD9D023E = "cruise_proj_mp";

            if ( isdefined( rider ) )
            {
                _id_F9FB154DDE29912B = isdefined( _id_DF4B15EE230BF93A ) && _id_DF4B15EE230BF93A.msg == "disowned";

                if ( !istrue( _id_F9FB154DDE29912B ) )
                    self radiusdamage( _id_45292519459D6838, _id_35BBF066F50AC582, 1000, 1000, rider, _id_5D28F39073721E59, _id_23F8C678BD9D023E );
            }
        }

        thread cruisepredator_handlevfxstates( _id_DF4B15EE230BF93A );
    }

    level notify( "cruise_missile_explode", _id_45292519459D6838, _id_DF4B15EE230BF93A );

    if ( isdefined( rider ) )
    {
        if ( !istrue( _id_EB86A5CD1650B4AF ) )
        {
            level thread _id_6DC740A7DDCAB60C::_id_DD9DEDB2A8FCFB6F();
            level.player clearsoundsubmix( "iw9_sp_strike_missile_up", 0.1 );
            rider setclientomnvar( "ui_predator_missile", 0 );
            _id_4D91D0458127BDC0 = 1;
            _id_FC0043E95242D5CB = "killstreak_static";

            if ( _id_4D91D0458127BDC0 == 2 )
                _id_FC0043E95242D5CB = "killstreak_flash";

            _id_FC0043E95242D5CB = undefined;
            rider thread cruisepredator_startfadecamtransition( 0.4, 0.6, 0.05, _id_FC0043E95242D5CB );
            _id_EF269077A28646EB = scripts\common\utility::playersinsphere( _id_45292519459D6838, 2000 );
            rider earthquakeforplayer( 0.3, 3, rider.origin, 100 );
            rider playrumbleonpositionforclient( "artillery_rumble", rider.origin );
            rider notify( "cruise_missile_finished" );
            rider cruisepredator_returnplayer();
        }
    }
}

cruisepredator_returnplayer()
{
    self cameraunlink();
    self _meth_5773CD2DCAA3AEEE();
    visionsetnaked( "", 0 );
    level thread restorekillstreakplayerangles( self );
}

restorekillstreakplayerangles( player )
{
    player endon( "death_or_disconnect" );
    level endon( "game_ended" );
    _id_F7FEEE8E3D1BE662 = 0.5;

    if ( !isdefined( player.restoreangles ) )
        return;

    while ( _id_F7FEEE8E3D1BE662 > 0 )
    {
        player setplayerangles( ( player.restoreangles[0], player.restoreangles[1], 0 ) );
        _id_F7FEEE8E3D1BE662 = _id_F7FEEE8E3D1BE662 - 0.05;
        wait 0.05;
    }

    player.restoreangles = undefined;
}

cruisepredator_startfadecamtransition( _id_EE006CF398BCD8FD, _id_06EA9CF1222359E6, _id_C8FE6E3CA9715960, _id_2007EDE6118D6B9F )
{
    if ( !isdefined( _id_EE006CF398BCD8FD ) )
        _id_EE006CF398BCD8FD = 0.5;

    if ( !isdefined( _id_06EA9CF1222359E6 ) )
        _id_06EA9CF1222359E6 = 0.5;

    if ( !isdefined( _id_C8FE6E3CA9715960 ) )
        _id_C8FE6E3CA9715960 = 0.05;

    if ( isdefined( _id_2007EDE6118D6B9F ) )
        wait( _id_06EA9CF1222359E6 );
    else
        wait( _id_06EA9CF1222359E6 );
}

cruisepredator_handlevfxstates( _id_DF4B15EE230BF93A )
{
    self endon( "death" );
    self unlink();

    if ( !isdefined( _id_DF4B15EE230BF93A ) || _id_DF4B15EE230BF93A.msg == "explode" || _id_DF4B15EE230BF93A.msg == "disowned" || _id_DF4B15EE230BF93A.msg == "emp_defused" || _id_DF4B15EE230BF93A.msg == "trophy_blocked" )
    {
        wait 0.2;
        self delete();
    }

    _id_303D9FA226476812 = ( 0, 0, 1 );
    _id_5E8EDE0EF6D7F3AB = _id_DF4B15EE230BF93A.param6;
    self.angles = vectortoangles( _id_5E8EDE0EF6D7F3AB );
    _id_75FB158DC4A7D84D = vectordot( _id_5E8EDE0EF6D7F3AB, _id_303D9FA226476812 );
    wait 1;
    self delete();
}

cruisepredator_waittillexplode( _id_E127AF0EAB592C1A, _id_E127AE0EAB5929E7, _id_E127AD0EAB5927B4, _id_E127AC0EAB592581, _id_E127AB0EAB59234E, _id_E127AA0EAB59211B )
{
    ent = spawnstruct();

    if ( isdefined( _id_E127AF0EAB592C1A ) )
        thread waittill_explodestring( _id_E127AF0EAB592C1A, ent );

    if ( isdefined( _id_E127AE0EAB5929E7 ) )
        thread waittill_explodestring( _id_E127AE0EAB5929E7, ent );

    if ( isdefined( _id_E127AD0EAB5927B4 ) )
        thread waittill_explodestring( _id_E127AD0EAB5927B4, ent );

    if ( isdefined( _id_E127AC0EAB592581 ) )
        thread waittill_explodestring( _id_E127AC0EAB592581, ent );

    if ( isdefined( _id_E127AB0EAB59234E ) )
        thread waittill_explodestring( _id_E127AB0EAB59234E, ent );

    if ( isdefined( _id_E127AA0EAB59211B ) )
        thread waittill_explodestring( _id_E127AA0EAB59211B, ent );

    ent waittill( "returned", msg, param1, param2, param3, param4, param5, param6, param7, param8 );
    ent notify( "die" );
    _id_DF4B15EE230BF93A = spawnstruct();
    _id_DF4B15EE230BF93A.msg = msg;
    _id_DF4B15EE230BF93A.param1 = param1;
    _id_DF4B15EE230BF93A.param2 = param2;
    _id_DF4B15EE230BF93A.param3 = param3;
    _id_DF4B15EE230BF93A.param4 = param4;
    _id_DF4B15EE230BF93A.param5 = param5;
    _id_DF4B15EE230BF93A.param6 = param6;
    _id_DF4B15EE230BF93A.param7 = param7;
    _id_DF4B15EE230BF93A.param8 = param8;
    return _id_DF4B15EE230BF93A;
}

waittill_explodestring( msg, ent )
{
    self endon( "death" );
    ent endon( "die" );
    self waittill( msg, param1, param2, param3, param4, param5, param6 );
    ent notify( "returned", msg, param1, param2, param3, param4, param5, param6 );
}

cruisepredator_watchmissileinfo( missile )
{
    self endon( "death" );

    for (;;)
    {
        self.missilelastpos = missile.origin;
        self.missilelastangle = missile.angles;
        waitframe();
    }
}

cruisepredator_delayplayslamzoom( _id_74B5B12BB6514385, _id_EB86A5CD1650B4AF )
{
    self endon( "disconnect" );
    wait( _id_74B5B12BB6514385 );

    if ( !istrue( _id_EB86A5CD1650B4AF ) )
    {
        thread scripts\sp\hud_util::fade_in( 0.2, "black" );
        wait 0.2;
        thread scripts\sp\hud_util::fade_in( 0 );
    }
}

cruisepredator_playdofsequence()
{
    self endon( "death" );
    self.owner endon( "disconnect" );
    level endon( "game_ended" );
    self.owner enablephysicaldepthoffieldscripting();
    wait 0.5;
    self.owner setphysicaldepthoffield( 0.2, 300, 20, 10 );
    wait 3;
    self.owner setphysicaldepthoffield( 5.6, 5000, 3, 10 );
}
