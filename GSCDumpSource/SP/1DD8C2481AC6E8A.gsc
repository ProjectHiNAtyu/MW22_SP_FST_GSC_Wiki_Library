// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

pip_init()
{
    return;
}

pip_on_ent( ent, tag, fov, origin_offset, angles_offset, _id_7E23E82A6250D2F0 )
{
    if ( getdvarint( "dvar_44D682E24130295A" ) )
        return;

    if ( gettime() < 500 )
        wait 0.5;

    if ( !isdefined( tag ) )
        return;

    if ( !isdefined( level.pip ) )
        level.pip = level.player _meth_6C6DD959D59ECF5E();

    if ( pip_is_active() )
        return;

    level.pip.enableshadows = 1;
    level.pip.rendertotexture = 1;
    level.pip.clipdistance = 5000;
    level.pip.nearz = 2;
    level.pip.aspectratio = 1;
    level.pip.origin_offset = ( 0, 0, 0 );
    level.pip.angles_offset = ( 0, 0, 0 );
    level.pip.tag = tag;
    level.pip.fov = scripts\engine\utility::ter_op( isdefined( fov ), fov, 30 );

    if ( isdefined( origin_offset ) )
        level.pip.origin_offset = origin_offset;

    if ( isdefined( angles_offset ) )
        level.pip.angles_offset = angles_offset;

    level.pip.entity = ent;
    level.pip.enable = 1;
    level.pip.freecamera = 1;
    setomnvar( "ui_pip_static", 0 );
    setomnvar( "ui_pip_message_text_top", "script_pip_default_top" );
    setomnvar( "ui_pip_message_text_bottom", "script_pip_default_bottom" );
    setomnvar( "ui_pip_message_type", 1 );

    if ( !isdefined( _id_7E23E82A6250D2F0 ) )
    {
        setomnvar( "ui_show_pip", 1 );
        setomnvar( "ui_jackal_hide_follow_pip", 0 );
    }
}

bink_pip( _id_22CD6AE7DCAE5E3F )
{
    level.player playsound( "ui_pip_on_hud_right" );
    setomnvar( "ui_pip_message_text_top", "script_pip_default_top" );
    setomnvar( "ui_pip_message_text_bottom", "script_pip_default_bottom" );
    _func_ 5770D2EA2D158CF();
    setsaveddvar( "dvar_D3EE5A6578FE61DE", "0" );
    setsaveddvar( "dvar_B9FF37D084074DF3", "1" );
    setomnvar( "ui_show_pip", 1 );
    wait 0.05;
    setomnvar( "ui_show_pip", 0 );
    wait 0.05;
    setomnvar( "ui_show_pip", 1 );
    _func_1EB3E4964FF5A2EF( _id_22CD6AE7DCAE5E3F );

    while ( !_func_D0860C69E8E4022C() )
        wait 0.05;

    while ( _func_D0860C69E8E4022C() )
        wait 0.05;

    _func_ 5770D2EA2D158CF();
    setomnvar( "ui_show_pip", 0 );
    level.player playsound( "ui_pip_off_hud_right" );
    setsaveddvar( "dvar_D3EE5A6578FE61DE", "1" );
    setsaveddvar( "dvar_B9FF37D084074DF3", "1" );
}

pip_visionset( _id_66C1FA3CB97E511D )
{
    level.pip.activevisionset = "naked";
    level.pip.activevisionsetduration = 0.5;
    level.pip.visionsetnaked = _id_66C1FA3CB97E511D;
}

pip_close()
{
    if ( getdvarint( "dvar_44D682E24130295A" ) )
        return;

    if ( !isdefined( level.pip ) )
        return;

    setomnvar( "ui_show_pip", 0 );
    setomnvar( "ui_jackal_hide_follow_pip", 1 );
    level.pip.enable = 0;
    level notify( "pip_closed" );
}

pip_is_active()
{
    return isdefined( level.pip ) && isdefined( level.pip.enable ) && level.pip.enable;
}

pip_dialogue( _id_EB2F5A048FA8470F )
{
    face_pip();
    scripts\engine\sp\utility::smart_dialogue_generic( _id_EB2F5A048FA8470F );
    pip_close();
}

face_pip( _id_7E23E82A6250D2F0 )
{
    switch ( tolower( self.unittype ) )
    {
        case "c6i":
            pip_on_ent( self, "tag_eye", 29, ( 18, 7, 1 ), ( 0, 200, 3 ), _id_7E23E82A6250D2F0 );
            break;
        case "jackal":
            pip_on_ent( self, "tag_barrel", 13, ( 150, 0, 20 ), ( 8.5, 180, 0 ), _id_7E23E82A6250D2F0 );
            break;
        default:
            pip_on_ent( self, "tag_eye", 29, ( 18, 7, -1 ), ( 0, 200, 3 ), _id_7E23E82A6250D2F0 );
            level.pip.nearz = 17;
            break;
    }
}

pip_vo()
{
    face_pip();
    self waittill( "close_pip" );
    pip_close();
}
