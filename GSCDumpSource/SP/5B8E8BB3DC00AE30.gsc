// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

main()
{
    self endon( "death" );
    self endon( "stop_animmode" );
    self notify( "killanimscript" );
    self._tag_entity endon( self._anime );

    if ( isdefined( self._custom_anim_thread ) )
    {
        self thread [[ self._custom_anim_thread ]]();
        self._custom_anim_thread = undefined;
    }

    loop = isdefined( self._custom_anim_loop ) && self._custom_anim_loop;

    if ( loop )
    {
        self endon( "stop_loop" );
        self._custom_anim_loop = undefined;
    }
    else
        thread notify_on_end( self._anime );

    anime = self._anime;
    self._anime = undefined;
    _id_4928EC336FD14163 = 0;

    if ( loop )
    {
        _id_4928EC336FD14163 = level.scr_anim[self._animname][anime].size;
        _id_D9D9EE6E67489912 = level.scr_anim[self._animname][anime][randomint( _id_4928EC336FD14163 )];
    }
    else
        _id_D9D9EE6E67489912 = level.scr_anim[self._animname][anime];

    origin = getstartorigin( self._tag_entity.origin, self._tag_entity.angles, _id_D9D9EE6E67489912 );
    angles = getstartangles( self._tag_entity.origin, self._tag_entity.angles, _id_D9D9EE6E67489912 );
    _id_A9706ADAF7C52E27 = self getdroptofloorposition( origin );

    if ( isdefined( _id_A9706ADAF7C52E27 ) )
        origin = _id_A9706ADAF7C52E27;
    else
    {

    }

    if ( !isdefined( self.noteleport ) )
        self _meth_BDEB65C70099A44A( origin, angles );

    self.pushable = 0;
    _id_6E2597877D503152 = 0.3;
    _id_D775E14980E96400 = 0.2;

    if ( isdefined( self.anim_blend_time_override ) )
    {
        _id_6E2597877D503152 = self.anim_blend_time_override;
        _id_D775E14980E96400 = self.anim_blend_time_override;
    }

    self animmode( self._animmode );
    self clearanim( scripts\asm\asm::asm_getroot(), 0.3 );
    _id_7C2E7606FE2F4B3D = scripts\asm\asm::asm_getfacialknob();

    if ( isdefined( _id_7C2E7606FE2F4B3D ) )
        self setanim( _id_7C2E7606FE2F4B3D, 1, 0.3, 1 );

    self orientmode( "face angle", angles[1] );
    self animmode( "zonly_physics", 1 );
    _id_314C4455B996B224 = "custom_animmode";
    self setflaggedanimrestart( _id_314C4455B996B224, _id_D9D9EE6E67489912, 1, _id_D775E14980E96400, 1 );
    self._tag_entity thread scripts\common\notetrack::start_notetrack_wait( self, _id_314C4455B996B224, anime, self._animname, _id_D9D9EE6E67489912 );
    self._tag_entity thread scripts\sp\anim::animscriptdonotetracksthread( self, _id_314C4455B996B224, anime );
    tag_entity = self._tag_entity;
    self._tag_entity = undefined;
    self._animmode = undefined;
    self endon( "killanimscript" );
    _id_53706A74886ACEBC = "end";

    if ( !loop )
    {
        if ( animhasnotetrack( _id_D9D9EE6E67489912, "finish" ) )
            _id_53706A74886ACEBC = "finish";
        else if ( animhasnotetrack( _id_D9D9EE6E67489912, "stop anim" ) )
            _id_53706A74886ACEBC = "stop anim";
    }

    for (;;)
    {
        self waittillmatch( _id_314C4455B996B224, _id_53706A74886ACEBC );

        if ( loop )
        {
            _id_D9D9EE6E67489912 = level.scr_anim[self._animname][anime][randomint( _id_4928EC336FD14163 )];
            self _meth_1EBF13E0D8270FB7( _id_314C4455B996B224, _id_D9D9EE6E67489912, 1, 0.2, 1 );

            if ( isdefined( tag_entity ) )
            {
                tag_entity thread scripts\common\notetrack::start_notetrack_wait( self, _id_314C4455B996B224, anime, self._animname, _id_D9D9EE6E67489912 );
                tag_entity thread scripts\sp\anim::animscriptdonotetracksthread( self, _id_314C4455B996B224, anime );
            }

            continue;
        }

        break;
    }

    if ( _id_53706A74886ACEBC != "end" )
        self orientmode( "face motion" );

    self notify( "finished_custom_animmode" + anime );
}

notify_on_end( msg )
{
    self endon( "death" );
    self endon( "finished_custom_animmode" + msg );
    self waittill( "killanimscript" );
    self notify( "finished_custom_animmode" + msg );
}
