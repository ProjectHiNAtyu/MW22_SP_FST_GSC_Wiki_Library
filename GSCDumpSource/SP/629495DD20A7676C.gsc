// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    if ( isdefined( level.offhands ) )
        return;

    level.offhands = spawnstruct();
    level.offhands.firefuncs = [];
    level.offhands.precached = [];
    level.offhands._id_B57472ECAE671752 = [];
    level.player = getentarray( "player", "classname" )[0];
    level.player.offhands = spawnstruct();
}

_id_9ED6302FA8A1E967( offhand, _id_DDABA368F540FAB6 )
{
    init();

    if ( !scripts\engine\utility::array_contains( level.offhands.precached, offhand ) )
    {
        [[ _id_DDABA368F540FAB6 ]]( offhand );
        level.offhands.precached = scripts\engine\utility::array_add( level.offhands.precached, offhand );
    }
}

registeroffhandfirefunc( offhand, _id_10BB6982B83E5957 )
{
    level.offhands.firefuncs[offhand] = _id_10BB6982B83E5957;
}

offhandisprecached( offhand )
{
    if ( scripts\engine\utility::array_contains( level.offhands.precached, offhand ) )
        return 1;
    else
        return 0;
}

offhandprecachefuncs()
{
    offhandprecachefuncs = [];
    offhandprecachefuncs["frag"] = scripts\sp\equipment\frag::precache;
    offhandprecachefuncs["flash"] = scripts\sp\equipment\flash::precache;
    offhandprecachefuncs["molotov"] = scripts\sp\equipment\molotov::precache;
    offhandprecachefuncs["molotov_light"] = scripts\sp\equipment\molotov::precache;
    offhandprecachefuncs["ied"] = scripts\sp\equipment\ied::precache;
    offhandprecachefuncs["noisemaker"] = scripts\sp\equipment\noisemaker::precache;
    offhandprecachefuncs["semtex"] = scripts\sp\equipment\semtex::precache;
    offhandprecachefuncs["c4_sp"] = scripts\sp\equipment\c4::precache;
    offhandprecachefuncs["c4_sp_short_throw"] = scripts\sp\equipment\c4::precache;
    offhandprecachefuncs["throwingknife"] = scripts\sp\equipment\throwingknife::precache;
    offhandprecachefuncs["throwingknife_marina"] = scripts\sp\equipment\throwingknife::precache;
    offhandprecachefuncs["throwingknife_kitchen"] = scripts\sp\equipment\throwingknife::precache;
    offhandprecachefuncs["smoke"] = scripts\sp\equipment\smoke::precache;
    offhandprecachefuncs["smoke_sp_slow"] = scripts\sp\equipment\smoke::precache;
    offhandprecachefuncs["smoke_tall"] = scripts\sp\equipment\smoke::precache;
    offhandprecachefuncs["smoke_bomb"] = _id_2F729D292DEB59E3::precache;
    offhandprecachefuncs["smoke_empty"] = scripts\sp\equipment\smoke::precache;
    offhandprecachefuncs["gas_grenade_sp"] = scripts\sp\equipment\teargas::precache;
    offhandprecachefuncs["signal"] = scripts\sp\equipment\signal::precache;
    offhandprecachefuncs["pipebomb"] = scripts\sp\equipment\pipebomb::precache;
    offhandprecachefuncs["hb_sensor"] = _id_092E849E55F32D10::precache;
    offhandprecachefuncs["hb_sensor_toggle"] = _id_092E849E55F32D10::precache;
    offhandprecachefuncs["bottle"] = _id_0E429028F9C1C965::precache;
    offhandprecachefuncs["thermal_phone"] = _id_092E849E55F32D10::precache;
    offhandprecachefuncs["handheld_map"] = _id_7616C0DCE807052A::precache;
    offhandprecachefuncs["green_beam_offhand"] = _id_692D49EC3459CE99::precache;
    offhandprecachefuncs["improvised_mine"] = _id_0272536687F66DC7::precache;
    offhandprecachefuncs["at_mine_sp"] = _id_5122BBC6A49B9100::precache;
    offhandprecachefuncs["thermite_sp"] = _id_439BF3B4DEC079CB::precache;
    offhandprecachefuncs["jammer"] = _id_092E849E55F32D10::precache;
    offhandprecachefuncs["decoy_canals"] = _id_342E089C0EC30948::precache;
    offhandprecachefuncs["gas_trap"] = _id_6492C24B29BE0B38::precache;
    offhandprecachefuncs["offhand_spotter_scope"] = _id_624B16E62718D18A::precache;
    offhandprecachefuncs["acid_grenade"] = _id_077475F5FF211F11::precache;
    return offhandprecachefuncs;
}

offhandfiremanager()
{
    if ( !isdefined( self.offhands ) )
        self.offhands = spawnstruct();

    self.offhands.lastusedoffhandweapon = undefined;
    self.offhands.lastusedoffhandtime = 0;

    for (;;)
    {
        self waittill( "grenade_fire", grenade, weapon );

        if ( isdefined( level.offhands.firefuncs[weapon.basename] ) )
            thread [[ level.offhands.firefuncs[weapon.basename] ]]( grenade, weapon );

        self.offhands.lastusedoffhandweapon = weapon;
        self.offhands.lastusedoffhandtime = gettime();
        thread scripts\sp\analytics::_id_5CF6C6AF86FD4710( grenade, weapon );
    }
}

playeroffhandthread( _id_ADB899C5AD0EC0AE )
{
    level.player endon( "death" );
    level.player childthread [[ _id_ADB899C5AD0EC0AE ]]();
}

remove_blackboard_isburning( guy )
{
    waitframe();

    if ( !isdefined( guy ) )
        return;

    guy._blackboard.isburning = undefined;
}

getweaponoffhandclass( weapon )
{
    if ( isstring( weapon ) )
        weaponname = weapon;
    else
        weaponname = weapon.basename;

    return _func_32FD9BB46D979779( weaponname );
}

_id_0C7E46AD834E413F( weaponname, _id_79581B4A6E2719AD )
{
    if ( !isdefined( level.offhands._id_2FBCADF015A28BEA ) )
        level.offhands._id_2FBCADF015A28BEA = [];

    if ( _id_79581B4A6E2719AD )
        level.offhands._id_2FBCADF015A28BEA[weaponname] = "primaryoffhand";
    else
        level.offhands._id_2FBCADF015A28BEA[weaponname] = "secondaryoffhand";
}

getweaponoffhandtype( weapon )
{
    _id_DCB0666762013D1D = "primaryoffhand";
    _id_1573E5DF1A233A5D = "secondaryoffhand";
    _id_DDD80F5D1DA23C60 = "none";

    if ( isstring( weapon ) )
        weaponname = weapon;
    else
        weaponname = weapon.basename;

    if ( isdefined( level.offhands._id_2FBCADF015A28BEA ) && isdefined( level.offhands._id_2FBCADF015A28BEA[weaponname] ) )
        return level.offhands._id_2FBCADF015A28BEA[weaponname];

    switch ( weaponname )
    {
        case "c4_no_detonator":
        case "molotov_light":
        case "iw9_la_kgolf_sp":
        case "thermite_sp":
        case "pipebomb":
        case "acid_grenade":
        case "gas_trap":
        case "c4_sp_short_throw":
        case "c4_sp":
        case "offhand_spotter_scope":
        case "throwingknife_kitchen":
        case "at_mine_sp":
        case "improvised_mine":
        case "t10_gas_grenade_sp":
        case "c4_sp_trap_assassin":
        case "throwingknife_marina":
        case "jammer":
        case "throwingknife":
        case "semtex":
        case "frag":
        case "molotov":
            return _id_DCB0666762013D1D;
        case "handheld_map":
        case "smoke_bomb":
        case "smoke_empty":
        case "hb_sensor_toggle":
        case "bottle":
        case "smoke_tall":
        case "signal":
        case "decoy_canals":
        case "green_beam_offhand":
        case "gas_grenade_sp":
        case "noisemaker":
        case "smoke_sp_slow":
        case "thermal_phone":
        case "hb_sensor":
        case "smoke":
        case "flash":
            return _id_1573E5DF1A233A5D;
        case "none":
            return _id_DDD80F5D1DA23C60;
    }
}

_id_14DD7FE1D23F9DC3( gesture, _id_F3E5EC9ECAAF8E1B, _id_FC0043E95242D5CB, radius )
{
    if ( !isalive( level.player ) )
        return;

    _id_5985D426AA39D205 = ( 0, 0, 18 );

    if ( !scripts\engine\trace::ray_trace_passed( level.player.origin + _id_5985D426AA39D205, _id_F3E5EC9ECAAF8E1B + _id_5985D426AA39D205, level.player ) )
        return;

    level.player shellshock( "default_nosound", 2.0 );
    level.player forceplaygestureviewmodel( gesture, undefined, 0.5, 0, 1, 0 );
    thread _id_16BDC6C2E41C72D1( _id_F3E5EC9ECAAF8E1B, _id_FC0043E95242D5CB, radius );
}

_id_16BDC6C2E41C72D1( _id_F3E5EC9ECAAF8E1B, _id_FC0043E95242D5CB, radius )
{
    starttime = gettime();
    _id_804C1A9C74AF88C1 = 0;
    duration = 10.0;
    _id_EE006CF398BCD8FD = 0.5;
    _id_C8FE6E3CA9715960 = 0.2;
    _id_8FA87D2C8780E014 = radius * radius;

    while ( !scripts\engine\utility::time_has_passed( starttime, duration ) )
    {
        _id_B18D3429CF88F29F = 0.05;
        _id_E679443F18F52622 = _id_804C1A9C74AF88C1;
        _id_804C1A9C74AF88C1 = distancesquared( level.player.origin, _id_F3E5EC9ECAAF8E1B ) <= _id_8FA87D2C8780E014;

        if ( _id_804C1A9C74AF88C1 )
        {
            if ( !_id_E679443F18F52622 )
            {
                _id_B18D3429CF88F29F = _id_EE006CF398BCD8FD;
                visionsetnaked( _id_FC0043E95242D5CB, _id_B18D3429CF88F29F );
            }
        }
        else if ( _id_E679443F18F52622 )
        {
            _id_B18D3429CF88F29F = _id_C8FE6E3CA9715960;
            visionsetnaked( "", _id_B18D3429CF88F29F );
        }

        wait( _id_B18D3429CF88F29F );
    }

    if ( _id_804C1A9C74AF88C1 )
        visionsetnaked( "", _id_C8FE6E3CA9715960 );
}

_id_DD141CE8C0127F62()
{
    player = self;
    player endon( "death" );
    _id_47BFF18BFEA9789C = 500;
    player notifyonplayercommand( "dtd_tap", "+usereload" );
    _id_AA5861DBE5FDAF83 = -1;

    for (;;)
    {
        player waittill( "dtd_tap" );
        currenttime = gettime();
        _id_5E6A90EB17CC5B55 = _id_AA5861DBE5FDAF83 > 0 && currenttime - _id_AA5861DBE5FDAF83 < _id_47BFF18BFEA9789C;
        _id_AA5861DBE5FDAF83 = currenttime;

        if ( _id_5E6A90EB17CC5B55 )
            return 1;
    }
}

_id_6E5CE23490C6FEA6( _id_2249366B1972061F, _id_750C0EDEC8558BF1, _id_646AE38B7851BEB4 )
{
    self endon( "death" );

    for (;;)
    {
        _id_2249366B1972061F scripts\sp\player\cursor_hint::create_cursor_hint( undefined, _id_8E54BBB4C4AF2B69( _id_750C0EDEC8558BF1.basename ), _id_646AE38B7851BEB4, 55, 100, 70, 0 );
        _id_CC9D3ABE92718F97 = _id_2249366B1972061F.cursor_hint_ent;
        _id_2249366B1972061F childthread _id_BB7D0FD0262D852D( _id_646AE38B7851BEB4, _id_750C0EDEC8558BF1 );
        outcome = _id_2249366B1972061F scripts\engine\utility::waittill_any_return_2( "trigger", "death" );

        if ( outcome == "death" )
        {
            if ( isdefined( _id_CC9D3ABE92718F97 ) )
            {
                _id_CC9D3ABE92718F97 scripts\sp\player\cursor_hint::remove_cursor_hint();
                _id_CC9D3ABE92718F97 delete();
            }

            return;
        }

        pickedup = _id_E2C7F0ED80637008( _id_750C0EDEC8558BF1 );

        if ( !pickedup )
            continue;
        else
        {
            if ( isdefined( _id_2249366B1972061F ) )
            {
                if ( isdefined( _id_2249366B1972061F.trigger ) )
                    _id_2249366B1972061F.trigger delete();

                scripts\sp\loot::createnotification( _id_750C0EDEC8558BF1.basename );
                _id_2249366B1972061F delete();
            }

            return;
        }
    }
}

_id_8E54BBB4C4AF2B69( weaponname )
{
    offset = ( 0, 0, 5 );

    if ( weaponname == "at_mine_sp" )
        offset = ( 0, 0, 8 );

    return offset;
}

_id_E2C7F0ED80637008( objweapon )
{
    _id_F961454259A7E6F5 = 0;

    foreach ( offhand in level.player.offhandinventory )
    {
        if ( issameweapon( offhand, objweapon, 1 ) )
        {
            _id_F961454259A7E6F5 = 1;
            break;
        }
    }

    if ( _id_F961454259A7E6F5 )
    {
        _id_B971E09CE070BD58 = level.player getweaponammoclip( objweapon );
        maxammo = weaponmaxammo( objweapon );

        if ( _id_B971E09CE070BD58 < maxammo )
        {
            playworldsound( "weap_pickup", level.player.origin );
            level.player setweaponammoclip( objweapon, _id_B971E09CE070BD58 + 1 );
            return 1;
        }
    }
    else
    {
        playworldsound( "weap_pickup", level.player.origin );
        level.player scripts\engine\sp\utility::give_offhand( objweapon.basename, 1 );
        return 1;
    }

    return 0;
}

_id_BB7D0FD0262D852D( _id_646AE38B7851BEB4, weaponobj )
{
    self endon( "entitydeleted" );
    self endon( "trigger" );
    self endon( "death" );
    _id_B971E09CE070BD58 = level.player getweaponammoclip( weaponobj );
    maxammo = weaponmaxammo( weaponobj );
    _id_D5F6F287AC22711A = _id_B971E09CE070BD58;

    if ( _id_B971E09CE070BD58 >= maxammo )
    {
        self.cursor_hint_ent sethintinoperable( 1 );
        self.cursor_hint_ent sethintstring( &"EQUIPMENT/FULL" );
    }
    else
    {
        self.cursor_hint_ent sethintinoperable( 0 );
        self.cursor_hint_ent sethintstring( _id_646AE38B7851BEB4 );
    }

    for (;;)
    {
        _id_B971E09CE070BD58 = level.player getweaponammoclip( weaponobj );

        if ( _id_B971E09CE070BD58 != _id_D5F6F287AC22711A )
        {
            if ( _id_B971E09CE070BD58 >= maxammo )
            {
                self.cursor_hint_ent sethintinoperable( 1 );
                self.cursor_hint_ent sethintstring( &"EQUIPMENT/FULL" );
            }
            else
            {
                self.cursor_hint_ent sethintinoperable( 0 );
                self.cursor_hint_ent sethintstring( _id_646AE38B7851BEB4 );
            }
        }

        _id_D5F6F287AC22711A = _id_B971E09CE070BD58;
        wait 0.1;
    }
}

_id_B9101B9D6599093F()
{
    return !level.player _meth_569AC32FF1837D7C( "grenadeHoldKBM" );
}

_id_01555DE7F70E21FA()
{
    return level.player _meth_569AC32FF1837D7C( "grenadeHoldKBM" );
}

_id_F9BAE891DECD126A( _id_C1C1562FF63566C0 )
{
    return isdefined( level.player getheldoffhand() ) && level.player getheldoffhand().basename == _id_C1C1562FF63566C0;
}
