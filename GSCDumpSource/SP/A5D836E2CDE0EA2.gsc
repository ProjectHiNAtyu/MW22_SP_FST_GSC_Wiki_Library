// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

precache()
{
    level._effect["vfx_helmet_tier3"] = loadfx( "vfx/iw9/gameplay/sp/vfx_al_qatala_helmet_tier_3.vfx" );
    level._effect["vfx_opforce_cartel_helmet_tier_3"] = loadfx( "vfx/iw9/gameplay/sp/vfx_opforce_cartel_helmet_tier_3.vfx" );
    level._effect["vfx_mex_mil_helmet_tier3"] = loadfx( "vfx/iw9/gameplay/sp/vfx_mex_mil_helmet_tier_3.vfx" );
    level._effect["vfx_shadow_co_helmet_tier3"] = loadfx( "vfx/iw9/gameplay/sp/vfx_shadow_co_helmet_tier_3.vfx" );
}

_id_1DDCDF764C5BDD84()
{
    self._id_F85AA26E953E8279 = 1;

    if ( _id_35CC826ACEEEB635() )
    {
        if ( istrue( level._id_2409F550B8A85394 ) )
            return;
    }

    if ( _id_35CC816ACEEEB402() )
    {
        _id_B6CA17D480F22F01();
        self._id_B4378FC1B757B1B1 = 0;
        self._id_48C2C9E43850F30F = 1;
    }

    self._id_E4A614EF029410EA = self.health;
    self.health = 99999;
    self.script_health = 99999;
    self._id_7A9DEBB6495E4FBE = scripts\engine\utility::ter_op( _id_35CC826ACEEEB635(), scripts\engine\utility::_id_53C4C53197386572( level._id_2986ED25936B6D23, 350 ), scripts\engine\utility::_id_53C4C53197386572( level._id_0F203B64B98764F4, 1000 ) );
    self._id_9AA77AB756FDCA82 = 1000;
    self._id_43E2AD424676B8D4 = 100;
    self._id_BDC4A284F9421FFC = 2000;
    self.fnshouldplaypainanim = ::_id_7477B2702D715C48;
    _id_D18FFB2829A256AC();
    scripts\engine\sp\utility::add_damage_function( ::_id_396B6F70220BFCF7 );
}

_id_B6CA17D480F22F01()
{
    if ( issubstr( self.code_classname, "_pmc" ) )
        self._id_FBF555896F954157 = level._effect["vfx_shadow_co_helmet_tier3"];
    else if ( issubstr( self.code_classname, "_cartel" ) )
        self._id_FBF555896F954157 = level._effect["vfx_opforce_cartel_helmet_tier_3"];
    else if ( issubstr( self.code_classname, "_mex" ) )
        self._id_FBF555896F954157 = level._effect["vfx_mex_mil_helmet_tier3"];
    else
        self._id_FBF555896F954157 = level._effect["vfx_helmet_tier3"];
}

_id_396B6F70220BFCF7( amount, attacker, direction, dmgpoint, meansofdeath, modelname, tagname, partname, idflags, objweapon )
{
    if ( istrue( self._id_F85AA26E953E8279 ) )
    {
        self.health = 99999;
        self.script_health = 99999;
    }

    if ( !scripts\common\utility::_id_BBEBFBDDD1B77A34() && ( istrue( level._id_288F1E20196E36B8 ) || istrue( self._id_288F1E20196E36B8 ) ) )
    {
        if ( _id_B653EB95E7D86EC0( partname ) )
        {
            if ( _id_35CC826ACEEEB635() )
                _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hithelmetlight" );
            else
                _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hithelmetheavy" );
        }
        else if ( _id_35CC826ACEEEB635() )
            _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hitarmorlight" );
        else if ( issubstr( self._id_AE3EA15396B65C1F, "shield" ) )
            _id_758EA9F162C62FDC( "hit_marker_heavy", "hitblastshield" );
        else
            _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hitarmorheavy" );
    }
    else
    {
        _id_9BB7419C58AA52BA = scripts\engine\utility::is_equal( attacker, level.player );

        if ( scripts\engine\utility::is_equal( self.attacker, self ) || scripts\common\utility::_id_BBEBFBDDD1B77A34() || amount <= 1 || !_id_3884BEC8F53B84F6( meansofdeath, objweapon ) )
        {
            if ( meansofdeath == "MOD_MELEE" && !scripts\common\utility::_id_BBEBFBDDD1B77A34() )
            {
                if ( _id_9BB7419C58AA52BA )
                    thread scripts\engine\utility::play_sound_in_space( "hit_marker_heavy", level.player.origin );

                if ( objweapon.basename == "iw9_me_riotshield_sp" )
                {
                    if ( self._id_7A9DEBB6495E4FBE > 200 )
                    {
                        if ( _id_35CC826ACEEEB635() )
                            self._id_7A9DEBB6495E4FBE = 100;
                        else
                            self._id_7A9DEBB6495E4FBE = 200;
                    }
                    else if ( self.health <= 100 )
                    {
                        _id_6170C11C14C26EBD();
                        return;
                    }
                }
                else if ( _id_9BB7419C58AA52BA )
                {
                    if ( istrue( level._id_BEDD2F231189DCB3 ) || istrue( self._id_BEDD2F231189DCB3 ) )
                    {
                        if ( self._id_7A9DEBB6495E4FBE > 0 && ( !isdefined( self._id_FCB646F1134732FC ) || scripts\engine\utility::time_has_passed( self._id_FCB646F1134732FC, 0.5 ) ) )
                        {
                            self._id_FCB646F1134732FC = gettime();
                            _id_758EA9F162C62FDC( undefined, "hitarmorlight" );
                        }

                        return;
                    }

                    amount = 100;
                }
            }
            else
                return;
        }

        if ( _id_9BB7419C58AA52BA )
        {
            if ( istrue( self._id_48C2C9E43850F30F ) && _id_B653EB95E7D86EC0( partname ) )
            {
                class = weaponclass( objweapon.basename );
                self._id_B4378FC1B757B1B1++;

                if ( class != "sniper" && self._id_B4378FC1B757B1B1 < 3 && amount < 700 )
                {
                    if ( _id_35CC826ACEEEB635() )
                        _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hithelmetlight" );
                    else
                        _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hithelmetheavy" );
                }
                else if ( !istrue( self._id_717A05AB382CC6EF ) )
                {
                    if ( class == "sniper" || amount >= 700 )
                    {
                        thread _id_D93C0AE1F417ABB3( _id_9BB7419C58AA52BA, 0 );
                        _id_6170C11C14C26EBD();
                        return;
                    }

                    thread _id_D93C0AE1F417ABB3( _id_9BB7419C58AA52BA, 1 );
                }

                return;
            }

            attacker notify( "ai_armorDamaged", meansofdeath );
        }

        if ( istrue( self.burningtodeath ) )
        {
            _id_BB6C0B67E147BA97();
            return;
            return;
        }

        if ( self._id_F85AA26E953E8279 )
        {
            if ( _id_9BB7419C58AA52BA && isai( attacker ) )
                amount = int( amount * 0.33 );

            if ( _id_CE7E20508CE59A4C( meansofdeath ) )
                self._id_7A9DEBB6495E4FBE = 0;
            else
                self._id_7A9DEBB6495E4FBE = self._id_7A9DEBB6495E4FBE - amount;

            if ( !istrue( self._id_48C2C9E43850F30F ) )
            {
                if ( _id_B653EB95E7D86EC0( partname ) )
                {
                    _id_6170C11C14C26EBD();
                    return;
                }
            }

            if ( self._id_7A9DEBB6495E4FBE > 1 )
            {
                if ( _id_9BB7419C58AA52BA )
                {
                    if ( _id_35CC826ACEEEB635() )
                        _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hitarmorlight" );
                    else if ( issubstr( self._id_AE3EA15396B65C1F, "shield" ) )
                        _id_758EA9F162C62FDC( "hit_marker_heavy", "hitblastshield" );
                    else
                        _id_758EA9F162C62FDC( "hit_marker_3d_armor", "hitarmorheavy" );
                }

                _id_1D79A3F4F602F210( meansofdeath );
            }
            else
            {
                _id_3DD3F7EA85B1E33A( _id_9BB7419C58AA52BA );

                if ( _id_35CC826ACEEEB635() && _id_CE7E20508CE59A4C( meansofdeath ) )
                    _id_6170C11C14C26EBD();
            }
        }
    }
}

_id_7477B2702D715C48()
{
    if ( scripts\engine\utility::is_equal( self.damagemod, "MOD_MELEE" ) )
        return 1;

    return 0;
}

_id_D93C0AE1F417ABB3( _id_9BB7419C58AA52BA, _id_7AD84DC73FF10EA8 )
{
    if ( _id_9BB7419C58AA52BA )
    {
        if ( _id_35CC826ACEEEB635() )
            _id_758EA9F162C62FDC( "hit_marker_3d_armor_break", "hithelmetlightbreak" );
        else
            _id_758EA9F162C62FDC( "hit_marker_3d_armor_break", "hithelmetheavybreak" );
    }

    self notify( "armor_break" );
    playfxontag( self._id_FBF555896F954157, self, "j_head" );
    thread ai_attachhead();
    self._id_717A05AB382CC6EF = 1;

    if ( _id_7AD84DC73FF10EA8 )
        _id_4ADAECD9673D52AC();

    wait 1;
    self._id_48C2C9E43850F30F = undefined;
}

_id_758EA9F162C62FDC( sound, value )
{
    level.player setclientomnvar( "damage_feedback_icon", value );
    level.player setclientomnvar( "damage_feedback_icon_notify", gettime() );

    if ( isdefined( sound ) )
        thread scripts\engine\utility::play_sound_in_space( sound, self.origin );
}

_id_3DD3F7EA85B1E33A( _id_9BB7419C58AA52BA )
{
    self notify( "armor_break" );
    self._id_B4378FC1B757B1B1 = 3;

    if ( _id_9BB7419C58AA52BA && istrue( self._id_F85AA26E953E8279 ) )
    {
        if ( _id_35CC826ACEEEB635() )
            _id_758EA9F162C62FDC( "hit_marker_3d_armor_break", "hitarmorlightbreak" );
        else if ( issubstr( self._id_AE3EA15396B65C1F, "shield" ) )
            _id_758EA9F162C62FDC( "hit_marker_3d_armor_break", "hitarmorheavybreak" );
        else
            _id_758EA9F162C62FDC( "hit_marker_3d_armor_break", "hitarmorheavybreak" );
    }

    if ( istrue( self.magic_bullet_shield ) )
        scripts\common\ai::stop_magic_bullet_shield();

    self.health = self._id_E4A614EF029410EA;
    self.script_health = self._id_E4A614EF029410EA;
    self._id_F85AA26E953E8279 = 0;
    _id_4ADAECD9673D52AC();
}

_id_3884BEC8F53B84F6( meansofdeath, objweapon )
{
    result = 1;

    if ( _id_D90870D4A1E92FF9( meansofdeath, objweapon ) )
        result = 0;

    return result;
}

_id_D90870D4A1E92FF9( meansofdeath, objweapon )
{
    if ( meansofdeath == "MOD_IMPACT" || meansofdeath == "MOD_MELEE" && !scripts\common\utility::_id_BBEBFBDDD1B77A34() )
        return 1;

    if ( isdefined( self._id_04C96BA0093CA475[meansofdeath] ) && scripts\engine\utility::array_contains( self._id_04C96BA0093CA475[meansofdeath], objweapon.basename ) )
        return 1;

    return 0;
}

_id_D18FFB2829A256AC()
{
    self._id_04C96BA0093CA475["MOD_GRENADE_SPLASH"] = [ "bottle", "flash", "smoke", "smoke_bomb", "gas_grenade_sp", "noisemaker" ];
    self._id_04C96BA0093CA475["MOD_GRENADE"] = [ "semtex", "molotov" ];
}

_id_CE7E20508CE59A4C( meansofdeath )
{
    switch ( meansofdeath )
    {
        case "MOD_PROJECTILE":
        case "MOD_GRENADE":
        case "MOD_PROJECTILE_SPLASH":
        case "MOD_GRENADE_SPLASH":
        case "MOD_EXPLOSIVE":
            return 1;
        default:
            return 0;
    }
}

_id_1D79A3F4F602F210( meansofdeath )
{
    if ( !_id_CE7E20508CE59A4C( meansofdeath ) )
        return 0;

    self notify( "flashbang", ( 0, 0, 0 ), 1, 1, level.player, "axis" );
}

ai_attachhead()
{
    if ( isdefined( self.hatmodel ) )
        self detach( self.hatmodel );

    if ( self tagexists( "j_helmet" ) )
        self hidepart( "j_helmet", self.headmodel );

    if ( self tagexists( "j_helmet_hide" ) )
        self hidepart( "j_helmet_hide", self.headmodel );

    if ( self tagexists( "j_mask" ) )
        self hidepart( "j_mask", self.headmodel );

    if ( self tagexists( "j_nvg" ) )
        self hidepart( "j_nvg", self.headmodel );

    if ( isdefined( self.hatmodel ) )
        self attach( self.hatmodel );
}

_id_4ADAECD9673D52AC()
{
    if ( !istrue( self._id_26A3131D00C1E6F3 ) )
        self notify( "flashbang", ( 0, 0, 0 ), 1, 1, level.player, "axis" );
}

_id_35CC826ACEEEB635()
{
    return scripts\engine\utility::is_equal( self.subclass, "tier2" );
}

_id_35CC816ACEEEB402()
{
    return scripts\engine\utility::is_equal( self.subclass, "tier3" );
}

_id_B653EB95E7D86EC0( partname )
{
    return isdefined( partname ) && ( scripts\sp\damagefeedback::isheadshot( partname ) || partname == "j_helmet" );
}

_id_BB6C0B67E147BA97()
{
    self notify( "kill_armorLogic" );
    self._id_F85AA26E953E8279 = 0;
    self._id_B4378FC1B757B1B1 = 3;

    if ( istrue( self.magic_bullet_shield ) )
        scripts\common\ai::stop_magic_bullet_shield();

    if ( self.health > self._id_E4A614EF029410EA )
        self.health = self._id_E4A614EF029410EA;

    self.script_health = self.health;
    scripts\engine\sp\utility::remove_damage_function( ::_id_396B6F70220BFCF7 );
}

_id_6170C11C14C26EBD()
{
    self._id_B4378FC1B757B1B1 = 3;

    if ( istrue( self.magic_bullet_shield ) )
        scripts\common\ai::stop_magic_bullet_shield();

    self kill();
}
