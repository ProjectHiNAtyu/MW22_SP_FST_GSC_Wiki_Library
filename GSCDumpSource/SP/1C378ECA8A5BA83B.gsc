// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    if ( !isdefined( level._id_51E86DB962C414BB ) )
    {
        level._id_51E86DB962C414BB = spawnstruct();
        level._id_51E86DB962C414BB._id_51E86DB962C414BB = [];
        level._id_51E86DB962C414BB._id_D04E2064CFE04AAA = undefined;
        level._id_51E86DB962C414BB.maxrange = 0;
        _id_2C137E5DE0799EDF();
        level.player _id_E59E04B107903DBB( 1 );
        level notify( "stop_context_melee" );
        level notify( "scripted_melee_stop" );
        scripts\engine\sp\utility::add_hint_string( "takedown_hint", &"TAKEDOWN/TAKEDOWN", ::_id_02E581AC79DBBDC6, 2 );
        _id_3B64EB40368C1450::_id_7372010B17478CDC( "takedown", 1, 0, "$self", ::_id_5C78033BF822C00A, "$value" );
    }
}

_id_5C78033BF822C00A( _id_77C892C2CEC7A0EB )
{
    if ( !isdefined( _id_77C892C2CEC7A0EB ) )
        _id_77C892C2CEC7A0EB = 1;

    if ( isdefined( self._id_3CB860E3AEC86B2A ) )
        self._id_3CB860E3AEC86B2A.disabled = !_id_77C892C2CEC7A0EB;
}

_id_02E581AC79DBBDC6()
{
    if ( !isdefined( level.player._id_3CB860E3AEC86B2A.victim ) )
        return 1;

    if ( level.player scripts\engine\utility::ent_flag( "takedown_active" ) )
        return 1;

    return 0;
}

_id_2C137E5DE0799EDF()
{
    _id_D0FBE358C5473863 = _func_5B8C2AF0033C3A14( "takedown" );

    foreach ( _id_C545F61C9BA000A9 in _id_D0FBE358C5473863 )
        level _id_9D44095CC14BB430( _id_C545F61C9BA000A9 );
}

_id_9D44095CC14BB430( _id_C545F61C9BA000A9 )
{
    _id_3CB860E3AEC86B2A = getscriptbundle( _id_C545F61C9BA000A9 );

    if ( !isdefined( _id_3CB860E3AEC86B2A ) )
        return;

    _id_9F11035A7FB4439D = spawnstruct();
    _id_9F11035A7FB4439D._id_3926C52DE5E8E524 = [];

    if ( isdefined( _id_3CB860E3AEC86B2A._id_3926C52DE5E8E524 ) )
    {
        foreach ( scene in _id_3CB860E3AEC86B2A._id_3926C52DE5E8E524 )
        {
            if ( isdefined( scene.scene ) && scene.scene != "" )
                _id_9F11035A7FB4439D._id_3926C52DE5E8E524[_id_9F11035A7FB4439D._id_3926C52DE5E8E524.size] = scene.scene;
        }
    }

    if ( _id_9F11035A7FB4439D._id_3926C52DE5E8E524.size > 0 )
    {
        _id_9F11035A7FB4439D.name = _id_C545F61C9BA000A9;
        _id_9F11035A7FB4439D.prompt = scripts\engine\utility::ter_op( isdefined( _id_3CB860E3AEC86B2A.prompt ), _id_3CB860E3AEC86B2A.prompt, undefined );
        _id_9F11035A7FB4439D.combat = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_B22F0C35E7114DA4 ), 1, undefined );
        _id_9F11035A7FB4439D.noncombat = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_A272A3C483A4DBB7 ), 1, undefined );
        _id_9F11035A7FB4439D.sprint = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_62C9843287668310 ), 1, undefined );
        _id_9F11035A7FB4439D._id_6BFBD72F146567C6 = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_2E00DED8354FC98D ), 1, undefined );
        _id_9F11035A7FB4439D.slide = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_FAFE0F9CEDC005B1 ), 1, undefined );
        _id_9F11035A7FB4439D._id_C1AE243AC7BB2D6B = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_DFC1B175FA37882E ), 1, undefined );
        _id_9F11035A7FB4439D._id_73384CFD4E29F9FC = scripts\engine\utility::_id_53C4C53197386572( _id_3CB860E3AEC86B2A._id_73384CFD4E29F9FC, 0 );
        _id_9F11035A7FB4439D._id_53FBD34F91EC5F4A = scripts\engine\utility::ter_op( isdefined( _id_3CB860E3AEC86B2A._id_6E30B458B9D3E741 ) && _id_3CB860E3AEC86B2A._id_6E30B458B9D3E741 < 180, anglestoforward( ( 0, scripts\engine\utility::_id_53C4C53197386572( _id_3CB860E3AEC86B2A._id_73384CFD4E29F9FC, 0 ), 0 ) ), undefined );
        _id_9F11035A7FB4439D._id_05A25E5E6351F8F0 = scripts\engine\utility::ter_op( isdefined( _id_3CB860E3AEC86B2A._id_6E30B458B9D3E741 ) && _id_3CB860E3AEC86B2A._id_6E30B458B9D3E741 < 180, cos( scripts\engine\utility::_id_53C4C53197386572( _id_3CB860E3AEC86B2A._id_6E30B458B9D3E741, 0 ) ), undefined );
        _id_9F11035A7FB4439D._id_102FAE1CFA21C22E = scripts\engine\utility::ter_op( isdefined( _id_3CB860E3AEC86B2A._id_A586C35B26011D18 ) && _id_3CB860E3AEC86B2A._id_A586C35B26011D18 > 0, squared( scripts\engine\utility::_id_53C4C53197386572( _id_3CB860E3AEC86B2A._id_A586C35B26011D18, 0 ) ), undefined );
        _id_9F11035A7FB4439D._id_B5E9ECAD88DE116C = scripts\engine\utility::ter_op( isdefined( _id_3CB860E3AEC86B2A._id_C373B9960F92844A ), squared( scripts\engine\utility::_id_53C4C53197386572( _id_3CB860E3AEC86B2A._id_C373B9960F92844A, 0 ) ), undefined );
        _id_9F11035A7FB4439D._id_F3F4EB55AED6E784 = scripts\engine\utility::ter_op( isdefined( _id_3CB860E3AEC86B2A._id_C2AB30FACEA037CC ), _id_3CB860E3AEC86B2A._id_C2AB30FACEA037CC, undefined );
        _id_9F11035A7FB4439D.maxheight = scripts\engine\utility::ter_op( isdefined( _id_3CB860E3AEC86B2A._id_CE8E1A0EAA96970A ), _id_3CB860E3AEC86B2A._id_CE8E1A0EAA96970A, undefined );
        _id_9F11035A7FB4439D.trace = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_9ACDC8166A15776A ), 1, undefined );
        _id_9F11035A7FB4439D._id_914F83DDF24BED51 = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_9ACDC8166A15776A ), _id_3CB860E3AEC86B2A._id_F9A6987F05D86EA9, undefined );
        _id_9F11035A7FB4439D._id_708DAF42846FC667 = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_B35066095FE8E4B7 ), 1, undefined );
        _id_9F11035A7FB4439D._id_FB8BC35E0497B35F = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_AD128B4644F4AC8F ), 1, undefined );
        _id_9F11035A7FB4439D._id_FFA9A8C76B3CB909 = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_3CEC5F8E40A90A99 ), 1, undefined );
        _id_9F11035A7FB4439D._id_63E9411B6AA01324 = scripts\engine\utility::ter_op( istrue( _id_3CB860E3AEC86B2A._id_63E9411B6AA01324 ), 1, undefined );
        level._id_51E86DB962C414BB._id_51E86DB962C414BB[_id_C545F61C9BA000A9] = _id_9F11035A7FB4439D;
        level._id_51E86DB962C414BB.maxrange = max( scripts\engine\utility::_id_53C4C53197386572( level._id_51E86DB962C414BB.maxrange, 0 ), scripts\engine\utility::_id_53C4C53197386572( _id_3CB860E3AEC86B2A._id_C373B9960F92844A, 0 ) );
    }
    else
    {

    }
}

_id_BC19B8D8B4E5F2FD()
{
    player = self;

    if ( !isdefined( player._id_3CB860E3AEC86B2A ) )
    {
        if ( !isdefined( player._id_3CB860E3AEC86B2A ) )
            player._id_3CB860E3AEC86B2A = spawnstruct();

        player._id_3CB860E3AEC86B2A.disabled = undefined;
        player._id_3CB860E3AEC86B2A._id_774E5BE1110D833D = undefined;
        player._id_3CB860E3AEC86B2A.victim = [];
    }
}

_id_E59E04B107903DBB( enabled )
{
    player = self;
    player _id_BC19B8D8B4E5F2FD();

    if ( istrue( enabled ) )
    {
        player thread _id_296322A6B4D1C1E6();
        player thread _id_FCD92B02DDFD5268();
    }
    else
    {
        player notify( "takedown_victim_monitor" );
        player notify( "takedown_input_monitor" );
        player notifyonplayercommandremove( "takedown_input", "+melee_zoom" );
    }
}

_id_FCD92B02DDFD5268()
{
    player = self;
    player notify( "takedown_input_monitor" );
    player endon( "takedown_input_monitor" );
    player endon( "death_or_disconnect" );
    player notifyonplayercommand( "takedown_input", "+melee_zoom" );

    for (;;)
    {
        player waittill( "takedown_input" );

        if ( istrue( player.in_melee_death ) )
            continue;

        if ( istrue( player._id_3CB860E3AEC86B2A.disabled ) )
            continue;

        if ( !isalive( player._id_3CB860E3AEC86B2A.victim ) )
            continue;

        if ( !isdefined( player._id_3CB860E3AEC86B2A.scene ) )
            continue;

        if ( isdefined( level._id_51E86DB962C414BB._id_D04E2064CFE04AAA ) )
        {
            player [[ level._id_51E86DB962C414BB._id_D04E2064CFE04AAA ]]();
            continue;
        }

        player _id_46F73A45ED2E50D0( player._id_3CB860E3AEC86B2A.victim, player._id_3CB860E3AEC86B2A.scene );
    }
}

_id_46F73A45ED2E50D0( victim, scene )
{
    player = self;
    player._id_3CB860E3AEC86B2A.weapon = player getcurrentweapon();
    player._id_3CB860E3AEC86B2A.start_origin = player.origin;
    player.in_melee_death = 1;
    player _id_3B64EB40368C1450::set( "takedown", "damage", 0 );
    player _id_3B64EB40368C1450::set( "takedown", "stealth_social_reveal", 1 );
    player._id_3CB860E3AEC86B2A._id_F8A1363643EE202F = victim;
    victim notify( "takedown_begin" );
    victim.ignoreall = 1;
    victim.ignoreme = 1;
    victim.syncedmeleetarget = undefined;
    victim._id_5B323B44F7126A63 = 0;
    victim.dontattackme = 1;
    victim.diequietly = 1;
    victim.in_melee_death = 1;
    victim.animname = "generic";
    player _id_C061D942D58C5E8B( 1 );
    victim thread _id_AA44C6CF2A2D51BF( scene, player );
}

_id_928ACA538C776C63()
{
    player = self;
    _id_64F88D0441939203 = gettime();

    if ( scripts\engine\utility::_id_53C4C53197386572( player._id_3CB860E3AEC86B2A._id_6147D928838F8055, -1 ) == _id_64F88D0441939203 )
        return player._id_3CB860E3AEC86B2A._id_928ACA538C776C63;

    player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 1;
    stance = player getstance();

    if ( !isalive( player ) )
        player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 0;
    else if ( isdefined( player getlinkedparent() ) )
        player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 0;
    else if ( istrue( player._id_3CB860E3AEC86B2A.disabled ) )
        player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 0;
    else if ( stance == "prone" )
        player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 0;
    else if ( player isthrowinggrenade() )
        player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 0;
    else if ( player getcurrentweapon().basename == "none" )
        player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 0;
    else if ( stance != "stand" )
    {
        _id_1B11E8A9B42E4C1B = 5;
        _id_688F95559BF04904 = _id_1B11E8A9B42E4C1B + 0.1;
        _id_1F0571D36D0DF95B = playerphysicstrace( player.origin + ( 0, 0, _id_1B11E8A9B42E4C1B ), player.origin + ( 0, 0, _id_688F95559BF04904 ) );

        if ( _id_1F0571D36D0DF95B[2] < player.origin[2] + _id_688F95559BF04904 )
            player._id_3CB860E3AEC86B2A._id_928ACA538C776C63 = 0;
    }

    player._id_3CB860E3AEC86B2A._id_6147D928838F8055 = _id_64F88D0441939203;
    return player._id_3CB860E3AEC86B2A._id_928ACA538C776C63;
}

_id_296322A6B4D1C1E6()
{
    player = self;
    player notify( "takedown_victim_monitor" );
    player endon( "takedown_victim_monitor" );
    player endon( "death_or_disconnect" );

    for (;;)
    {
        waitframe();

        if ( isdefined( player._id_3CB860E3AEC86B2A.victim ) && istrue( player._id_3CB860E3AEC86B2A.allow_melee ) )
            player _id_83A98277A7BD9A40( undefined );

        if ( level scripts\engine\utility::flag( "hold_context_melee" ) )
        {
            player _id_C061D942D58C5E8B( 1 );
            level scripts\engine\utility::flag_waitopen( "hold_context_melee" );
        }

        if ( !player _id_928ACA538C776C63() )
        {
            player _id_C061D942D58C5E8B( 1 );
            continue;
        }

        _id_5C63DC2384B0984C = player _id_73BC4C1A3334B6E9();

        if ( isdefined( _id_5C63DC2384B0984C ) )
        {
            player._id_3CB860E3AEC86B2A.scene = _id_5C63DC2384B0984C[0];
            player._id_3CB860E3AEC86B2A._id_3CB860E3AEC86B2A = _id_5C63DC2384B0984C[1];
            player _id_83A98277A7BD9A40( _id_5C63DC2384B0984C[2] );
            player thread scripts\engine\sp\utility::display_hint_forced( "takedown_hint" );
            player _id_C061D942D58C5E8B( 0 );
            continue;
        }

        player _id_83A98277A7BD9A40( undefined );
        player _id_C061D942D58C5E8B( 1 );
    }
}

_id_76DB537858BFA787( victim )
{
    player = self;
    return vectornormalize( victim._id_0B46483C41CBEAE5._id_6527419246CB2A8E - player geteye() );
}

_id_73BC4C1A3334B6E9()
{
    player = self;
    _id_64F88D0441939203 = gettime();
    result = undefined;

    if ( scripts\engine\utility::_id_53C4C53197386572( player._id_3CB860E3AEC86B2A._id_29A8FB1E12049A65, -1 ) != _id_64F88D0441939203 )
    {
        player._id_3CB860E3AEC86B2A._id_0976FFE452A24513 = getaiarrayinradius( player.origin, level._id_51E86DB962C414BB.maxrange, "axis", "team3" );
        player._id_3CB860E3AEC86B2A._id_29A8FB1E12049A65 = _id_64F88D0441939203;
    }

    if ( player._id_3CB860E3AEC86B2A._id_0976FFE452A24513.size > 0 )
    {
        fwd = anglestoforward( player getplayerangles() );
        _id_5A0EC1B91528C47D = vectornormalize( ( fwd[0], fwd[1], 0 ) );
        _id_D539DD4D949070D9 = player geteye();
        _id_E627E357CF133EAB = -1;

        foreach ( victim in player._id_3CB860E3AEC86B2A._id_0976FFE452A24513 )
        {
            if ( !isalive( victim ) )
                continue;

            if ( istrue( victim._id_F940BAB483417D29 ) )
                continue;

            if ( victim.takedamage == 0 )
                continue;

            if ( istrue( victim.magic_bullet_shield ) || istrue( victim.damageshield ) )
                continue;

            if ( victim.type != "human" )
                continue;

            if ( isdefined( victim._id_9485936C9586A5E4 ) )
            {
                if ( distance2dsquared( victim.origin, player.origin ) > squared( victim._id_9485936C9586A5E4 ) )
                    continue;
            }

            if ( !victim _id_B5F273E5ED184537( player ) )
                continue;

            _id_B9CC66EBDCDBA5F2 = _id_BCFEB090FD62F632( victim, player );

            if ( isdefined( _id_B9CC66EBDCDBA5F2[0] ) )
            {
                dir = player _id_76DB537858BFA787( victim );
                dot = vectordot( fwd, dir );

                if ( dot > _id_E627E357CF133EAB )
                {
                    _id_E627E357CF133EAB = dot;

                    if ( isdefined( victim._id_9F5B76AD63FBB58D ) )
                        _id_B9CC66EBDCDBA5F2[0] = victim._id_9F5B76AD63FBB58D;
                    else if ( isdefined( victim._id_607E38A9B915968A ) || isdefined( victim._id_D157FB56A26593B1 ) )
                    {

                    }

                    _id_B9CC66EBDCDBA5F2[2] = victim;
                    result = _id_B9CC66EBDCDBA5F2;
                }
            }
        }
    }

    return result;
}

_id_BCFEB090FD62F632( victim, player )
{
    _id_49A50C4AC134DBC8 = undefined;
    _id_DE9CAED94D793BCF = undefined;
    victim _id_E0062E58401C1811( player );
    _id_E111CC7DDE3AB3C8 = level._id_51E86DB962C414BB._id_51E86DB962C414BB;

    if ( isdefined( player._id_3CB860E3AEC86B2A._id_E111CC7DDE3AB3C8 ) )
        _id_E111CC7DDE3AB3C8 = player._id_3CB860E3AEC86B2A._id_E111CC7DDE3AB3C8;

    foreach ( _id_3CB860E3AEC86B2A in _id_E111CC7DDE3AB3C8 )
    {
        validplayer = player _id_35922EA88DEFAC23( _id_3CB860E3AEC86B2A, victim );

        if ( validplayer )
        {
            _id_1A0B366F0EBD351D = victim _id_B17F55719A2881DA( _id_3CB860E3AEC86B2A, player );

            if ( _id_1A0B366F0EBD351D )
            {
                _id_49A50C4AC134DBC8 = _id_2DD29DBE225A9152( _id_3CB860E3AEC86B2A );
                _id_DE9CAED94D793BCF = _id_3CB860E3AEC86B2A;
                break;
            }
        }
    }

    return [ _id_49A50C4AC134DBC8, _id_DE9CAED94D793BCF ];
}

_id_35922EA88DEFAC23( _id_3CB860E3AEC86B2A, victim )
{
    player = self;

    if ( scripts\engine\utility::_id_53C4C53197386572( player.health, 0 ) <= 0 )
        return 0;

    if ( player isthrowinggrenade() )
        return 0;

    dir = player _id_76DB537858BFA787( victim );
    _id_A358F139CF4E85EB = vectornormalize( ( dir[0], dir[1], 0 ) );

    if ( vectordot( _id_A358F139CF4E85EB, anglestoforward( ( 0, player getplayerangles()[1], 0 ) ) ) < 0.7 )
        return 0;

    if ( !istrue( _id_3CB860E3AEC86B2A.sprint ) && player issprinting() )
        return 0;

    if ( !istrue( _id_3CB860E3AEC86B2A._id_6BFBD72F146567C6 ) && !player issprinting() )
        return 0;

    if ( !istrue( _id_3CB860E3AEC86B2A.slide ) && player issprintsliding() )
        return 0;

    if ( !istrue( _id_3CB860E3AEC86B2A._id_C1AE243AC7BB2D6B ) && !player issprintsliding() )
        return 0;

    if ( !player _id_B5F273E5ED184537( victim ) )
        return 0;

    return 1;
}

_id_B17F55719A2881DA( _id_3CB860E3AEC86B2A, player )
{
    victim = self;

    if ( !isdefined( _id_3CB860E3AEC86B2A ) || !isdefined( player ) )
        return 0;

    if ( isent( victim.vehicle ) )
        return 0;

    _id_457471485336C961 = distancesquared( player.origin, victim.origin );
    combat = victim _id_B7A718A2E32F0CA1( player );

    if ( !istrue( _id_3CB860E3AEC86B2A.combat ) && combat )
        return 0;

    if ( !istrue( _id_3CB860E3AEC86B2A.noncombat ) && !combat )
        return 0;

    if ( isdefined( _id_3CB860E3AEC86B2A._id_102FAE1CFA21C22E ) && _id_457471485336C961 < _id_3CB860E3AEC86B2A._id_102FAE1CFA21C22E )
        return 0;

    if ( isdefined( _id_3CB860E3AEC86B2A._id_B5E9ECAD88DE116C ) && _id_457471485336C961 > _id_3CB860E3AEC86B2A._id_B5E9ECAD88DE116C )
        return 0;

    switch ( scripts\asm\asm_bb::bb_getrequestedstance() )
    {
        case "stand":
            if ( !istrue( _id_3CB860E3AEC86B2A._id_708DAF42846FC667 ) )
                return 0;

            break;
        case "crouch":
            if ( !istrue( _id_3CB860E3AEC86B2A._id_FB8BC35E0497B35F ) )
                return 0;

            break;
        case "prone":
            if ( !istrue( _id_3CB860E3AEC86B2A._id_FFA9A8C76B3CB909 ) )
                return 0;

            break;
        default:
            return 0;
    }

    if ( isdefined( _id_3CB860E3AEC86B2A._id_53FBD34F91EC5F4A ) && isdefined( _id_3CB860E3AEC86B2A._id_05A25E5E6351F8F0 ) )
    {
        _id_BA5E9CF0D64E6AE0 = anglestoright( victim gettagangles( "j_head" ) ) * -1.0;
        _id_43083AF06A30ADB6 = anglestoforward( victim.angles );
        _id_1A89225CD15EEA36 = vectorlerp( _id_BA5E9CF0D64E6AE0, _id_43083AF06A30ADB6, 1.0 );
        _id_85680A998F9FA886 = rotatevector( _id_3CB860E3AEC86B2A._id_53FBD34F91EC5F4A, ( 0, vectortoyaw( _id_1A89225CD15EEA36 ), 0 ) );

        if ( vectordot( _id_85680A998F9FA886, victim._id_0B46483C41CBEAE5._id_B785D9AF728678C4 ) < _id_3CB860E3AEC86B2A._id_05A25E5E6351F8F0 )
            return 0;
    }

    _id_3B6BDE41CED8616D = victim.origin[2] - player.origin[2];

    if ( isdefined( _id_3CB860E3AEC86B2A._id_F3F4EB55AED6E784 ) && _id_3B6BDE41CED8616D < _id_3CB860E3AEC86B2A._id_F3F4EB55AED6E784 )
        return 0;

    if ( isdefined( _id_3CB860E3AEC86B2A.maxheight ) && _id_3B6BDE41CED8616D > _id_3CB860E3AEC86B2A.maxheight )
        return 0;

    if ( istrue( _id_3CB860E3AEC86B2A.trace ) )
    {
        zoffset = ( 0, 0, 24 );

        if ( isdefined( _id_3CB860E3AEC86B2A._id_914F83DDF24BED51 ) )
            zoffset = ( 0, 0, _id_3CB860E3AEC86B2A._id_914F83DDF24BED51 );

        start = player.origin + zoffset;
        end = victim._id_0B46483C41CBEAE5._id_6527419246CB2A8E + zoffset;
        _id_2E3BC21C15E7AB6C = physicstrace( start, end );

        if ( _id_2E3BC21C15E7AB6C != end )
            return 0;
    }

    return 1;
}

_id_753E74ABE241DE9F( player )
{
    victim = self;

    if ( !isdefined( victim._id_216B9C2109A7BC00 ) || victim._id_216B9C2109A7BC00 != gettime() )
    {
        victim._id_B95FBF2F403E186C = 1;
        _id_E227374D9D756C2D = anglestoforward( player getplayerangles() );
        _id_D539DD4D949070D9 = player geteye();
        _id_3777ECE6A73EADA5 = victim geteye() - _id_D539DD4D949070D9;
        _id_FCF8C4BCD1867A5C = clamp( distance( victim geteye(), _id_D539DD4D949070D9 ) - 30, 0, 120 );
        _id_FB4985F64B8B8F74 = 0.5 + 0.44 * ( _id_FCF8C4BCD1867A5C / 120 );

        if ( vectordot( vectornormalize( _id_3777ECE6A73EADA5 ), _id_E227374D9D756C2D ) < _id_FB4985F64B8B8F74 )
            victim._id_B95FBF2F403E186C = 0;

        victim._id_216B9C2109A7BC00 = gettime();
    }

    return victim._id_B95FBF2F403E186C;
}

_id_B5F273E5ED184537( _id_9D211F46B524698A )
{
    if ( isdefined( self._id_4A4697AA1329CBA5 ) )
    {
        _id_D3FA24EED6AB73DA = 1;

        foreach ( func in self._id_4A4697AA1329CBA5 )
        {
            if ( !self [[ func ]]( _id_9D211F46B524698A ) )
            {
                _id_D3FA24EED6AB73DA = 0;
                break;
            }
        }

        return _id_D3FA24EED6AB73DA;
    }

    return 1;
}

_id_B7A718A2E32F0CA1( player )
{
    victim = self;

    if ( istrue( player._id_3CB860E3AEC86B2A._id_436E41181EA491EC ) )
        return 0;

    return victim._id_FE5EBEFA740C7106 >= 3;
}

_id_B1C79C767D9DC6C2()
{
    player = self;

    if ( isdefined( player._id_3CB860E3AEC86B2A._id_D5C0CA368B8FEFF8 ) )
        return player._id_3CB860E3AEC86B2A._id_D5C0CA368B8FEFF8;

    _id_D5C0CA368B8FEFF8 = spawnstruct();
    _id_D5C0CA368B8FEFF8.origin = player.origin;
    _id_D5C0CA368B8FEFF8.angles = player.angles;
    return _id_D5C0CA368B8FEFF8;
}

_id_7DF590CBB122C3E5( player, scene )
{
    victim = self;
    _id_F8ED6D4543FB3B7B = victim getentitynumber();

    if ( !isdefined( player._id_3CB860E3AEC86B2A._id_D5C0CA368B8FEFF8 ) )
        player._id_3CB860E3AEC86B2A._id_D5C0CA368B8FEFF8 = spawnstruct();

    _id_D5C0CA368B8FEFF8 = player._id_3CB860E3AEC86B2A._id_D5C0CA368B8FEFF8;

    if ( isdefined( victim._id_09044E34926A8961 ) )
        _id_D5C0CA368B8FEFF8.origin = victim._id_09044E34926A8961;
    else if ( isdefined( player._id_3CB860E3AEC86B2A._id_00B21021870C3F9F ) && isdefined( player._id_3CB860E3AEC86B2A._id_00B21021870C3F9F[_id_F8ED6D4543FB3B7B] ) )
        _id_D5C0CA368B8FEFF8.origin = player._id_3CB860E3AEC86B2A._id_00B21021870C3F9F[_id_F8ED6D4543FB3B7B];
    else
        _id_D5C0CA368B8FEFF8.origin = victim.origin;

    if ( isdefined( victim._id_203B7A1871AE0B6F ) )
        _id_D5C0CA368B8FEFF8.angles = victim._id_203B7A1871AE0B6F;
    else if ( isdefined( player._id_3CB860E3AEC86B2A._id_C6C0BCB49E005AC1 ) && isdefined( player._id_3CB860E3AEC86B2A._id_C6C0BCB49E005AC1[_id_F8ED6D4543FB3B7B] ) )
        _id_D5C0CA368B8FEFF8.angles = player._id_3CB860E3AEC86B2A._id_C6C0BCB49E005AC1[_id_F8ED6D4543FB3B7B];
    else
        _id_D5C0CA368B8FEFF8.angles = ( 0, vectortoyaw( _id_D5C0CA368B8FEFF8.origin - player.origin ), 0 );

    if ( istrue( player._id_3CB860E3AEC86B2A._id_3CB860E3AEC86B2A._id_63E9411B6AA01324 ) )
        _id_D5C0CA368B8FEFF8.angles = ( _id_D5C0CA368B8FEFF8.angles[0], _id_D5C0CA368B8FEFF8.angles[1] + 180 - player._id_3CB860E3AEC86B2A._id_3CB860E3AEC86B2A._id_73384CFD4E29F9FC, _id_D5C0CA368B8FEFF8.angles[2] );

    _id_D5C0CA368B8FEFF8.scriptbundlename = scene;
    _id_D5C0CA368B8FEFF8._id_E8EF9AA457AC546E = 1;
    _id_D5C0CA368B8FEFF8._id_146AF07029AD8B38 = 1;
    return _id_D5C0CA368B8FEFF8;
}

_id_AA44C6CF2A2D51BF( scene, player )
{
    victim = self;

    if ( isalive( victim ) )
        victim stopanimscripted();

    if ( !isalive( victim ) )
    {
        player thread _id_5432271BBD78C599();
        return;
    }

    victim notify( "start_context_melee" );
    player scripts\engine\utility::ent_flag_set( "takedown_active" );
    _id_D5C0CA368B8FEFF8 = victim _id_7DF590CBB122C3E5( player, scene );
    player._id_51FC6E6D7F30E252 = victim;
    victim.og_maxsightdistsqrd = victim.maxsightdistsqrd;
    victim._id_D6DA9FFE1036D935 = victim.newenemyreactiondistsq;
    victim._id_054CABD50D85AF5F = victim.battlechatter;
    victim._id_11F99A4533020B59 = victim.allowdeath;
    victim.allowantigrav = 0;
    victim.dontmelee = 1;
    victim.maxsightdistsqrd = 1;
    victim.fixednode = 0;
    victim.ignoreme = 1;
    victim.ignoreall = 1;
    victim.newenemyreactiondistsq = 0;
    victim.allowdeath = 0;
    victim.a.disablepain = 1;
    victim.allowpain = 0;
    victim.battlechatterallowed = 0;
    victim._id_F5B43375EA6D8F36 = scene;
    victim.remove_from_animloop = 1;
    victim notify( "takedown_executed" );

    if ( isdefined( victim ) || isalive( victim ) )
    {
        _id_D5C0CA368B8FEFF8 thread _id_72A196B6C7DF2F38::_id_A22D50057C3C9EC2( [ player, victim ], undefined, scene );
        player._id_214D924F4E137244 scripts\engine\utility::ent_flag_waitopen( "scene_object_active" );
        player thread _id_F0D1CAEB5B42E0AE();
        _id_891B81A8DA449513( victim );
    }

    player notify( "takedown_end" );
    player thread _id_5432271BBD78C599();
}

_id_F0D1CAEB5B42E0AE()
{
    player = self;
    _id_D0DE0DB1760B9C5B = 10;
    _id_AA440CDD07894C27 = playerphysicstrace( player.origin + ( 0, 0, 1 ), player.origin );

    if ( lengthsquared( _id_AA440CDD07894C27 - player.origin ) > 0.02 )
    {
        _id_AA440CDD07894C27 = playerphysicstrace( player._id_3CB860E3AEC86B2A.start_origin + ( 0, 0, _id_D0DE0DB1760B9C5B ), player.origin + ( 0, 0, _id_D0DE0DB1760B9C5B ) );

        if ( _id_AA440CDD07894C27[0] != player.origin[0] || _id_AA440CDD07894C27[1] != player.origin[1] )
            _id_AA440CDD07894C27 = _id_AA440CDD07894C27 + vectornormalize( player._id_3CB860E3AEC86B2A.start_origin - player.origin );

        _id_AA440CDD07894C27 = playerphysicstrace( _id_AA440CDD07894C27, _id_AA440CDD07894C27 - ( 0, 0, _id_D0DE0DB1760B9C5B ) );
        _id_8035AB8750BD699A = playerphysicstrace( _id_AA440CDD07894C27 + ( 0, 0, 1 ), _id_AA440CDD07894C27 );

        if ( _id_AA440CDD07894C27 != _id_8035AB8750BD699A )
            _id_AA440CDD07894C27 = player._id_3CB860E3AEC86B2A.start_origin;

        player setorigin( _id_AA440CDD07894C27 );
    }
}

_id_C061D942D58C5E8B( enabled )
{
    player = self;

    if ( !istrue( enabled ) )
        player _id_3B64EB40368C1450::set( "takedown_allow_melee", "melee", 0 );
    else
        player _id_3B64EB40368C1450::_id_462E6336A0DC84A8( "takedown_allow_melee", "melee" );
}

_id_891B81A8DA449513( victim )
{
    if ( !isdefined( victim ) )
        return;

    player = level.player;
    victim.skipdeathanim = 1;
    victim.noragdoll = 1;
    victim pushplayer( 0 );
    victim.allowdeath = 1;
    victim.diequietly = 1;

    if ( isdefined( victim.magic_bullet_shield ) )
        victim scripts\common\ai::stop_magic_bullet_shield();

    if ( isdefined( victim.stealth ) )
        victim.stealth.override_damage_auto_range = 60;

    if ( isalive( victim ) )
        victim kill( ( 0, 0, 0 ), player, player, "MOD_MELEE" );

    if ( !istrue( victim._id_8954EC40FECFF44A ) && isdefined( player._id_3CB860E3AEC86B2A ) && isdefined( victim.origin ) )
        player._id_3CB860E3AEC86B2A._id_3C77CAC8C6E3C558 = victim.origin;
}

_id_8954EC40FECFF44A( victim )
{
    player = level.player;

    if ( !isdefined( victim ) && isdefined( player._id_3CB860E3AEC86B2A._id_3C77CAC8C6E3C558 ) )
    {
        foreach ( corpse in getcorpsearray( player.origin, 500 ) )
        {
            if ( istrue( corpse._id_8954EC40FECFF44A ) )
                continue;

            if ( corpse isragdoll() )
                continue;

            _id_A4F5FB62BA3A113B = corpse.origin;

            if ( istrue( getdvarint( "dvar_32196FA75434C856", 0 ) ) )
                _id_A4F5FB62BA3A113B = corpse getcorpsephysicsorigin();

            if ( isdefined( _id_A4F5FB62BA3A113B ) && distancesquared( _id_A4F5FB62BA3A113B, player._id_3CB860E3AEC86B2A._id_3C77CAC8C6E3C558 ) < squared( 60 ) )
            {
                corpse startragdoll();
                corpse._id_8954EC40FECFF44A = 1;
            }
        }
    }
    else if ( isdefined( victim ) && !istrue( victim._id_8954EC40FECFF44A ) )
    {
        if ( isai( victim ) )
        {

        }

        victim startragdoll();
        victim._id_8954EC40FECFF44A = 1;
    }

    player._id_3CB860E3AEC86B2A._id_3C77CAC8C6E3C558 = undefined;
}

_id_E0062E58401C1811( player )
{
    victim = self;
    _id_64F88D0441939203 = gettime();

    if ( scripts\engine\utility::_id_53C4C53197386572( victim._id_E3EEEC629BE14789, -1 ) != _id_64F88D0441939203 )
    {
        if ( !isdefined( victim._id_0B46483C41CBEAE5 ) )
            victim._id_0B46483C41CBEAE5 = spawnstruct();

        tag = "tag_origin";
        _id_A43B0202C06E0907 = victim gettagangles( tag );
        _id_F58A124E0F0556E7 = victim gettagorigin( tag );
        _id_2A49AD1CAE501CE3 = anglestoright( _id_A43B0202C06E0907 );
        _id_B4E1754D236C2278 = anglestoforward( _id_A43B0202C06E0907 );
        _id_2353CA8656F77E04 = player.origin - _id_F58A124E0F0556E7;
        _id_2353CA8656F77E04 = ( _id_2353CA8656F77E04[0], _id_2353CA8656F77E04[1], 0 );
        _id_2353CA8656F77E04 = vectornormalize( _id_2353CA8656F77E04 );
        _id_EFC688FB667EF281 = abs( vectordot( _id_B4E1754D236C2278, ( 0, 0, 1 ) ) );

        if ( _id_EFC688FB667EF281 > 0.7 )
            _id_B4E1754D236C2278 = vectornormalize( ( _id_2A49AD1CAE501CE3[0], _id_2A49AD1CAE501CE3[1], 0 ) );
        else
            _id_B4E1754D236C2278 = vectornormalize( ( _id_B4E1754D236C2278[0], _id_B4E1754D236C2278[1], 0 ) );

        _id_9780F353E61A7BA3 = anglestoforward( victim.angles );

        if ( vectordot( _id_2353CA8656F77E04, _id_9780F353E61A7BA3 ) > vectordot( _id_B4E1754D236C2278, _id_9780F353E61A7BA3 ) )
            _id_B4E1754D236C2278 = _id_9780F353E61A7BA3;

        _id_2A49AD1CAE501CE3 = vectorcross( _id_B4E1754D236C2278, ( 0, 0, 1 ) );
        victim._id_0B46483C41CBEAE5._id_B785D9AF728678C4 = _id_2353CA8656F77E04;
        victim._id_0B46483C41CBEAE5._id_31E1CB31D77116E6 = vectordot( _id_B4E1754D236C2278, _id_2353CA8656F77E04 );
        victim._id_0B46483C41CBEAE5._id_87D553E2E44D7001 = vectordot( _id_2A49AD1CAE501CE3, _id_2353CA8656F77E04 );
        victim._id_0B46483C41CBEAE5.height = victim.origin[2] - player.origin[2];
        victim._id_0B46483C41CBEAE5._id_B0F381F266115505 = abs( victim._id_0B46483C41CBEAE5.height );
        victim._id_0B46483C41CBEAE5._id_6527419246CB2A8E = victim gettagorigin( tag );
        victim._id_0B46483C41CBEAE5.distsq = distancesquared( victim._id_0B46483C41CBEAE5._id_6527419246CB2A8E, player geteye() );
        victim._id_E3EEEC629BE14789 = _id_64F88D0441939203;
    }

    return victim._id_0B46483C41CBEAE5;
}

_id_2DD29DBE225A9152( _id_3CB860E3AEC86B2A, _id_07539E339DCCB571 )
{
    player = self;
    player._id_3CB860E3AEC86B2A._id_17BEA5F41DF32169 = scripts\engine\utility::_id_53C4C53197386572( player._id_3CB860E3AEC86B2A._id_17BEA5F41DF32169, [] );

    if ( !isdefined( player._id_3CB860E3AEC86B2A._id_17BEA5F41DF32169[_id_3CB860E3AEC86B2A.name] ) || player._id_3CB860E3AEC86B2A._id_17BEA5F41DF32169[_id_3CB860E3AEC86B2A.name].size == 0 )
    {
        if ( isdefined( _id_3CB860E3AEC86B2A._id_3926C52DE5E8E524 ) )
            player._id_3CB860E3AEC86B2A._id_17BEA5F41DF32169[_id_3CB860E3AEC86B2A.name] = scripts\engine\utility::array_randomize( _func_82D95BA721744147( _id_3CB860E3AEC86B2A._id_3926C52DE5E8E524 ) );
    }

    _id_81A329728ABB79E4 = player._id_3CB860E3AEC86B2A._id_17BEA5F41DF32169[_id_3CB860E3AEC86B2A.name];

    if ( !isdefined( _id_81A329728ABB79E4 ) )
        return undefined;

    result = _id_81A329728ABB79E4[_id_81A329728ABB79E4.size - 1];

    if ( istrue( _id_07539E339DCCB571 ) )
        _id_81A329728ABB79E4[_id_81A329728ABB79E4.size - 1] = undefined;

    return result;
}

_id_5432271BBD78C599( _id_22008EC0C4F98B46 )
{
    player = self;
    player notify( "takedown_cleanup" );
    player endon( "takedown_cleanup" );

    if ( isdefined( _id_22008EC0C4F98B46 ) )
    {
        if ( !isarray( _id_22008EC0C4F98B46 ) )
            _id_22008EC0C4F98B46 = [ _id_22008EC0C4F98B46 ];

        player waittill( _id_22008EC0C4F98B46 );
    }

    player _id_3B64EB40368C1450::_id_C9D0B43701BDBA00( "takedown" );

    if ( isalive( player._id_51FC6E6D7F30E252 ) && !istrue( player._id_51FC6E6D7F30E252._id_84707D6F26EAAD95 ) )
    {
        player._id_51FC6E6D7F30E252 stopanimscripted();
        player._id_51FC6E6D7F30E252 kill( player.origin, player, player, "MOD_MELEE" );
        player._id_51FC6E6D7F30E252 = undefined;
    }

    player.in_melee_death = undefined;
    player scripts\engine\utility::ent_flag_clear( "takedown_active" );
}

_id_83A98277A7BD9A40( _id_1DB7B2B78D7FAC3E, _id_6686DD514575A06E )
{
    player = self;

    if ( isdefined( player._id_3CB860E3AEC86B2A.victim ) && ( !isdefined( _id_1DB7B2B78D7FAC3E ) || player._id_3CB860E3AEC86B2A.victim != _id_1DB7B2B78D7FAC3E ) )
        player._id_3CB860E3AEC86B2A._id_0F54FB218A9A1565 = 0;

    player._id_3CB860E3AEC86B2A.victim = _id_1DB7B2B78D7FAC3E;
}
