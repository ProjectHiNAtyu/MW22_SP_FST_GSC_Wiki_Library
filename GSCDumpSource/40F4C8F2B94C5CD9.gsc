// IW9 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

create_animpack( anime )
{
    pack = spawnstruct();
    pack.ents = [];
    pack.players = [];
    pack.cam = undefined;
    pack._id_5BA8DB57A9811D96 = [];
    pack.anime = anime;
    pack.packs = [];
    return pack;
}

_id_2D4C340DD3908B2D( fov )
{
    self.fov = fov;
}

_id_B8F86028BCC64F84( fstop, _id_ED8206FEF1806FEF, focusspeed, aperturespeed, _id_C06551440B16249C )
{
    self.fstop = fstop;
    self._id_ED8206FEF1806FEF = _id_ED8206FEF1806FEF;
    self.focusspeed = focusspeed;
    self.aperturespeed = aperturespeed;
    self._id_C06551440B16249C = _id_C06551440B16249C;
}

add_pack_modelanim( ent, animation )
{
    level.scr_anim[ent.animname][self.anime] = animation;
    level.scr_animname[ent.animname][self.anime] = getanimname( animation );
    self.ents[self.ents.size] = ent;
}

add_pack_startfunc( paramarray, func )
{
    self.startfunc = func;
    self.paramarray = paramarray;
}

_id_DECF1E23D78D0944( paramarray, func )
{
    self.endfunc = func;
    self._id_315361ABD838FAD4 = paramarray;
}

_id_E718BA63D511FCDE( paramarray, func )
{
    self._id_EEDB5FB15EB26BFA = func;
    self._id_5AB13B55D7CEFF80 = paramarray;
}

add_pack_playeranim( player, _id_F8896CB359EAB159, _id_B1E61449DA6BA188 )
{
    if ( !isdefined( player ) )
        return;

    animname = undefined;

    if ( !isdefined( player.brexfilanimname ) )
    {
        animname = "player" + player getentitynumber();
        player.animname = animname;
        player.brexfilanimname = animname;
    }
    else
        animname = player.brexfilanimname;

    self.players[self.players.size] = player;
    animation = _id_F8896CB359EAB159;

    if ( isdefined( _id_B1E61449DA6BA188 ) )
    {
        if ( isdefined( player.operatorcustomization ) && isdefined( player.operatorcustomization.gender ) && player.operatorcustomization.gender == "female" )
            animation = _id_B1E61449DA6BA188;
    }

    level.scr_anim[animname][self.anime] = animation;
    level.scr_eventanim[animname][self.anime] = getanimname( animation );
}

add_pack_camanim( animation, _id_437B6BB41D98DF26 )
{
    self.cam = 1;
    level.scr_anim["endingCam"][self.anime] = animation;
    self._id_437B6BB41D98DF26 = _id_437B6BB41D98DF26;
}

add_pack_fx( _id_8C44BF99399EDF9A, origin, angles )
{
    self.fx = _id_8C44BF99399EDF9A;
    self.fxorigin = origin;
    self.fxangles = angles;
}

_id_707983B9FDB53C55( rig )
{
    self._id_5BA8DB57A9811D96[self._id_5BA8DB57A9811D96.size] = rig;
}

#using_animtree("script_model");

spawn_script_model( modelname, animname, _id_31093158B2292193 )
{
    model = spawn( "script_model", self.origin );
    model setmodel( modelname );
    model forcenetfieldhighlod( 1 );

    if ( !isdefined( animname ) )
        animname = modelname;

    model.animname = animname;
    model useanimtree( #animtree );

    if ( isdefined( _id_31093158B2292193 ) )
    {
        model.linkedents = [];

        foreach ( _id_C30D717B67553796 in _id_31093158B2292193 )
        {
            extra = spawn( "script_model", self.origin );
            extra setmodel( _id_C30D717B67553796[0] );
            extra forcenetfieldhighlod( 1 );
            extra linkto( model, _id_C30D717B67553796[1], ( 0, 0, 0 ), ( 0, 0, 0 ) );
            model.linkedents[model.linkedents.size] = extra;
        }
    }

    return model;
}

_id_38C7F6BC1DEEF269( modelname, animname, vehicletype )
{
    if ( !isdefined( animname ) )
        animname = modelname;

    vehicle = spawnvehicle( modelname, animname, vehicletype, self.origin, self.angles );
    vehicle.animname = animname;
    vehicle._id_90ACDD32579DCB16 = 1;
    vehicle.vehiclename = vehicletype;
    vehicle setcandamage( 0 );

    if ( vehicle vehicle_isphysveh() )
    {
        vehicle _meth_247AD6A91F6A4FFE( 1 );
        vehicle vehphys_forcekeyframedmotion();
    }
    else
        vehicle notsolid();

    vehicle vehicle_turnengineoff();
    vehicle _meth_97E11A84480635BC( 1 );
    return vehicle;
}

_id_C880EDBA9FACE762( _id_0E25D1D189177A7C )
{
    _id_5C3C95908409974F = "exfil_" + _id_0E25D1D189177A7C + "_light_origin";
    _id_EF5F42DC3BAE2A88 = scripts\engine\utility::getstruct( _id_5C3C95908409974F, "targetname" );

    if ( !isdefined( level._id_B71CF533392C0371 ) )
        level._id_B71CF533392C0371 = [];

    level._id_B71CF533392C0371[_id_5C3C95908409974F] = _id_EF5F42DC3BAE2A88;
}

_id_FCE988291DBC4649( _id_0E25D1D189177A7C )
{
    if ( !isdefined( level._id_B71CF533392C0371 ) )
        return undefined;

    _id_5C3C95908409974F = "exfil_" + _id_0E25D1D189177A7C + "_light_origin";
    return level._id_B71CF533392C0371[_id_5C3C95908409974F];
}

_id_8C2D124DBEF4FA60( _id_0E25D1D189177A7C, _id_599217E02A6DA3FA )
{
    rig = spawnstruct();
    _id_5E0676140EECDF2D = "exfil_" + _id_0E25D1D189177A7C + "_probe";
    _id_4AE45078DF12C7A7 = "exfil_" + _id_0E25D1D189177A7C + "_light";
    _id_83D076584339CBE2 = getentarray( _id_5E0676140EECDF2D, "script_noteworthy" );
    lights = getentarray( _id_4AE45078DF12C7A7, "targetname" );
    _id_EF5F42DC3BAE2A88 = _id_FCE988291DBC4649( _id_0E25D1D189177A7C );

    if ( !isdefined( _id_83D076584339CBE2 ) )
        return undefined;

    foreach ( _id_AC0E424AC96A7113 in _id_83D076584339CBE2 )
    {
        if ( !isdefined( _id_AC0E424AC96A7113 ) )
            return undefined;
    }

    if ( !isdefined( lights ) )
        return undefined;

    foreach ( _id_AC0E5E4AC96AAEA7 in lights )
    {
        if ( !isdefined( _id_AC0E5E4AC96AAEA7 ) )
            return undefined;
    }

    _id_FAB0539668DBA4B7 = _id_EF5F42DC3BAE2A88.origin;
    _id_3694A4E650566A39 = _id_EF5F42DC3BAE2A88.angles;

    if ( !isdefined( _id_3694A4E650566A39 ) )
        _id_3694A4E650566A39 = ( 0, 0, 0 );

    foreach ( probe in _id_83D076584339CBE2 )
    {
        if ( !isdefined( probe.origin_offset ) && !isdefined( probe.angles_offset ) )
        {
            _id_542E3E93B710380F = probe.origin;
            _id_7434C0613F2501B1 = probe.angles;

            if ( !isdefined( _id_7434C0613F2501B1 ) )
                _id_7434C0613F2501B1 = ( 0, 0, 0 );

            probe.origin_offset = _id_542E3E93B710380F - _id_FAB0539668DBA4B7;
            probe.angles_offset = _id_7434C0613F2501B1 - _id_3694A4E650566A39;
        }
    }

    foreach ( light in lights )
    {
        if ( !isdefined( light.origin_offset ) && !isdefined( light.angles_offset ) )
        {
            _id_24CD9408147D26C5 = light.origin;
            _id_658DC910DD6C771B = light.angles;

            if ( !isdefined( light.angles ) )
                _id_658DC910DD6C771B = ( 0, 0, 0 );

            light.origin_offset = _id_24CD9408147D26C5 - _id_FAB0539668DBA4B7;
            light.angles_offset = _id_658DC910DD6C771B - _id_3694A4E650566A39;
        }
    }

    rig._id_83D076584339CBE2 = _id_83D076584339CBE2;
    rig.lights = lights;
    rig._id_599217E02A6DA3FA = _id_599217E02A6DA3FA;
    _id_89A2405953B84136( rig, 1 );
    return rig;
}

_id_89A2405953B84136( rig, _id_AC17789997E5B858 )
{
    if ( !isdefined( rig ) )
        return;

    foreach ( probe in rig._id_83D076584339CBE2 )
        probe hide();

    foreach ( light in rig.lights )
    {
        if ( _id_AC17789997E5B858 && !isdefined( light.original_intensity ) )
            light.original_intensity = light getlightintensity();

        light setlightintensity( 0.0 );
    }
}

add_pack_characteranim( modelname, _id_31093158B2292193, animation, _id_F34379ACBA78A66B, _id_A8542244FDA27657 )
{
    model = spawn( "script_model", self.origin );
    model setmodel( modelname );
    model forcenetfieldhighlod( 1 );
    model useanimtree( #animtree );

    if ( isdefined( _id_A8542244FDA27657 ) )
        animname = _id_A8542244FDA27657;
    else
        animname = modelname;

    model.animname = animname;
    level.scr_anim[model.animname]["br_ending"] = animation;

    if ( isdefined( _id_F34379ACBA78A66B ) )
        level.scr_animname[model.animname]["br_ending"] = _id_F34379ACBA78A66B;

    if ( isdefined( _id_31093158B2292193 ) )
    {
        model.linkedents = [];

        foreach ( _id_C30D717B67553796 in _id_31093158B2292193 )
        {
            extra = spawn( "script_model", self.origin );
            extra setmodel( _id_C30D717B67553796[0] );
            extra forcenetfieldhighlod( 1 );
            extra linkto( model, _id_C30D717B67553796[1], ( 0, 0, 0 ), ( 0, 0, 0 ) );
            model.linkedents[model.linkedents.size] = extra;
        }
    }

    self.pack.models[self.pack.models.size] = model;
    return model;
}

allplayers_setphysicaldof( fstop, _id_ED8206FEF1806FEF, focusspeed, aperturespeed, _id_C06551440B16249C )
{
    if ( !isdefined( focusspeed ) )
        focusspeed = 100;

    if ( !isdefined( aperturespeed ) )
        aperturespeed = 100;

    foreach ( player in level.players )
    {
        if ( !isdefined( player.scriptedphysicaldofenabled ) )
        {
            player.scriptedphysicaldofenabled = 1;
            player enablephysicaldepthoffieldscripting();
        }

        if ( isdefined( _id_C06551440B16249C ) )
        {
            player setphysicaldepthoffield( fstop, _id_ED8206FEF1806FEF, focusspeed, aperturespeed, _id_C06551440B16249C );
            continue;
        }

        if ( isdefined( aperturespeed ) )
        {
            player setphysicaldepthoffield( fstop, _id_ED8206FEF1806FEF, focusspeed, aperturespeed );
            continue;
        }

        if ( isdefined( focusspeed ) )
        {
            player setphysicaldepthoffield( fstop, _id_ED8206FEF1806FEF, focusspeed );
            continue;
        }

        player setphysicaldepthoffield( fstop, _id_ED8206FEF1806FEF );
    }
}

allplayers_setfov( fov )
{
    foreach ( player in level.players )
    {
        player setclientdvar( "dvar_DF1DC712C4A91588", fov );
        player setclientdvar( "dvar_71C6C0B8428E44A7", 1 );
    }
}

_id_CF47AB3F9DEFE35B()
{
    foreach ( player in level.players )
    {
        player setclientdvar( "dvar_DF1DC712C4A91588", 65.0 );
        player setclientdvar( "dvar_71C6C0B8428E44A7", 0 );
    }
}

allplayers_clearphysicaldof()
{
    foreach ( player in level.players )
    {
        if ( isdefined( player.scriptedphysicaldofenabled ) )
        {
            player.scriptedphysicaldofenabled = undefined;
            player disablephysicaldepthoffieldscripting();
        }
    }
}

chopperexfil_set_brcircle()
{
    if ( !isdefined( level.br_circle ) )
        return;

    if ( !isdefined( level.br_circle.dangercircleent ) )
        return;

    level.br_circle.dangercircleent brcirclemoveto( self.origin[0], self.origin[1], 9000, 0.05 );
}

create_disconnectplayer( animstruct )
{
    _id_382D2566050DE89A = spawn( "script_model", self.origin );
    _id_382D2566050DE89A setmodel( "tag_origin" );
    _id_382D2566050DE89A forcenetfieldhighlod( 1 );
    _id_382D2566050DE89A.isdisconnectplayer = 1;
    _id_382D2566050DE89A.brexfilanimname = "player0";
    _id_382D2566050DE89A.origin = animstruct.origin;
    _id_382D2566050DE89A.angles = animstruct.angles;
    _id_382D2566050DE89A create_player_rig( _id_382D2566050DE89A.brexfilanimname, "viewhands_base_iw8", animstruct );
    _id_382D2566050DE89A linkto( _id_382D2566050DE89A.player_rig, "tag_player", ( 0, 0, 0 ), ( 0, 0, 0 ) );
    level thread ending_player_disconnect_thread( _id_382D2566050DE89A, 1 );
    animstruct.winners[0] = _id_382D2566050DE89A;
}

ending_player_disconnect_thread( player, _id_8D259C975723AEDC )
{
    rig = player.player_rig;
    _id_A0B64BD11AA5B217 = isplayer( player );

    if ( !isdefined( _id_8D259C975723AEDC ) )
        player waittill( "disconnect" );
    else
        wait 0.1;

    if ( !isdefined( rig ) )
        return;

    playfxontag( scripts\engine\utility::getfx( "player_disconnect" ), rig, "tag_player" );
}

create_cam()
{
    model = spawn( "script_model", self.origin );
    model setmodel( "tag_origin" );
    model forcenetfieldhighlod( 1 );
    model useanimtree( #animtree );
    model.animname = "endingCam";
    return model;
}

ending_fade_in( fade_time )
{
    self notify( "ending_fade_in" );
    self endon( "ending_fade_in" );
    self endon( "disconnect" );
    _id_63F445469B886BF8 = fade_time * 20;
    alpha = 1;
    _id_85BCA1424E521F21 = 1.0 / _id_63F445469B886BF8;
    self setclientomnvar( "ui_world_fade", alpha );

    for ( _id_AC0E594AC96AA3A8 = 0; _id_AC0E594AC96AA3A8 < _id_63F445469B886BF8; _id_AC0E594AC96AA3A8++ )
    {
        waitframe();
        alpha = alpha - _id_85BCA1424E521F21;
        alpha = max( alpha, 0 );
        self setclientomnvar( "ui_world_fade", alpha );
    }
}

ending_fade_out( fade_time )
{
    self notify( "ending_fade_out" );
    self endon( "ending_fade_out" );
    self endon( "disconnect" );
    _id_63F445469B886BF8 = fade_time * 20;
    alpha = 0;
    _id_85BCA1424E521F21 = 1.0 / _id_63F445469B886BF8;
    self setclientomnvar( "ui_world_fade", alpha );

    for ( _id_AC0E594AC96AA3A8 = 0; _id_AC0E594AC96AA3A8 < _id_63F445469B886BF8; _id_AC0E594AC96AA3A8++ )
    {
        waitframe();
        alpha = alpha + _id_85BCA1424E521F21;
        alpha = min( alpha, 1 );
        self setclientomnvar( "ui_world_fade", alpha );
    }
}

create_player_rig( animname, _id_486DB5FA512A3B6B, animstruct, _id_40A4287D8D2E7EF9 )
{
    self.animname = animname;
    origin = animstruct.origin;

    if ( !isdefined( origin ) )
        origin = ( 0, 0, 0 );

    player_rig = spawn( "script_model", origin );
    player_rig.player = self;
    self.player_rig = player_rig;
    self.player_rig setmodel( _id_486DB5FA512A3B6B );
    self.player_rig hide();
    self.player_rig.animname = animname;
    self.player_rig useanimtree( #animtree );
    self.player_rig.winindex = self.winindex;
    self.player_rig forcenetfieldhighlod( 1 );
    self.player_rig.cinematic_motion_override = scripts\mp\utility\infilexfil::handlecinematicmotionnotetrack;
    self.player_rig.dof_func = scripts\mp\utility\infilexfil::handledofnotetrack;

    if ( !isdefined( animstruct.player_rigs ) )
        animstruct.player_rigs = [];

    if ( isplayer( self ) )
    {
        self playerlinktodelta( self.player_rig, "tag_player", 1.0, 0, 0, 0, 0, 1 );
        animstruct.player_rigs[animstruct.player_rigs.size] = self.player_rig;
    }
    else
        self.player_rig.winindex = 0;

    self notify( "rig_created" );
}

remove_player_rig()
{
    if ( isdefined( self ) )
        self unlink();

    if ( isdefined( self.player_rig ) )
        self.player_rig delete();
}

get_center_of_array( array )
{
    center = ( 0, 0, 0 );

    for ( _id_AC0E594AC96AA3A8 = 0; _id_AC0E594AC96AA3A8 < array.size; _id_AC0E594AC96AA3A8++ )
        center = ( center[0] + array[_id_AC0E594AC96AA3A8].origin[0], center[1] + array[_id_AC0E594AC96AA3A8].origin[1], center[2] + array[_id_AC0E594AC96AA3A8].origin[2] );

    if ( array.size != 0 )
        return ( center[0] / array.size, center[1] / array.size, center[2] / array.size );

    return undefined;
}

_id_3F005B301EC7F15B( _id_ACD8FAA0E7DDE1B2, _id_E26F44ACAD48DDD1, _id_C447F0AC96C38753, _id_1E2F2224127D2990, radius, height, _id_D4364A524E8A2BCD )
{
    _id_A7B23DAE3BCFE5F8 = spawnstruct();
    _id_A7B23DAE3BCFE5F8._id_E26F44ACAD48DDD1 = _id_E26F44ACAD48DDD1;
    _id_A7B23DAE3BCFE5F8._id_C447F0AC96C38753 = _id_C447F0AC96C38753;
    _id_A7B23DAE3BCFE5F8._id_1E2F2224127D2990 = _id_1E2F2224127D2990;
    _id_A7B23DAE3BCFE5F8._id_715D3504E80C76E9 = radius;
    _id_A7B23DAE3BCFE5F8._id_C580CE41C807E164 = height;
    _id_A7B23DAE3BCFE5F8._id_D4364A524E8A2BCD = _id_D4364A524E8A2BCD;
    _id_ACD8FAA0E7DDE1B2[_id_ACD8FAA0E7DDE1B2.size] = _id_A7B23DAE3BCFE5F8;
    return _id_ACD8FAA0E7DDE1B2;
}

_id_F317A6F0AE25E3D4( _id_ACD8FAA0E7DDE1B2, modelname, _id_E26F44ACAD48DDD1, _id_C447F0AC96C38753, _id_1E2F2224127D2990, radius, _id_D4364A524E8A2BCD )
{
    _id_A7B23DAE3BCFE5F8 = spawnstruct();
    _id_A7B23DAE3BCFE5F8.modelname = modelname;
    _id_A7B23DAE3BCFE5F8._id_E26F44ACAD48DDD1 = _id_E26F44ACAD48DDD1;
    _id_A7B23DAE3BCFE5F8._id_C447F0AC96C38753 = _id_C447F0AC96C38753;
    _id_A7B23DAE3BCFE5F8._id_1E2F2224127D2990 = _id_1E2F2224127D2990;
    _id_A7B23DAE3BCFE5F8._id_C77E7A25454430DA = radius;
    _id_A7B23DAE3BCFE5F8._id_D4364A524E8A2BCD = _id_D4364A524E8A2BCD;
    _id_ACD8FAA0E7DDE1B2[_id_ACD8FAA0E7DDE1B2.size] = _id_A7B23DAE3BCFE5F8;
    return _id_ACD8FAA0E7DDE1B2;
}

_id_19AE50E23FE0625A( _id_ACD8FAA0E7DDE1B2, modelname, _id_E26F44ACAD48DDD1, _id_1E2F2224127D2990, radius, _id_5C9CB2FBE8943109, _id_D4364A524E8A2BCD )
{
    _id_A7B23DAE3BCFE5F8 = spawnstruct();
    _id_A7B23DAE3BCFE5F8.modelname = modelname;
    _id_A7B23DAE3BCFE5F8._id_E26F44ACAD48DDD1 = _id_E26F44ACAD48DDD1;
    _id_A7B23DAE3BCFE5F8._id_1E2F2224127D2990 = _id_1E2F2224127D2990;
    _id_A7B23DAE3BCFE5F8._id_C77E7A25454430DA = radius;
    _id_A7B23DAE3BCFE5F8._id_5C9CB2FBE8943109 = _id_5C9CB2FBE8943109;
    _id_A7B23DAE3BCFE5F8._id_D4364A524E8A2BCD = _id_D4364A524E8A2BCD;
    _id_ACD8FAA0E7DDE1B2[_id_ACD8FAA0E7DDE1B2.size] = _id_A7B23DAE3BCFE5F8;
    return _id_ACD8FAA0E7DDE1B2;
}
